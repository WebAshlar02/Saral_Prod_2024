/*
**********************************************************************************************************************************
COMMENT ID: 1
COMMENTOR NAME :SHRIJEET SHANIL
METHODE/EVENT:BUSSINESS LAYER
REMARK: ADDED AUTO COMMENT FEATURE IN EXISTING SARAL AND PRODUCTIVITY 
DateTime :09JAN17
*********************************************************************************************************************************
***********************************************************************************************************************************
COMMENT ID: 2
COMMENTOR NAME :SHRIJEET SHANIL
METHODE/EVENT:BUSSINESS LAYER
REMARK: ADDED AUTO COMMENT FEATURE IN EXISTING SARAL AND PRODUCTIVITY 
DateTime :09JAN17
*********************************************************************************************************************************
 ************************************************************************************************************************************
COMMENT ID: 3
COMMENTOR NAME :SHRIJEET SHANIL
METHODE/EVENT:BUSSINESS LAYER
REMARK: ADDED TO MAINTAIN USER LOGS 
DateTime :24JAN18
*********************************************************************************************************************************
 ************************************************************************************************************************************
COMMENT ID: 4
COMMENTOR NAME :ROSHAN LOHAR
METHODE/EVENT:BUSSINESS LAYER
REMARK: ADDED AUTO REPORTS IN EXISTING SARAL AND PRODUCTIVITY 
DateTime :23JAN18
*********************************************************************************************************************************
 * ************************************************************************************************************************************
COMMENT ID: 5
COMMENTOR NAME :SHRI 
METHODE/EVENT:BUSSINESS LAYER
REMARK: ADD NEW VERSION OF GET DETAILS (TPA STATRUS )
DateTime :14MAR18
*********************************************************************************************************************************
 * ************************************************************************************************************************************
COMMENT ID: 6
COMMENTOR NAME :SHRI 
METHODE/EVENT:BUSSINESS LAYER
REMARK: ADD MANUAL DEDUPE FEATURE 
DateTime :10MAY18
*********************************************************************************************************************************
 * ************************************************************************************************************************************
COMMENT ID: 7
COMMENTOR NAME :SHRI 
METHODE/EVENT:Common function
REMARK: is policy to be printed 
DateTime :07May18
*********************************************************************************************************************************
**************************************************************************************************************************************
COMMENT ID: 8
COMMENTOR NAME :SHRI 
METHODE/EVENT:BindQuestion_CloseFile
REMARK: Fetch questions from database
DateTime :07May18
*********************************************************************************************************************************
 * **************************************************************************************************************************************
COMMENT ID: 9
COMMENTOR NAME :SHRI 
METHODE/EVENT:SaveAnswer_CloseFile
REMARK: Save answer to database
DateTime :07May18
*********************************************************************************************************************************
 * * **************************************************************************************************************************************
COMMENT ID: 10
COMMENTOR NAME :SHRI 
METHODE/EVENT:Save_MedicalReport_Reason
REMARK: Save Medical reason to database
DateTime :07May18
*********************************************************************************************************************************
*****************************************************************************************************************************************
COMMENT ID: 11
COMMENTOR NAME :SURAJ BHAMRE
METHODE/EVENT:Get_RequiremenSummary
REMARK: FETCH REQUIREMENT SUMMARY FOR UWCOMMENTS PAGE
DateTime :21May18
******************************************************************************************************************************************
COMMENT ID: 13
COMMENTOR NAME :AJAY SAHU
METHODE/EVENT:GetStatusDiscription
REMARK: get bmp audit trail
DateTime :25May18
***************************************************************************************************************************************
COMMENT ID: 14
COMMENTOR NAME : AJAY SAHU
METHODE/EVENT:
REMARK: CHECK RIDER
DateTime :11JUNE18
*********************************************************************************************************************************
***************************************************************************************************************************************
COMMENT ID: 15
COMMENTOR NAME : Suraj BHamre
METHODE/EVENT:
REMARK: Is client existing ,case status is IF for UW warning message
DateTime :03 July 18
*********************************************************************************************************************************
***************************************************************************************************************************************
COMMENT ID: 16
COMMENTOR NAME : Suraj BHamre
METHODE/EVENT:
REMARK: Fetch Medical status
DateTime :12 July 18
*********************************************************************************************************************************
*  *  *  *************************************************************************************************************************************
COMMENT ID: 17
COMMENTOR NAME :Suraj Bhamre   
METHODE/EVENT:
REMARK: show meddical dropdown value from database
DateTime :4JUly18
*********************************************************************************************************************************
 *  *  *************************************************************************************************************************************
COMMENT ID: 18
COMMENTOR NAME : AJAY SAHU
METHODE/EVENT:
REMARK: Calculate BMI
DateTime :4JUly18
*********************************************************************************************************************************
 *  *  *************************************************************************************************************************************
COMMENT ID: 19
COMMENTOR NAME : SHRIJEET SHANIL
METHODE/EVENT:
REMARK: FETCH CATEGORY FOR MEDICAL DASHBOARD
DateTime :26FEB18
 *  *  *************************************************************************************************************************************
COMMENT ID: 20
COMMENTOR NAME : SHRIJEET SHANIL
METHODE/EVENT:
REMARK: FETCH CATEGORY FOR MEDICAL DASHBOARD
DateTime :26FEB18
*********************************************************************************************************************************
COMMENT ID: 21
COMMENTOR NAME : SURAJ BHAMRE
METHODE/EVENT:
REMARK: GET MANDATORY RIDER
DateTime :01APR19
*************************************************************************************************************************************
* COMMENT ID: 22
COMMENTOR NAME : SURAJ BHAMRE
METHODE/EVENT:
REMARK: GET CLOSE FILE REVIEW CASE WHICH IS ALREADY PROCESSED
DateTime :02APR19

 *  *  *************************************************************************************************************************************
COMMENT ID: 23
COMMENTOR NAME : SHRIJEET SHANIL
METHODE/EVENT:
REMARK: FINANCAIL CALCULATOR
DateTime :20March
*********************************************************************************************************************************
***************************************************************************************************************************************
COMMENT ID: 24
COMMENTOR NAME : SHRIJEET SHANIL
METHODE/EVENT:
REMARK: MANAGE get auto issuence data
DateTime :13April19
*********************************************************************************************************************************
***************************************************************************************************************************************
COMMENT ID: 25
COMMENTOR NAME : SURAJ BHAMRE
METHODE/EVENT:
REMARK: get warning message as per application no
DateTime :14MAY19
*********************************************************************************************************************************
***************************************************************************************************************************************
COMMENT ID: 26
COMMENTOR NAME : SURAJ BHAMRE
METHODE/EVENT:
REMARK: Get resolved Medical followup code 
DateTime :02June19
*********************************************************************************************************************************
***************************************************************************************************************************************
COMMENT ID: 27
COMMENTOR NAME : Shweta Mamilwar
METHODE/EVENT:
REMARK: CR- 27039 - IIB Query  data extraction from QUEST Portal 
DateTime :29may2020
*********************************************************************************************************************************
* ***************************************************************************************************************************************
COMMENT ID: 28
COMMENTOR NAME : Akshada N Wagh
METHODE/EVENT:
REMARK: CR-26273 Reinstatment Email-SMS Communcations to be triggered.
DateTime :04June2020
*********************************************************************************************************************************
 *
 * ***********************************************************************************************************************************
COMMENT ID:29
COMMENTOR NAME : AKSHADA WAGH
METHODE/EVENT:
REMARK:  CR -28153 Get and Insert Consent Details when Consent Follow Up Code are raised.
DateTime :02-09-2020
***********************************************************************************************************************************
* * ***********************************************************************************************************************************
COMMENT ID:30
COMMENTOR NAME : Suraj Bhamre
METHODE/EVENT:
REMARK:  1.Create work item
DateTime :25-02-2021
***********************************************************************************************************************************
* ************************************************************************************************************************************
COMMENT ID:31
COMMENTOR NAME : Brijesh Pandey [MFL00464]
REMARK: CR - 30461- NB Data for risk scoring Model
DateTime :07/07/2021
*********************************************************************************************************************************
COMMENT ID          : 32        
COMMENTOR NAME      : Pooja Shetye              
DateTime            : 27.08.2021           
REMARK              : CR - 29431 1.PAN and FORM 60 Flagging validation 
//*********************************************************************************************************************************
//******************************************************************************************************************************* 
// Sr. No.              : 33
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Kavita Mahajan         
// BRD/CR/Codesk No/Win : CR - 30489    
// Date Of Creation     : 14-12-2021            
// Description          :  30489-IIB_DeCoupling
//*********************************************************************************************************************************
*********************************************************************************************************************************
COMMENT ID          : 34       
COMMENTOR NAME      : Sagar Thorave              
DateTime            : 8-03-2022           
REMARK              : CR -30573 Upload and download policy risk flag 
//*********************************************************************************************************************************
//**********************************************************************
// Sr. No.              : 35
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Sushant Devkate - MFL00905
// BRD/CR/Codesk No/Win :  CR-30363 
// Date Of Creation     : 15/06/2022
// Description          : Add and delete the Negative Pincode
//**********************************************************************

//**********************************************************************
// Sr. No.              : 36
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Sushant Devkate - MFL00905
// BRD/CR/Codesk No/Win :  CR-2639
// Date Of Creation     : 15/06/2022
// Description          : To Fetch the FSAR
//**********************************************************************
// Sr. No.              : 37
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Sushant Devkate - MFL00905
// BRD/CR/Codesk No/Win :  CR-2809
// Date Of Creation     : 01/08/2022
// Description          : Seperate IIB Query for LA ,Proposal and Payer
//**********************************************************************
//*******************************************************************************************************************************
// Sr. No.              : 38
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Sagar Thorave - MFL00886
// BRD/CR/Codesk No/Win : CR-3387 
// Date Of Creation     : 16/08/2022
// Description          :AML risk categorisation in Life Asia
//*******************************************************************************************************************************
 //**********************************************************************
// Sr. No.              : 39
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Sagar Thorave - MFL00886
// BRD/CR/Codesk No/Win :  CR-30554
// Date Of Creation     : 14/09/2022
// Description          :Integrate SmartApiEnyRiskScore and Add EnyScore value
//**********************************************************************
//******************************************************************************************************************************* 
// Sr. No.              : 40
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Sushant Devkate          
// BRD/CR/Codesk No/Win : CR-2304  
// Date Of Creation     : 22/09/2022           
// Description          : Audit Point  Customer contact details validation with Agent database
//*******************************************************************************************************************************
//*******************************************************************************************************************************
// Sr. No.              : 41
// Company              : Life            
// Module               : UW Saral   
//METHODE/EVENT:BUSSINESS LAYER
// Program Author       : Sushant Devkate - MFL00905
// BRD/CR/Codesk No/Win :  CR-30543 
// Date Of Creation     :  12/10/2022
// Description          : Added functinality on IsSmokar 
//*******************************************************************************************************************************
//*******************************************************************************************************************************
// Sr. No.              : 42
// Company              : Life            
// Module               : UW Saral   
//METHODE/EVENT:BUSSINESS LAYER
// Program Author       : Sagar Thorave - MFL00886
// BRD/CR/Codesk No/Win :  CR-1844 
// Date Of Creation     :  18/10/2022
// Description          : Added Uw Comment post editable 
//*******************************************************************************************************************************
//******************************************************************************************************************************* 
// Sr. No.              : 43
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Bhaumik Patel WebAshlar02        
// BRD/CR/Codesk No/Win : CR-4134  
// Date Of Creation     : 25-08-2022            
// Description          :Add Box For RedFlagging of Clients ID
//*******************************************************************************************************************************
 */
//******************************************************************************************************************************* 
// Sr. No.              : 44
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Jayendra Patankar [WebAshlar01]      
// BRD/CR/Codesk No/Win :  
// Date Of Creation     : 25-11-2022            
// Description          : Create a Restrict for UINNO
//*******************************************************************************************************************************
//*******************************************************************************************************************************
// Sr. No.              : 45
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Sagar Thorave - MFL00886
// BRD/CR/Codesk No/Win :  CR-3281
// Date Of Creation     : 06/03/2023
// Description          :Mapping Special Insurance
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// Sr. No.              : 46
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Sagar Thorave - MFL00886
// BRD/CR/Codesk No/Win : Disscussed with Suraj Sir
// Date Of Creation     : 06/03/2023
// Description          :Get Cibil score
//*******************************************************************************************************************************
//**********************************************************************
// Sr. No.              : 47
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Royson Pinto - MFL01002
// BRD/CR/Codesk No/Win : CR-4783
// Date Of Creation     : 03/05/2023
// Description          :Add CMO functionality
//**********************************************************************
//**********************************************************************
// Sr. No.              : 48
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Jayendra [WebAshlar01]
// BRD/CR/Codesk No/Win : STP Changes 
// Date Of Creation     : 05-03-2023
// Description          :  1. Schedular for the STP Integration
//**********************************************************************
//**********************************************************************
// Sr. No.              : 49
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Royson Pinto - MFL01002
// BRD/CR/Codesk No/Win : CR-4783-7
// Date Of Creation     :  07/06/2023
// Description          :Add ThirdPartyDecline functionality
//**********************************************************************
//**********************************************************************
// Sr. No.              : 50
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Sagar Thorave [MFL00886]
// BRD/CR/Codesk No/Win : CR-7049  
// Date Of Creation     : 10-07-2023
// Description          : Add AcceptanceReason function
//**********************************************************************
//**********************************************************************
// Sr. No.              : 51
// Company              : Life            
// Module               : UW Saral         
// Program Author       : Bhaumik Patel - WebAshlar02
// BRD/CR/Codesk No/Win : CR-3334 
// Date Of Creation     : 18/11/2022
// Description          :Retup Multiple Reason Option
//**********************************************************************


using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Data;
using System.Data.Sql;
using System.Data.SqlClient;
using System.Net.Mail;
using System.Configuration;
using Platform.Utilities.LoggerFramework;
using System.IO;
using System.Xml;
using System.Xml.Serialization;
using UWSaralObjects;
using System.IO.Compression;
/// <summary>
/// Summary description for Commfun
/// </summary>
public class Commfun
{
    #region Feild declaration begins.
    //DataLayer objSql = new DataLayer();
    DataSet _dsSMSEmail;
    DataSet _dsAppdtls;
    string strInputBo = string.Empty;
    string strOutpuBo = string.Empty;
    string strSender = string.Empty;
    string ErrorCode = string.Empty;
    string strSmsBody = string.Empty;
    string stremailBody = string.Empty;
    string stremailSub = string.Empty;
    string strReceiverName = string.Empty;
    string strMobileNo = string.Empty;
    string stremail = string.Empty;
    string BoString;
    /*ID:7 START*/
    DataLayer objSql = new DataLayer();
    //Commfun objComm = new Commfun();
    public static string cnStrOnline = ConfigurationSettings.AppSettings["OnlineSalesSTG"];
    /*ID:7 END*/
    #endregion Feild declaration begins End.

    #region Object declaration begins.

    esbSendSMSSvc.sendSMS objReq = new esbSendSMSSvc.sendSMS();
    esbSendSMSSvc.sendSMSResponse objRes = new esbSendSMSSvc.sendSMSResponse();
    esbSendSMSSvc.FGSMSServiceBPMIntfClient objInvoke = new esbSendSMSSvc.FGSMSServiceBPMIntfClient();
    #endregion Object declaration End.

    public Commfun()
    {
    }

    public void SaveErrorLogs(string strApplicationno, string strErrordiscp, string strApplsource, string strClassname, string strMethodename, string strLayercode, string strRequest, string strResponce, string strComment)
    {
        try
        {
            Logger.Info(strApplicationno + "STAG 2 :PageName :Commfun.CS // MethodeName :SaveErrorLogs");
            SqlParameter[] _sqlparam = new SqlParameter[9];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", strApplicationno);
            _sqlparam[1] = new SqlParameter("@ErrorLogDesc", strErrordiscp);
            _sqlparam[2] = new SqlParameter("@ApplicationSource", strApplsource);
            _sqlparam[3] = new SqlParameter("@ClassName", strClassname);
            _sqlparam[4] = new SqlParameter("@MethodName", strMethodename);
            _sqlparam[5] = new SqlParameter("@LayerCode", strLayercode);
            _sqlparam[6] = new SqlParameter("@XmlRequestData", strRequest);
            _sqlparam[7] = new SqlParameter("@XmlResponseData", strResponce);
            _sqlparam[8] = new SqlParameter("@Comments", strComment);
            objSql.Insertrecord("USP_BPM_ErrorLogDetailsave_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationno + "STAG 2 :PageName :Commfun.CS // MethodeName :SaveErrorLogs Error :" + System.Environment.NewLine + Error.ToString());
            SendEmailSMS(Error.ToString(), "OnlineBMPScncIntegration Error : / Level/OnlineApplicationdetails");
        }
    }

    public void LoadUWsaralPageDetails(ref DataSet _dsAllData, string strPQuoteNo, string AppType, string strUserId)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :LoadUWsaralPageDetails");
            _dsAppdtls = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@UserId", strUserId);
            _sqlparam[1] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[2] = new SqlParameter("@AppType", AppType);
            /*ID:5 START*/
            //_dsAllData = objSql.RetrieveDataset("usp_UWOnlineAllDetailsApi_Get_V7", _sqlparam);For UAT Aadhar transaction number
            // _dsAllData = objSql.RetrieveDataset("usp_UWOnlineAllDetailsApi_Get_V8_TEMP", _sqlparam);
            //_dsAllData = objSql.RetrieveDataset("usp_UWOnlineAllDetailsApi_Get_V7", _sqlparam);
            //_dsAllData = objSql.RetrieveDataset("usp_UWOnlineAllDetailsApi_Get_V7_UAT", _sqlparam);//UAT
            //_dsAllData = objSql.RetrieveDataset("usp_UWOnlineAllDetailsApi_Get_V9", _sqlparam);
            //_dsAllData = objSql.RetrieveDataset("usp_UWOnlineAllDetailsApi_Get_V10", _sqlparam);
            //_dsAllData = objSql.RetrieveDataset("usp_UWOnlineAllDetailsApi_Get_V11", _sqlparam);
            //_dsAllData = objSql.RetrieveDataset("usp_UWOnlineAllDetailsApi_Get_V12", _sqlparam);
            //_dsAllData = objSql.RetrieveDataset("usp_UWOnlineAllDetailsApi_Get_V12_Combi", _sqlparam);

            //51.1 Begin of Changes; Bhaumik Patel - [CR-3334]
            _dsAllData = objSql.RetrieveDataset("usp_UWOnlineAllDetailsApi_Get_V13_Combi_V1", _sqlparam);
            //51.1 End of Changes; Bhaumik Patel - [CR-3334]
            /*ID:5 END*/
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :LoadUWsaralPageDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "LoadUWsaralPageDetails", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineApplicationdashbord_Get(ref DataSet _dsAppdtls, string strUwmode, string struserid, string strUserGroup, string strLnkoption)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationdashbord_Get");
            _dsAppdtls = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@strUwmode", strUwmode);
            _sqlparam[1] = new SqlParameter("@struserid", struserid);
            _sqlparam[2] = new SqlParameter("@struserGroup", strUserGroup);
            _sqlparam[3] = new SqlParameter("@strlnkOption", strLnkoption);
            _dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordDetails_Get", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationdashbord_Get Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationdashbord_Get", "E-Error", "", "", Error.ToString());
        }
        
    }

    public void OnlineApplicationdashbord_Get(string strUwmode, string struserid, string strUserGroup, string strLnkoption, ref DataSet _dsAppdtls)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationdashbord_Get");
            _dsAppdtls = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@strUwmode", strUwmode);
            _sqlparam[1] = new SqlParameter("@struserid", struserid);
            _sqlparam[2] = new SqlParameter("@struserGroup", strUserGroup);
            _sqlparam[3] = new SqlParameter("@strlnkOption", strLnkoption);
            //_dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordDetails_Get_V7", _sqlparam);
            //_dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordDetails_Get_V9", _sqlparam); //with CMO
            //_dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordDetails_Get_Offline_Online_Merge", _sqlparam);   //online-offline merge with CMO
            //_dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordDetails_Get_V8", _sqlparam); //for UAT
            //_dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordDetails_Get_Offline_Online_Merge_MDRT", _sqlparam);
            //########################## Added by Shyam Starts ###########################################
            string proceName = string.Empty;
            if (strLnkoption == "Revival_Cases")
            {
                proceName = "usp_UWOnlineDashbordDetails_Get_V7_Revival";
            }
            else
            {
                proceName = "usp_UWOnlineDashbordDetails_Get_Offline_Online_Merge_MDRT_CLOSEFILE";
            }

            _dsAppdtls = objSql.RetrieveDataset(proceName, _sqlparam);

            //########################## Added by Shyam End ###########################################
           // _dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordDetails_Get_Offline_Online_Merge_MDRT_CLOSEFILE", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationdashbord_Get Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationdashbord_Get", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineDynamicdashbordCount_Get(ref DataSet _dsAppdtls, string strUwmode, string struserid, string strUserGroup)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationdashbord_Get");
            _dsAppdtls = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@userid", struserid);
            _sqlparam[1] = new SqlParameter("@channelType", strUwmode);
            _sqlparam[2] = new SqlParameter("@userGroup", strUserGroup);
            _dsAppdtls = objSql.RetrieveDataset("USP_UWsaralgetdashborsscript", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationdashbord_Get Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationdashbord_Get", "E-Error", "", "", Error.ToString());
        }
    }

    public string OnlineDynamicUWResult_Get(string strApplicationNumber, ref string response, string strUwmode, string struserid, string strUserGroup)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationdashbord_Get");
            _dsAppdtls = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[5];
            _sqlparam[0] = new SqlParameter("@applicationNumber", strApplicationNumber);
            _sqlparam[1] = new SqlParameter("@userid", struserid);
            _sqlparam[2] = new SqlParameter("@channelType", strUwmode);
            _sqlparam[3] = new SqlParameter("@userGroup", strUserGroup);
            SqlParameter output = new SqlParameter("@response", SqlDbType.NVarChar, 5000)
            {
                Direction = ParameterDirection.InputOutput,
                Value = response
            };
            _sqlparam[4] = output;
            _dsAppdtls = objSql.RetrieveDataset("USP_UWsaralgetUWdecisionscript", _sqlparam);
            response = _sqlparam[4].Value.ToString();
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationdashbord_Get Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationdashbord_Get", "E-Error", "", "", Error.ToString());
        }
        return response;
    }

    public void OnlineApplicationdashbordBucketsCount_Get(ref DataSet _dsAppdtls, string strUwmode, string struserid, string strLinkOption, string strUserGroup)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationdashbord_Get");
            _dsAppdtls = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@strUwmode", strUwmode);
            _sqlparam[1] = new SqlParameter("@struserid", struserid);
            _sqlparam[2] = new SqlParameter("@struserGroup", strUserGroup);
            _sqlparam[3] = new SqlParameter("@strlnkOption", strLinkOption);
            _dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordCountDetails_Get", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationdashbord_Get Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationdashbord_Get", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineApplicationdashbordBucketsCount_Get(string strUwmode, string struserid, string strLinkOption, string strUserGroup, ref DataSet _dsAppdtls)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationdashbord_Get");
            _dsAppdtls = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@strUwmode", strUwmode);
            _sqlparam[1] = new SqlParameter("@struserid", struserid);
            _sqlparam[2] = new SqlParameter("@struserGroup", strUserGroup);
            _sqlparam[3] = new SqlParameter("@strlnkOption", strLinkOption);
            //_dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordCountDetails_Get_V4", _sqlparam);
            //_dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordCountDetails_Get_V5", _sqlparam);//production sp
            //_dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordCountDetails_Get_V5_Online_Offline_Merge", _sqlparam);
            _dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordCountDetails_Get_V5_Online_Offline_Merge_CountTest", _sqlparam); //PROD
            //_dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordCountDetails_Get_V5_Online_Offline_Merge", _sqlparam);//UAT
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationdashbord_Get Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationdashbord_Get", "E-Error", "", "", Error.ToString());
        }
    }
    public void BpmUserDetails_Get(string strUserid, ref DataSet _dsUserInfo)
    {
        Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :BpmUserDetails_Get");
        SqlParameter[] _sqlparam = new SqlParameter[1];
        _sqlparam[0] = new SqlParameter("@UserId", strUserid);
        _dsUserInfo = objSql.RetrieveDataset("USP_UWsaralgetbpmuserdetails", _sqlparam);
    }

    public void UpdateControlMechanism(string strApplicationNumber, string struserid, string strAssignTo, string strOptionKey, ref int Result)
    {
        try
        {
            Logger.Info(strApplicationNumber + "STAG 3-A :PageName :Commfun.CS // MethodeName :UpdateControlmechanism");
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@ApplicationNumber", strApplicationNumber);
            _sqlparam[1] = new SqlParameter("@UserId", struserid);
            _sqlparam[2] = new SqlParameter("@AssignedTo", strAssignTo);
            _sqlparam[3] = new SqlParameter("@Optionkey", strOptionKey);
            Result = objSql.Insertrecord("USP_UWSralApplicationTransactionChecker", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNumber + " STAG 4-A :PageName :Commfun.CS // MethodeName :UpdateControlmechanism Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strApplicationNumber, "Failed", "UWPortfolio", "Commfun.cs", "UpdateControlmechanism", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineApplicationchangeStatus(string strApplicationNumber, string struserid, string strOptionKey, string strAssignTo, ref int Result)
    {
        try
        {
            Logger.Info(strApplicationNumber + "STAG 3-A :PageName :Commfun.CS // MethodeName :UpdateControlmechanism");
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@appno", strApplicationNumber);
            _sqlparam[1] = new SqlParameter("@Assignedby", struserid);
            _sqlparam[2] = new SqlParameter("@decisonkey", strOptionKey);
            _sqlparam[3] = new SqlParameter("@AssigedTo", strAssignTo);
            Result = objSql.Insertrecord("USP_Uwsaralstatuscontroldetails_save", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNumber + " STAG 4-A :PageName :Commfun.CS // MethodeName :OnlineApplicationchangeStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strApplicationNumber, "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationchangeStatus", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineApplicationLockChecker(string strApplicationNumber, string struserid, string strUserGroup, ref DataSet Result)
    {
        try
        {
            Logger.Info(strApplicationNumber + "STAG 3-A :PageName :Commfun.CS // MethodeName :UpdateControlmechanism");
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@ApplicationNumber", strApplicationNumber);
            _sqlparam[1] = new SqlParameter("@UserId", struserid);
            _sqlparam[2] = new SqlParameter("@UserGroup", strUserGroup);
            //Result = objSql.RetrieveDataset("USP_UWSral_AppLockChecker", _sqlparam);
            //Result = objSql.RetrieveDataset("USP_UWSral_AppLockChecker_V1", _sqlparam);
            Result = objSql.RetrieveDataset("USP_UWSral_AppLockChecker_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNumber + " STAG 4-A :PageName :Commfun.CS // MethodeName :OnlineApplicationchangeStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strApplicationNumber, "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationchangeStatus", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineApplicationLockChecker_Revival(string strApplicationNumber, string struserid, string strUserGroup, ref DataSet Result)
    {
        try
        {
            Logger.Info(strApplicationNumber + "STAG 3-A :PageName :Commfun.CS // MethodeName :UpdateControlmechanism");
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@ApplicationNumber", strApplicationNumber);
            _sqlparam[1] = new SqlParameter("@UserId", struserid);
            _sqlparam[2] = new SqlParameter("@UserGroup", strUserGroup);
            Result = objSql.RetrieveDataset("USP_UWSral_AppLockChecker_REVIVAL", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNumber + " STAG 4-A :PageName :Commfun.CS // MethodeName :OnlineApplicationchangeStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strApplicationNumber, "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationchangeStatus", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineCommonObjectDetails_GET(ref DataSet _ds, string strPQuoteNo, string strAppType)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-A :PageName :Commfun.CS // MethodeName :OnlineCommonObjectDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@ApplicationNoStr", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strAppType);
            _ds = objSql.RetrieveDataset("USP_BPM_CommonObjectDetailsGet_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + " STAG 4-A :PageName :Commfun.CS // MethodeName :OnlineCommonObjectDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineUWSaralOptionControl_GET(ref DataSet _ds, string strUserId, string strPQuoteNo, string strAppType)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-A :PageName :Commfun.CS // MethodeName :OnlineUWSaralOptionControl_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@UserID", strUserId);
            _sqlparam[1] = new SqlParameter("@AppType", strAppType);
            _ds = objSql.RetrieveDataset("Spr_UWSaralOptionControl_Get", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 4-A :PageName :Commfun.CS // MethodeName :OnlineUWSaralOptionControl_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineUWSaralOptionControl_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlineApplicationDisplayDetails_GET(ref DataSet _ds, string strPQuoteNo, string strChanneltype)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-C  :PageName :Commfun.CS // MethodeName :OnlineApplicationDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strChanneltype);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_APPLICATION_DETAILS_GET", _sqlparam);
            
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlineAgentDisplayDetails_GET(ref DataSet _ds, string strPQuoteNo, string strChanneltype)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-D :PageName :Commfun.CS // MethodeName :OnlineAgentDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strChanneltype);
            _ds = objSql.RetrieveDataset("usp_UWOnlineAgentDetails_Get_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineAgentDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineAgentDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlinePanDisplayDetails_GET(ref DataSet _ds, string strPQuoteNo, string strChanneltype)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-F :PageName :Commfun.CS // MethodeName :OnlinePanDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strChanneltype);
            _ds = objSql.RetrieveDataset("usp_UWOnlinePanDetails_Get", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinePanDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlinePanDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlineTsmrMsarDisplayDetails_GET(ref DataSet _ds, string strPQuoteNo, string strChanneltype)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineTsmrMsarDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strChanneltype);
            //_ds = objSql.RetrieveDataset("SPR_UWSARAL_MSARTSARFETCHDETAILS_GET", _sqlparam);
            //_ds = objSql.RetrieveDataset("SPR_UWSARAL_MSARTSARFETCHDETAILS_GET_Combi", _sqlparam);
            _ds = objSql.RetrieveDataset("SPR_UWSARAL_MSARTSARFETCHDETAILS_GET_V2_Combi", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineTsmrMsarDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineTsmrMsarDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }


    public void OnlineBankDisplayDetails_GET(ref DataSet _ds, string strPQuoteNo, string strChanneltype)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-E :PageName :Commfun.CS // MethodeName :OnlineBankDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strChanneltype);
            _ds = objSql.RetrieveDataset("usp_UWOnlineBankDetails_Get", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineBankDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineBankDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }


    public void OnlineProductDisplayDetails_GET(ref DataSet _ds, string strPQuoteNo, string strChanneltype)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-G :PageName :Commfun.CS // MethodeName :OnlineProductDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strChanneltype);
            //_ds = objSql.RetrieveDataset("USP_UWSARAL_UWDECISION_FETCH_PRODUCT_DETAILS", _sqlparam);
            //_ds = objSql.RetrieveDataset("USP_UWSARAL_UWDECISION_FETCH_PRODUCT_DETAILS_V2", _sqlparam);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_UWDECISION_FETCH_PRODUCT_DETAILS_Combi", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineProductDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineProductDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlineRiderDisplayDetails_GET(ref DataTable _ds, string strPQuoteNo)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineRiderDisplayDetails_GET");
            //SqlParameter[] _sqlparam = new SqlParameter[1];
            //_sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            //_ds = objSql.RetrieveDataset("usp_UWOnlineApplicationDetails_Get", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineRiderDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineRiderDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlineCommentsDisplayDetails_GET(ref DataSet _ds, string strPQuoteNo, string strChanneltype, string strCommentcategory)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-L :PageName :Commfun.CS // MethodeName :OnlineCommentsDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strChanneltype);
            _sqlparam[2] = new SqlParameter("@COMM_category", strCommentcategory);
            _ds = objSql.RetrieveDataset("usp_UWOnlineCommentsDetails_Get", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineCommentsDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineCommentsDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlineFundsDisplayDetails_GET(ref DataSet _ds, string strPQuoteNo, string strProdCode, string strChanneltype)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-H :PageName :Commfun.CS // MethodeName :OnlineFundsDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@ProdCode", strProdCode);
            _sqlparam[2] = new SqlParameter("@AppType", strChanneltype);
            _ds = objSql.RetrieveDataset("usp_UWOnlineFundsDetails_Get", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineFundsDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineFundsDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlinePaymentsDisplayDetails_GET(ref DataSet _ds, string strPQuoteNo, string strChanneltype)
    {
        try
        {
            //Logger.Info(strPQuoteNo + "STAG 3-I :PageName :Commfun.CS // MethodeName :OnlinePaymentsDisplayDetails_GET");
            //SqlParameter[] _sqlparam = new SqlParameter[1];
            //_sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            //_ds = objSql.RetrieveDataset("usp_UWOnlineApplicationDetails_Get", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinePaymentsDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlinePaymentsDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlineRequirmentDisplayDetails_GET(ref DataSet _ds, string strPQuoteNo, string strChanneltype)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-J :PageName :Commfun.CS // MethodeName :OnlineRequirmentDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strChanneltype);
            _ds = objSql.RetrieveDataset("usp_UWOnlineRequirmentDetails_Get", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineRequirmentDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineRequirmentDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlineReceiptDisplayDetails_GET(ref DataSet _ds, string strPQuoteNo, string strReqSource)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-M :PageName :Commfun.CS // MethodeName :OnlineReceiptDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strReqSource);
            _ds = objSql.RetrieveDataset("usp_UWOnlineReceiptDetails_Get", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineReceiptDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineReceiptDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlineLoadingDisplayDetails_GET(ref DataSet _ds, string strPQuoteNo, string strReqSource)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-K :PageName :Commfun.CS // MethodeName :OnlineLoadingDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@ReqSource", strReqSource);
            //51.1 Begin of Changes; Bhaumik Patel - [CR - 3334]
            _ds = objSql.RetrieveDataset("usp_UWOnlineLoadingDetails_Get_V2", _sqlparam);
            //51.1 End of Changes; Bhaumik Patel - [CR - 3334]
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineLoadingDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineLoadingDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlineReportDisplayDetails_GET(ref DataSet _ds, string strPQuoteNo)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineReportDisplayDetails_GET");
            //    SqlParameter[] _sqlparam = new SqlParameter[1];
            //    _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            //    _ds = objSql.RetrieveDataset("usp_UWOnlineRequirmentDetails_Get", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineReportDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineReportDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlineSubMasterDisplayDetails_GET(ref DataSet _ds, string strDatavalue, string ddlType, string ddlsubtype)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineSubMasterDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@DataValue", strDatavalue);
            _sqlparam[1] = new SqlParameter("@ddlType", ddlType);
            _sqlparam[2] = new SqlParameter("@ddlsubtype", ddlsubtype);
            //51.1 Begin of Changes; Bhaumik Patel - [CR - 3334]
            _ds = objSql.RetrieveDataset("USP_BPM_SubMasterDetailsFetch_V3", _sqlparam);
            //51.1 End of Changes; Bhaumik Patel - [CR - 3334]
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineSubMasterDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineFollowupMasterDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlineMasterDisplayDetails_GET(ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 2 A1 :PageName :Commfun.CS // MethodeName :OnlineMasterDisplayDetails_GET");
            _ds = objSql.RetrieveDataset_woParam("USP_BPM_MasterDetailsFetch_V3");
            if (_ds.Tables.Count > 0)
            {
                _ds.Tables[0].TableName = "ddlfollowupcode";
                _ds.Tables[1].TableName = "ddlCategory";
                _ds.Tables[2].TableName = "ddlCriteria";
                _ds.Tables[3].TableName = "ddlStatus";
                _ds.Tables[4].TableName = "ddlLoadType";
                _ds.Tables[5].TableName = "ddlUWDecesion";
                _ds.Tables[6].TableName = "ddlUWreason";
                _ds.Tables[7].TableName = "ddlLoadFlatMortality";
                _ds.Tables[8].TableName = "ddlBkdateReason";
                _ds.Tables[9].TableName = "ddlIfscCode";
                //51.1 Begin of Changes; Bhaumik Patel - [CR - 3334]
                 _ds.Tables[10].TableName = "ddlLoadRsn1";
                _ds.Tables[11].TableName = "ddlLoadRsn2";
                //51.1 End of Changes; Bhaumik Patel - [CR - 3334]
                _ds.Tables[12].TableName = "ddlLoadTypeVal";
                _ds.Tables[13].TableName = "ddlAutoPaytype";
                /*ID:6 STRART*/
                if (_ds.Tables.Count > 14)
                {
                    _ds.Tables[14].TableName = "cblDecisionType";
                }
                if (_ds.Tables.Count > 15)
                {
                    _ds.Tables[15].TableName = "ddlProposalType";
                }
                if (_ds.Tables.Count > 16)
                {
                    _ds.Tables[16].TableName = "ddlProposalType2";
                }
                if (_ds.Tables.Count > 17)
                {
                    _ds.Tables[17].TableName = "ddlProposalType3";
                }
                /*ID:6 END*/
                if (_ds.Tables.Count > 18)
                {
                    _ds.Tables[18].TableName = "ddlRequirementMedicalReason";
                }
                if (_ds.Tables.Count > 19)
                {
                    _ds.Tables[19].TableName = "ddlAnswer";
                }
                //Added by Suraj on 25 APRIL 2018 for Assign type dropdown
                if (_ds.Tables.Count > 20)
                {
                    _ds.Tables[20].TableName = "ddlAssigmentType";
                }
                //Added by Suraj on 5 JULY 2018 for Country list
                if (_ds.Tables.Count > 21)
                {
                    _ds.Tables[21].TableName = "ddlcountry";
                }
                //Added by Suraj on 25 JULY 2019 for signature match
                if (_ds.Tables.Count > 22)
                {
                    _ds.Tables[22].TableName = "ddlSignature";
                }
                //Added by Suraj on 01 JULY 2020 for catagory only for product code E83,84
                if (_ds.Tables.Count > 23)
                {
                    _ds.Tables[23].TableName = "ddlRelationStaff"; 
                }
                if (_ds.Tables.Count > 24)
                {
                    _ds.Tables[24].TableName = "ddlNAWPCatagory";
                }

                // 48.1 Begin of Changes; Jayendra  - [Webashlar01]
                _ds.Tables[25].TableName = "ddlfollowupcode_STP";
                _ds.Tables[26].TableName = "ddlCategory_STP";
                _ds.Tables[27].TableName = "ddlCriteria_STP";
                _ds.Tables[28].TableName = "ddlStatus_STP";
                // 48.1 End of Changes; Jayendra  - [Webashlar01]

            }
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineMasterDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineMasterDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlineApplicationDetails_Save(string strpolicyNumber, string strapplicationNumber, string strisBackdating, string strRCDbackdating, string strbackdatingReason,
string strbpm_userName, string strbpm_userID, string strbpm_branchCode, string strbpm_userBranch, string strbpm_processName, string strbpm_applicationName, string strlifeAsia_userID, string strChanneltype, string strBackdatingintrest, ref int AppResult)
    {
        try
        {
            Logger.Info(strapplicationNumber + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[14];
            _sqlparam[0] = new SqlParameter("@policyNumber", strpolicyNumber);
            _sqlparam[1] = new SqlParameter("@applicationNumber", strapplicationNumber);
            _sqlparam[2] = new SqlParameter("@isBackdating", strisBackdating);
            _sqlparam[3] = new SqlParameter("@RCDbackdating", strRCDbackdating);
            _sqlparam[4] = new SqlParameter("@backdatingReason", strbackdatingReason);
            _sqlparam[5] = new SqlParameter("@bpm_userName", strbpm_userName);
            _sqlparam[6] = new SqlParameter("@bpm_userID", strbpm_userID);
            _sqlparam[7] = new SqlParameter("@bpm_branchCode", strbpm_branchCode);
            _sqlparam[8] = new SqlParameter("@bpm_userBranch", strbpm_userBranch);
            _sqlparam[9] = new SqlParameter("@bpm_processName", strbpm_processName);
            _sqlparam[10] = new SqlParameter("@bpm_applicationName", strbpm_applicationName);
            _sqlparam[11] = new SqlParameter("@lifeAsia_userID", strlifeAsia_userID);
            _sqlparam[12] = new SqlParameter("@ChannelType", strChanneltype);
            _sqlparam[13] = new SqlParameter("@backdatingIntrest", strBackdatingintrest);
            AppResult = objSql.Insertrecord("USP_BPM_ApplicationDetailsSave_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strapplicationNumber + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strapplicationNumber, "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineBankDetails_Save(string strApplicationNo, string strClientNo, string strIfscCode, string strBankname, string strBranchname, string strBankaddress, string strBankAccoutno, string strClientName, ref int BankResult)
    {
        try
        {
            Logger.Info(strApplicationNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineBankDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[8];
            _sqlparam[0] = new SqlParameter("@IFSCCode", strIfscCode);
            _sqlparam[1] = new SqlParameter("@BankName", strBankname);
            _sqlparam[2] = new SqlParameter("@BankBranch", strBranchname);
            _sqlparam[3] = new SqlParameter("@BankAddress", strBankaddress);
            _sqlparam[4] = new SqlParameter("@BankAccountNumber", strBankAccoutno);
            _sqlparam[5] = new SqlParameter("@ApplicationNo", strApplicationNo);
            _sqlparam[6] = new SqlParameter("@ClientNo", strClientNo);
            _sqlparam[7] = new SqlParameter("@ClientName", strClientName);
            BankResult = objSql.Insertrecord("USP_BPM_BankDetailsSave_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineBankDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strApplicationNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineBankDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineLoadingMasterDetails_GET(ref DataSet _ds, string strPQuoteNo, string strAppType)
    {
        Logger.Info(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlineLoadingMasterDetails_GET");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strAppType);
            _ds = objSql.RetrieveDataset("USP_BPM_LoadingMasterDetailsFetch_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlineLoadingMasterDetails_GET");
            SaveErrorLogs(strPQuoteNo, "Failed", "UWSaralDecision", "Commfun.cs", "OnlineLoadingMasterDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineNsapProductDetails_GET(ref DataSet _ds, string strPQuoteNo, string strAppType)
    {
        Logger.Info(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlineProdcutControlMasterDetails_GET");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strAppType);
            _ds = objSql.RetrieveDataset("usp_UWSaralNsapLoadingDetails_Get", _sqlparam);
            //_ds = objSql.RetrieveDataset("usp_UWOnlineLoadingDetails_Get_V1", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlineProdcutControlMasterDetails_GET");
            SaveErrorLogs(strPQuoteNo, "Failed", "UWSaralDecision", "Commfun.cs", "OnlineProdcutControlMasterDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlineProdcutControlMasterDetails_GET(ref DataSet _ds, string strPQuoteNo, string strAppType)
    {
        Logger.Info(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlineProdcutControlMasterDetails_GET");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strAppType);
            _ds = objSql.RetrieveDataset("usp_UWSaralProductControlDetails_Get", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlineProdcutControlMasterDetails_GET");
            SaveErrorLogs(strPQuoteNo, "Failed", "UWSaralDecision", "Commfun.cs", "OnlineProdcutControlMasterDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineFundDetails(string strAppType, string strFND_appType, string strFND_applicationNoStr, string strFND_fundCode, string strFND_fundName, string strFND_fundComposition,
string strbpm_userID, string strbpm_userName, string strbpmgrp, string strbpm_branchCode, string strbpm_userBranch, string strbpm_processName, string strbpm_applicationName, ref int FundResult)
    {
        try
        {
            Logger.Info(strFND_applicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineFundDetails");
            SqlParameter[] _sqlparam = new SqlParameter[13];
            _sqlparam[0] = new SqlParameter("@AppType", strAppType);
            _sqlparam[1] = new SqlParameter("@FND_appType", strFND_appType);
            _sqlparam[2] = new SqlParameter("@FND_applicationNoStr", strFND_applicationNoStr);
            _sqlparam[3] = new SqlParameter("@FND_fundCode", strFND_fundCode);
            _sqlparam[4] = new SqlParameter("@FND_fundName", strFND_fundName);
            _sqlparam[5] = new SqlParameter("@FND_fundComposition", strFND_fundComposition);
            _sqlparam[6] = new SqlParameter("@bpm_userID", strbpm_userID);
            _sqlparam[7] = new SqlParameter("@bpm_userName", strbpm_userName);
            _sqlparam[8] = new SqlParameter("@bpmgrp", strbpmgrp);
            _sqlparam[9] = new SqlParameter("@bpm_branchCode", strbpm_branchCode);
            _sqlparam[10] = new SqlParameter("@bpm_userBranch", strbpm_userBranch);
            _sqlparam[11] = new SqlParameter("@bpm_processName", strbpm_processName);
            _sqlparam[12] = new SqlParameter("@bpm_applicationName", strbpm_applicationName);
            FundResult = objSql.Insertrecord("USP_BPM_FundDetailsSave_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strFND_applicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineFundDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strFND_applicationNoStr, "Failed", "UWPortfolio", "Commfun.cs", "OnlineFundDetails", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineRiderDetails_Save(string strAppType, string strAppNo, string strRiderCode, string strRiderPremiumWithTax, string strRiderSumAssured, ref int RiderResult)
    {
        try
        {
            Logger.Info(strAppNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineRiderDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[5];
            _sqlparam[0] = new SqlParameter("@AppType", strAppType);
            _sqlparam[1] = new SqlParameter("@AppNo", strAppNo);
            _sqlparam[2] = new SqlParameter("@SPRD_riderCode", strRiderCode);
            _sqlparam[3] = new SqlParameter("@SPRD_riderPremiumWithTax", strRiderPremiumWithTax);
            _sqlparam[4] = new SqlParameter("@SPRD_riderSumAssured", strRiderSumAssured);
            RiderResult = objSql.Insertrecord("USP_BPM_RiderDetailsSave_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strAppNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineRiderDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strAppNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineRiderDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineProductDetails_Save(string strAppType, string strapplicationNumber, string strPolNumber, string strProductCode, string strPOL_sumAssured
        , string strPOL_policyTerm, string strPOL_premPayingTerm, string strPOL_premPayingFreq, string strPREM_basePremium, string strPREM_totalPremium
        , string strPREM_serviceTaxBasePremium, string strMonthlyPayout, string strSpecialInsuranceType, string stCibil, ref int PolResult)
    {
        try
        {
            Logger.Info(strapplicationNumber + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineProductDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[14];
            _sqlparam[0] = new SqlParameter("@AppType", strAppType);
            _sqlparam[1] = new SqlParameter("@AppNo", strapplicationNumber);
            _sqlparam[2] = new SqlParameter("@PolNo", strPolNumber);
            _sqlparam[3] = new SqlParameter("@POL_sumAssured", strPOL_sumAssured);
            _sqlparam[4] = new SqlParameter("@POL_policyTerm", strPOL_policyTerm);
            _sqlparam[5] = new SqlParameter("@POL_premPayingTerm", strPOL_premPayingTerm);
            _sqlparam[6] = new SqlParameter("@POL_premPayingFreq", strPOL_premPayingFreq);
            _sqlparam[7] = new SqlParameter("@PREM_basePremium", strPREM_basePremium);
            _sqlparam[8] = new SqlParameter("@PREM_totalPremium", strPREM_totalPremium);
            _sqlparam[9] = new SqlParameter("@PREM_serviceTaxBasePremium", strPREM_serviceTaxBasePremium);
            _sqlparam[10] = new SqlParameter("@ProductCode", strProductCode);
            _sqlparam[11] = new SqlParameter("@MonthlyPayout", strMonthlyPayout);
            _sqlparam[12] = new SqlParameter("@SpecialInsuranceType", strSpecialInsuranceType);
            _sqlparam[13] = new SqlParameter("@Cibil", stCibil);
            PolResult = objSql.Insertrecord("USP_BPM_ProductDetailsSave_V3", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strapplicationNumber + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineProductDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strapplicationNumber, "Failed", "UWPortfolio", "Commfun.cs", "OnlineProductDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }
    //26.1 Begin of Changes; Bibekananda Nanda - [1103055]
    public void OnlinePancardDetails_Save(string strclientId, string strFirstName, string strLastName, string strMiddleName, string strDOB,
        string strisMatched, string strResultDetails, string strisBOEVerified, string strBOEComments, string strPANCardNo, string struserID,
        string struserName, string strbranchCode, string struserBranch, string strprocessName, string strapplicationName, bool blnIsApplied,
        ref int PanResult, string strNDPanStatus, string strNDPanTitle, DateTime? NDLastUpdDate, string strNDPanType)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :OnlinePancardDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[16];
            _sqlparam[0] = new SqlParameter("@clientId", strclientId);
            _sqlparam[1] = new SqlParameter("@FirstName", strFirstName);
            _sqlparam[2] = new SqlParameter("@LastName", strLastName);
            _sqlparam[3] = new SqlParameter("@MiddleName", strMiddleName);
            _sqlparam[4] = new SqlParameter("@DOB", strDOB);
            _sqlparam[5] = new SqlParameter("@isMatched", strisMatched);
            _sqlparam[6] = new SqlParameter("@ResultDetails", strResultDetails);
            _sqlparam[7] = new SqlParameter("@isBOEVerified", strisBOEVerified);
            _sqlparam[8] = new SqlParameter("@BOEComments", strBOEComments);
            _sqlparam[9] = new SqlParameter("@PANCardNo", strPANCardNo);
            _sqlparam[10] = new SqlParameter("@userID", struserID);
            _sqlparam[11] = new SqlParameter("@userName", struserName);
            _sqlparam[12] = new SqlParameter("@branchCode", strbranchCode);
            _sqlparam[13] = new SqlParameter("@userBranch", struserBranch);
            _sqlparam[14] = new SqlParameter("@processName", strprocessName);
            _sqlparam[15] = new SqlParameter("@applicationName", strapplicationName);
            _sqlparam[15] = new SqlParameter("@IsApplied", blnIsApplied);

            //26.1 Begin of Changes; Bibekananda Nanda - [1103055]

            _sqlparam[16] = new SqlParameter("@ND_PanStatus", strNDPanStatus);
            _sqlparam[17] = new SqlParameter("@ND_PanTitle", strNDPanTitle);
            _sqlparam[18] = new SqlParameter("@ND_LastUpdDate", NDLastUpdDate);
            _sqlparam[19] = new SqlParameter("@ND_PanType", strNDPanType);

            //26.1 End of Changes; Bibekananda Nanda - [1103055]
            //PanResult = objSql.Insertrecord("USP_BPM_PancardDetailsSave_V2", _sqlparam);
            PanResult = objSql.Insertrecord("USP_BPM_PancardDetailsSave_V3", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlinePancardDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationdashbord_Get", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlinePremiumExtraLoadingdetails_Save(int BatchID, string ApplicationNo, string PolicyNo, string ComponentCd, int RiderPPT, int RiderPT, string RiderCtg, int BackdatedInt
        , long TotalInstalmentPremium, string ReasonOfRateUp, int ModalPremiumAmt, int ExtraPremiumAmt, int SeriveTax, int EduCess, int RevisedPremium, long SumAssured, long SumAssuredAcrossPlans
        , int MedicalLoadingPremium, int MedicalLoadingRate, int NonMedicalLoadingPremium, int BalanceofPremium, int NonMedicalLoadingRate, ref int LoadingPremresult)
    {
        try
        {
            Logger.Info(ApplicationNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinePremiumExtraLoadingdetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[22];
            _sqlparam[0] = new SqlParameter("@BatchID", BatchID);
            _sqlparam[1] = new SqlParameter("@ApplicationNo", ApplicationNo);
            _sqlparam[2] = new SqlParameter("@PolicyNo", PolicyNo);
            _sqlparam[3] = new SqlParameter("@ComponentCd", ComponentCd);
            _sqlparam[4] = new SqlParameter("@RiderPPT", RiderPPT);
            _sqlparam[5] = new SqlParameter("@RiderPT", RiderPT);
            _sqlparam[6] = new SqlParameter("@RiderCtg", RiderCtg);
            _sqlparam[7] = new SqlParameter("@BackdatedInt", BackdatedInt);
            _sqlparam[8] = new SqlParameter("@TotalInstalmentPremium", TotalInstalmentPremium);
            _sqlparam[9] = new SqlParameter("@ReasonOfRateUp", ReasonOfRateUp);
            _sqlparam[10] = new SqlParameter("@ModalPremiumAmt", ModalPremiumAmt);
            _sqlparam[11] = new SqlParameter("@ExtraPremiumAmt", ExtraPremiumAmt);
            _sqlparam[12] = new SqlParameter("@SeriveTax", SeriveTax);
            _sqlparam[13] = new SqlParameter("@EduCess", EduCess);
            _sqlparam[14] = new SqlParameter("@RevisedPremium", RevisedPremium);
            _sqlparam[15] = new SqlParameter("@SumAssured", SumAssured);
            _sqlparam[16] = new SqlParameter("@SumAssuredAcrossPlans", SumAssuredAcrossPlans);
            _sqlparam[17] = new SqlParameter("@MedicalLoadingPremium", MedicalLoadingPremium);
            _sqlparam[18] = new SqlParameter("@MedicalLoadingRate", MedicalLoadingRate);
            _sqlparam[19] = new SqlParameter("@NonMedicalLoadingPremium", NonMedicalLoadingPremium);
            _sqlparam[20] = new SqlParameter("@BalanceofPremium", BalanceofPremium);
            _sqlparam[21] = new SqlParameter("@NonMedicalLoadingRate", NonMedicalLoadingRate);
            LoadingPremresult = objSql.Insertrecord("USP_UWSaral_ExtraLoadingdetails_Save", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(ApplicationNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinepremiumLoadingDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlinepremiumLoadingDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }

    //public void OnlinePremiumExtraLoadingdetails_Save(int BatchID, string ApplicationNo, string PolicyNo, string ComponentCd, string RiderPPT, string RiderPT, string RiderCtg, int BackdatedInt, decimal TotalInstalmentPremium, string ReasonOfRateUp, decimal ModalPremiumAmt, decimal ExtraPremiumAmt, decimal SeriveTax, decimal EduCess, decimal RevisedPremium, decimal SumAssured, decimal SumAssuredAcrossPlans, decimal MedicalLoadingPremium, decimal MedicalLoadingRate, decimal NonMedicalLoadingPremium, decimal BalanceofPremium, decimal NonMedicalLoadingRate, ref int LoadingPremresult)
    //{
    //    try
    //    {
    //        Logger.Info(ApplicationNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinePremiumExtraLoadingdetails_Save");
    //        SqlParameter[] _sqlparam = new SqlParameter[22];
    //        _sqlparam[0] = new SqlParameter("@BatchID", BatchID);
    //        _sqlparam[1] = new SqlParameter("@ApplicationNo", ApplicationNo);
    //        _sqlparam[2] = new SqlParameter("@PolicyNo", PolicyNo);
    //        _sqlparam[3] = new SqlParameter("@ComponentCd", ComponentCd);
    //        _sqlparam[4] = new SqlParameter("@RiderPPT", RiderPPT);
    //        _sqlparam[5] = new SqlParameter("@RiderPT", RiderPT);
    //        _sqlparam[6] = new SqlParameter("@RiderCtg", RiderCtg);
    //        _sqlparam[7] = new SqlParameter("@BackdatedInt", BackdatedInt);
    //        _sqlparam[8] = new SqlParameter("@TotalInstalmentPremium", TotalInstalmentPremium);
    //        _sqlparam[9] = new SqlParameter("@ReasonOfRateUp", ReasonOfRateUp);
    //        _sqlparam[10] = new SqlParameter("@ModalPremiumAmt", ModalPremiumAmt);
    //        _sqlparam[11] = new SqlParameter("@ExtraPremiumAmt", ExtraPremiumAmt);
    //        _sqlparam[12] = new SqlParameter("@SeriveTax", SeriveTax);
    //        _sqlparam[13] = new SqlParameter("@EduCess", EduCess);
    //        _sqlparam[14] = new SqlParameter("@RevisedPremium", RevisedPremium);
    //        _sqlparam[15] = new SqlParameter("@SumAssured", SumAssured);
    //        _sqlparam[16] = new SqlParameter("@SumAssuredAcrossPlans", SumAssuredAcrossPlans);
    //        _sqlparam[17] = new SqlParameter("@MedicalLoadingPremium", MedicalLoadingPremium);
    //        _sqlparam[18] = new SqlParameter("@MedicalLoadingRate", MedicalLoadingRate);
    //        _sqlparam[19] = new SqlParameter("@NonMedicalLoadingPremium", NonMedicalLoadingPremium);
    //        _sqlparam[20] = new SqlParameter("@BalanceofPremium", BalanceofPremium);
    //        _sqlparam[21] = new SqlParameter("@NonMedicalLoadingRate", NonMedicalLoadingRate);
    //        LoadingPremresult = objSql.Insertrecord("USP_UWSaral_ExtraLoadingdetails_Save", _sqlparam);
    //    }
    //    catch (Exception Error)
    //    {
    //        Logger.Error(ApplicationNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinepremiumLoadingDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
    //        SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlinepremiumLoadingDetails_Save", "E-Error", "", "", Error.ToString());
    //    }
    //}

    public void OnlinepremiumLoadingDetails_Save(string strApplicationNo, int strAmount, string strDescription, string strLD_code, string strReason, string strComments, string strDescriptions, int strPremiumBOPPlanA, int strPremiumBOPPlanB, int strTotalPremiumBOPPlanA, int strTotalPremiumBOPPlanB, string strLoadingPercentage, ref int LoadingPremresult)
    {
        try
        {
            Logger.Info(strApplicationNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinepremiumLoadingDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[12];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@Amount", strAmount);
            _sqlparam[2] = new SqlParameter("@Description", strDescription);
            _sqlparam[3] = new SqlParameter("@LD_code", strLD_code);
            _sqlparam[4] = new SqlParameter("@Reason", strReason);
            _sqlparam[5] = new SqlParameter("@Comments", strComments);
            _sqlparam[6] = new SqlParameter("@Descriptions", strDescriptions);
            _sqlparam[7] = new SqlParameter("@PremiumBOPPlanA", strPremiumBOPPlanA);
            _sqlparam[8] = new SqlParameter("@PremiumBOPPlanB", strPremiumBOPPlanB);
            _sqlparam[9] = new SqlParameter("@TotalPremiumBOPPlanA", strTotalPremiumBOPPlanA);
            _sqlparam[10] = new SqlParameter("@TotalPremiumBOPPlanB", strTotalPremiumBOPPlanB);
            _sqlparam[11] = new SqlParameter("@LoadingPercentage", strLoadingPercentage);
            LoadingPremresult = objSql.Insertrecord("USP_BPM_LoadingpremiumDetailsSave_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinepremiumLoadingDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlinepremiumLoadingDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineLoadingDetails_Save(string LD_appType, string LD_applicationNoStr, string LD_code,
string LD_loadingType, string LD_reason1, string LD_reason2, string LD_reason3, string LD_sumAssured, string LD_loading,
string LD_rateAdjustment, string LD_flatMortality, string LD_premiumPayingTerm, string LD_isLetterPrintRequired,
string LD_rider, string bpm_userID, string bpm_userName, string bpmgrp, string bpm_branchCode, string bpm_userBranch,
string bpm_processName, string bpm_applicationName, string LD_reason4, ref int Lodingresult)
    {
        try
        {
            Logger.Info(LD_applicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineLoadingDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[22];
            _sqlparam[0] = new SqlParameter("@LD_appType", LD_appType);
            _sqlparam[1] = new SqlParameter("@LD_applicationNoStr", LD_applicationNoStr);
            _sqlparam[2] = new SqlParameter("@LD_code", LD_code);//ME for offline
            _sqlparam[3] = new SqlParameter("@LD_loadingType", LD_loadingType);
            _sqlparam[4] = new SqlParameter("@LD_reason1", LD_reason1);
            _sqlparam[5] = new SqlParameter("@LD_reason2", LD_reason2);
            _sqlparam[6] = new SqlParameter("@LD_reason3", LD_reason3);
            _sqlparam[7] = new SqlParameter("@LD_sumAssured", LD_sumAssured);
            _sqlparam[8] = new SqlParameter("@LD_loading", LD_loading);
            _sqlparam[9] = new SqlParameter("@LD_rateAdjustment", LD_rateAdjustment);
            _sqlparam[10] = new SqlParameter("@LD_flatMortality", LD_flatMortality);
            _sqlparam[11] = new SqlParameter("@LD_premiumPayingTerm", LD_premiumPayingTerm);
            _sqlparam[12] = new SqlParameter("@LD_isLetterPrintRequired", LD_isLetterPrintRequired);
            _sqlparam[13] = new SqlParameter("@LD_rider", LD_rider);//BS For offline
            _sqlparam[14] = new SqlParameter("@bpm_userID", bpm_userID);
            _sqlparam[15] = new SqlParameter("@bpm_userName", bpm_userName);
            _sqlparam[16] = new SqlParameter("@bpmgrp", bpmgrp);
            _sqlparam[17] = new SqlParameter("@bpm_branchCode", bpm_branchCode);
            _sqlparam[18] = new SqlParameter("@bpm_userBranch", bpm_userBranch);
            _sqlparam[19] = new SqlParameter("@bpm_processName", bpm_processName);
            _sqlparam[20] = new SqlParameter("@bpm_applicationName", bpm_applicationName);
            //51.1 Begin of Changes; Bhaumik Patel - [CR-3334]
            _sqlparam[21] = new SqlParameter("@LD_reason4", LD_reason4);
            //51.1 End of Changes; Bhaumik Patel - [CR-3334]
            Lodingresult = objSql.Insertrecord("USP_BPM_LoadingDetailsSave_V3", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(LD_applicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineLoadingDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(LD_applicationNoStr, "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationdashbord_Get", "E-Error", "", "", Error.ToString());
        }
    }


    public void ChangeUWSaralStatus(string strapplicationNoStr, string strPolicyNo, string strProccessStatus,
string strProcessSubStatus, bool isStarted, bool isCompleted, DateTime startDate, DateTime complDate, string strbpmuserID, string strbpm_userName, string strbpmgrp, string strbpm_branchCode,
DateTime strbpm_creationDate, DateTime strbpm_systemDate, string strbpm_businessDate, string strbpm_userBranch, string strbpm_processName, string strbpm_applicationName, ref int UWDecisionresult)
    {
        Logger.Info(strapplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineLoadingDetails_Save");
        SqlParameter[] _sqlparam = new SqlParameter[18];
        _sqlparam[0] = new SqlParameter("@appNo", strapplicationNoStr);
        _sqlparam[1] = new SqlParameter("@polNo", strPolicyNo);
        _sqlparam[2] = new SqlParameter("@processStatus", strProccessStatus);
        _sqlparam[3] = new SqlParameter("@processSubStatus", strProcessSubStatus);
        _sqlparam[4] = new SqlParameter("@isStarted", isStarted);
        _sqlparam[5] = new SqlParameter("@isCompleted", isCompleted);
        _sqlparam[6] = new SqlParameter("@startDate", null);
        _sqlparam[7] = new SqlParameter("@complDate", null);
        _sqlparam[8] = new SqlParameter("@bpm_userID", strbpmuserID);
        _sqlparam[9] = new SqlParameter("@bpm_userName", strbpm_userName);
        _sqlparam[10] = new SqlParameter("@bpmgrp", strbpmgrp);
        _sqlparam[11] = new SqlParameter("@bpm_branchCode", strbpm_branchCode);
        _sqlparam[12] = new SqlParameter("@bpm_creationDate", null);
        _sqlparam[13] = new SqlParameter("@bpm_systemDate", null);
        _sqlparam[14] = new SqlParameter("@bpm_businessDate", null);
        _sqlparam[15] = new SqlParameter("@bpm_userBranch", strbpm_userBranch);
        _sqlparam[16] = new SqlParameter("@bpm_processName", strbpm_processName);
        _sqlparam[17] = new SqlParameter("@bpm_applicationName", strbpm_applicationName);

        UWDecisionresult = objSql.Insertrecord("usp_QA_SaveInboxFlowData_V2", _sqlparam);
    }

  
    public void OnlineUWDecisionDetails_Save(string strappType, string strapplicationNoStr, string strunderwriterDecisionDetail, string struwRejectReason,
string strapprovalCategory, string struwDescription, string struwPostponementPeriod, string strbpm_userID, string strbpm_userName, string strbpmgrp, string strbpm_branchCode,
string strbpm_creationDate, string strbpm_systemDate, string strbpm_businessDate, string strbpm_userBranch, string strbpm_processName, string strbpm_applicationName, ref int UWDecisionresult)
    {
        try
        {
            Logger.Info(strapplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWDecisionDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[14];
            _sqlparam[0] = new SqlParameter("@DSG_appType", strappType);
            _sqlparam[1] = new SqlParameter("@DSG_applicationNoStr", strapplicationNoStr);
            _sqlparam[2] = new SqlParameter("@DSG_underwriterDecisionDetail", strunderwriterDecisionDetail);
            _sqlparam[3] = new SqlParameter("@DSG_uwRejectReason", struwRejectReason);
            _sqlparam[4] = new SqlParameter("@DSG_approvalCategory", strapprovalCategory);
            _sqlparam[5] = new SqlParameter("@DSG_uwDescription", struwDescription);
            _sqlparam[6] = new SqlParameter("@DSG_uwPostponementPeriod", struwPostponementPeriod);
            _sqlparam[7] = new SqlParameter("@bpm_userID", strbpm_userID);
            _sqlparam[8] = new SqlParameter("@bpm_userName", strbpm_userName);
            _sqlparam[9] = new SqlParameter("@bpmgrp", strbpmgrp);
            _sqlparam[10] = new SqlParameter("@bpm_branchCode", strbpm_branchCode);
            _sqlparam[11] = new SqlParameter("@bpm_userBranch", strbpm_userBranch);
            _sqlparam[12] = new SqlParameter("@bpm_processName", strbpm_processName);
            _sqlparam[13] = new SqlParameter("@bpm_applicationName", strbpm_applicationName);
            //51.1 Begin of Changes; Bhaumik Patel - [CR-3334]
           // _sqlparam[14] = new SqlParameter("@DSG_uwRejectReason1", UWreason2);
           // _sqlparam[15] = new SqlParameter("@DSG_uwDescription1", UWReason2value);
            //51.1 End of Changes; Bhaumik Patel - [CR-3334]
            UWDecisionresult = objSql.Insertrecord("USP_BPM_UWDecisionDetailsSave_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strapplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWDecisionDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strapplicationNoStr, "Failed", "UWPortfolio", "Commfun.cs", "OnlineUWDecisionDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }
   
    public void OnlinefollowupDetails_Save(string strAppType, string strApplicationNoStr, string strFollowUpCode, string strDescription, string strCategory,
string strCriteria, string strIsLetterPrintRequired, string strRaisedBy, string strStatus, string strClassification, string strLifeType, string strBpm_userID,
string strBpm_userName, string strBpmgrp, string strBpm_branchCode, string strBpm_userBranch, string strBpm_processName, string strBpm_applicationName, ref int FollowupResult)
    {
        try
        {
            Logger.Info(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinefollowupDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[18];
            _sqlparam[0] = new SqlParameter("@REQ_appType", strAppType);
            _sqlparam[1] = new SqlParameter("@REQ_applicationNoStr", strApplicationNoStr);
            _sqlparam[2] = new SqlParameter("@REQ_followUpCode", strFollowUpCode);
            _sqlparam[3] = new SqlParameter("@REQ_description", strDescription);
            _sqlparam[4] = new SqlParameter("@REQ_category", strCategory);
            _sqlparam[5] = new SqlParameter("@REQ_criteria", strCriteria);
            _sqlparam[6] = new SqlParameter("@REQ_isLetterPrintRequired", strIsLetterPrintRequired);
            _sqlparam[7] = new SqlParameter("@REQ_raisedBy", strRaisedBy);
            _sqlparam[8] = new SqlParameter("@REQ_status", strStatus);
            _sqlparam[9] = new SqlParameter("@REQ_classification", strClassification);
            _sqlparam[10] = new SqlParameter("@REQ_lifeType", strLifeType);
            _sqlparam[11] = new SqlParameter("@bpm_userID", strBpm_userID);
            _sqlparam[12] = new SqlParameter("@bpm_userName", strBpm_userName);
            _sqlparam[13] = new SqlParameter("@bpmgrp", strBpmgrp);
            _sqlparam[14] = new SqlParameter("@bpm_branchCode", strBpm_branchCode);
            _sqlparam[15] = new SqlParameter("@bpm_userBranch", strBpm_userBranch);
            _sqlparam[16] = new SqlParameter("@bpm_processName", strBpm_processName);
            _sqlparam[17] = new SqlParameter("@bpm_applicationName", strBpm_applicationName);
            FollowupResult = objSql.Insertrecord("USP_BPM_RequirmentDetailsSave_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWDecisionDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strApplicationNoStr, "Failed", "UWPortfolio", "Commfun.cs", "OnlinefollowupDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }
    public void OnlineUWCommentsDetails_Save(string strCommenterName, string strProcessName, string strCommenterRole, string strRemarks, string strDataNo, string strBpmUserId, string strBpmUserName, string strBpmGrp, string strBpmBranchcode, string strUserBranch, string strBpm_ProcessName, string strAppName, string strCommentcategory, ref int UWCommentResult)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWCommentsDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[13];
            _sqlparam[0] = new SqlParameter("@COMM_commenterName", strCommenterName);
            _sqlparam[1] = new SqlParameter("@COMM_processName", strProcessName);
            _sqlparam[2] = new SqlParameter("@COMM_commenterRole", strCommenterRole);
            _sqlparam[3] = new SqlParameter("@COMM_remarks", strRemarks);
            _sqlparam[4] = new SqlParameter("@COMM_dataNo", strDataNo);
            _sqlparam[5] = new SqlParameter("@COMM_bpm_userID", strBpmUserId);
            _sqlparam[6] = new SqlParameter("@COMM_bpm_userName", strBpmUserName);
            _sqlparam[7] = new SqlParameter("@COMM_bpmgrp", strBpmGrp);
            _sqlparam[8] = new SqlParameter("@COMM_bpm_branchCode", strBpmBranchcode);
            _sqlparam[9] = new SqlParameter("@COMM_bpm_userBranch", strUserBranch);
            _sqlparam[10] = new SqlParameter("@COMM_bpm_processName", strBpm_ProcessName);
            _sqlparam[11] = new SqlParameter("@COMM_bpm_applicationName", strAppName);
            _sqlparam[12] = new SqlParameter("@COMM_category", strCommentcategory);
            UWCommentResult = objSql.Insertrecord("USP_BPM_UWCommentsDetailsSave_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWCommentsDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strDataNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineUWCommentsDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }

    public void AfiCfi_GET(ref DataSet _ds, string strApplicationNo, string strPolicyNo)
    {
        try
        {
            Logger.Info("STAG 2 A1 :PageName :Commfun.CS // MethodeName :OnlineMasterDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@POLICY_NUMBER", strPolicyNo);
            _sqlparam[1] = new SqlParameter("@APPLICATION_NUMBER", strApplicationNo);
            _ds = objSql.RetrieveDataset("STP_FETCH_AFI_CFI_UW_DETAILS", _sqlparam);

            if (_ds.Tables.Count > 0)
            {
                _ds.Tables[0].TableName = "AFICFIDetails";
            }
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineMasterDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineMasterDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void UpdatePolicyStatus(string strApplicationNumber, string strPolicyStatus, ref int intRetVal)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWCommentsDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NUMBER", strApplicationNumber);
            _sqlparam[1] = new SqlParameter("@POLICY_STATUS", strPolicyStatus);
            intRetVal = objSql.Insertrecord("STP_UPDATE_POLICY_STATUS", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWCommentsDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineUWCommentsDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }

    #region Notification methode begins
    public void SendEmailSMS(string Error, string strSms)
    {
        Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :SendEmailSMS");
        #region  Send sms-email Begin.
        ErrorCode = "";
        _dsSMSEmail = objSql.RetrieveDataset_woParam("usp_Part_SMS_EMAILDetails__GET");
        strSmsBody = strSms;
        stremailBody = "Error Discription :" + Error.ToString();
        stremailSub = "OnlineBMPScyncIntegration Error/Level/CoreIntegrationFuncation";
        //strSmsBody = ConfigurationSettings.AppSettings["CCsmsText"];
        //stremailBody = ConfigurationSettings.AppSettings["CCemailText"];
        //stremailSub = ConfigurationSettings.AppSettings["CCemailSubject"];
        int x;
        for (x = 0; x < _dsSMSEmail.Tables[0].Rows.Count; x++)
        {
            strReceiverName = _dsSMSEmail.Tables[0].Rows[x]["ReceiverName"].ToString();
            strMobileNo = _dsSMSEmail.Tables[0].Rows[x]["MobileNo"].ToString();
            stremail = _dsSMSEmail.Tables[0].Rows[x]["EmailId"].ToString();
            SendSms("", strReceiverName, strMobileNo, stremail, strSmsBody);
            SendMail("", strReceiverName, strMobileNo, stremail, stremailBody, stremailSub);
        }
        #endregion #region  Send sms-email End
    }
    public void SendSms(string Pid, string Receiver, string MobNo, string Emailid, string smsbody)
    {
        Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :SendSms");
        objReq.textMsg = smsbody.Replace("PID", Pid);
        objReq.toNumber = MobNo;
        try
        {
            objRes = objInvoke.sendSMS(objReq);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :SendSms Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(Pid, "Failed", "UWPortfolio", "Commfun.cs", "SendSms", "E-Error", "", "", Error.ToString());
        }
    }
    public void SendMail(string Pid, string Receiver, string MobNo, string Emailid, string emailbody, string emailSubject)
    {

        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :SendMail");
            SmtpClient objsmtpClient = new SmtpClient();
            strSender = ConfigurationSettings.AppSettings["Sender"];
            objsmtpClient.Host = ConfigurationSettings.AppSettings["Host"]; ;
            objsmtpClient.Port = Convert.ToInt32(ConfigurationSettings.AppSettings["Port"]); ;
            MailMessage objMailMessage = new MailMessage();
            objMailMessage.From = new MailAddress(strSender);
            objMailMessage.To.Add(Emailid);
            objMailMessage.Subject = emailSubject;
            objMailMessage.Body = emailbody;
            objsmtpClient.Send(objMailMessage);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :SendMail Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "SendMail", "E-Error", "", "", Error.ToString());
        }
    }
    #endregion Notification methode End.

    #region Life Asia Service methodes Begins.

    public void OnlineServiceContractDetails_GET(ref DataSet _ds, string strPQuoteNo)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineServiceContractDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _ds = objSql.RetrieveDataset("", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineServiceContractDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineServiceContractDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineServiceLoadingDetails_GET(ref DataSet _ds, string strPQuoteNo)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineServiceLoadingDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _ds = objSql.RetrieveDataset("", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineServiceLoadingDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineServiceLoadingDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineServiceAmlDetails_GET(ref DataSet _ds, string strPQuoteNo)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineServiceAmlDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _ds = objSql.RetrieveDataset("", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineServiceAmlDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineServiceAmlDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineServicePreIssuevalDetails_GET(ref DataSet _ds, string strPQuoteNo)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineServicePreIssuevalDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _ds = objSql.RetrieveDataset("", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineServicePreIssuevalDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineServicePreIssuevalDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineServiceUWApproveDetails_GET(ref DataSet _ds, string strPQuoteNo)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineServiceUWApproveDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _ds = objSql.RetrieveDataset("", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineServiceUWApproveDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineServiceUWApproveDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineServiceUWIssuanceDetails_GET(ref DataSet _ds, string strPQuoteNo)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineServiceUWIssuanceDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _ds = objSql.RetrieveDataset("", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineServiceUWIssuanceDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineServiceUWIssuanceDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    #endregion Life Asia Service methodes Begins.

    /*added by shri on 21 june 17*/
    public void ClientBasicInfo_GET(ref DataSet _dsClientInfo, string strApplnNo)
    {
        Logger.Info(strApplnNo + "STAG 3-A :PageName :Commfun.CS // MethodeName :DeleteExistingLoading");
        SqlParameter[] _sqlparam = new SqlParameter[1];
        _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strApplnNo);
        _dsClientInfo = objSql.RetrieveDataset("USP_UWSaralGetClientBasicDetailsOnApplnNo", _sqlparam);
    }

    public void ClientFullInfo(ref DataSet _dsClientInfo, string strClientId, string strApplnNo, string strType)
    {
        SqlParameter[] _sqlparam = new SqlParameter[3];
        _sqlparam[0] = new SqlParameter("@CLIENT_ID", strClientId);
        _sqlparam[1] = new SqlParameter("@APPLN_NO", strApplnNo);
        _sqlparam[2] = new SqlParameter("@ASSURE_TYPE", strType);
        _dsClientInfo = objSql.RetrieveDataset("USP_FETCH_CLIENT_FULL_INFO", _sqlparam);
    }

    public void ClientFullInfo_Save(UWSaralObjects.ClientDetails objClientDetails, string strOldClientId, ref int intRetVal)
    {
        SqlParameter[] _sqlparam = new SqlParameter[59];
        _sqlparam[0] = new SqlParameter("@CLIENT_ID", objClientDetails.ClientId);
        _sqlparam[1] = new SqlParameter("@APPLICATION_NO", objClientDetails.ApplicationNo);
        _sqlparam[2] = new SqlParameter("@SALUTATION", objClientDetails.Salutation);
        _sqlparam[3] = new SqlParameter("@CLIENT_FIRST_NAME", objClientDetails.ClientFirstName);
        _sqlparam[4] = new SqlParameter("@CLIENT_MIDDLE_NAME", objClientDetails.ClientFatherName);
        _sqlparam[5] = new SqlParameter("@CLIENT_LAST_NAME", objClientDetails.ClinetLastName);
        _sqlparam[6] = new SqlParameter("@DATE_OF_BIRTH", objClientDetails.ClientDob);
        _sqlparam[7] = new SqlParameter("@GENDER", objClientDetails.ClientGender);
        _sqlparam[8] = new SqlParameter("@ROLE", objClientDetails.ClientRole);

        //communication address
        _sqlparam[9] = new SqlParameter("@C_ADDRESS_LINE_1", objClientDetails.lstClientAddress[0].AddressLine1);
        _sqlparam[10] = new SqlParameter("@C_ADDRESS_LINE_2", objClientDetails.lstClientAddress[0].AddressLine2);
        _sqlparam[11] = new SqlParameter("@C_ADDRESS_LINE_3", objClientDetails.lstClientAddress[0].AddressLine3);
        _sqlparam[12] = new SqlParameter("@C_ADDRESS_LINE_4", objClientDetails.lstClientAddress[0].AddressLine4);
        _sqlparam[13] = new SqlParameter("@C_ADDRESS_LINE_5", objClientDetails.lstClientAddress[0].AddressLine5);
        _sqlparam[14] = new SqlParameter("@C_LANDMARK", objClientDetails.lstClientAddress[0].LandMark);
        _sqlparam[15] = new SqlParameter("@C_PINCODE", objClientDetails.lstClientAddress[0].PinCode);
        _sqlparam[16] = new SqlParameter("@C_CITY", objClientDetails.lstClientAddress[0].City);
        _sqlparam[17] = new SqlParameter("@C_DISTRICT", objClientDetails.lstClientAddress[0].District);
        _sqlparam[18] = new SqlParameter("@C_STATE", objClientDetails.lstClientAddress[0].State);
        _sqlparam[19] = new SqlParameter("@C_COUNTRY_CODE", objClientDetails.lstClientAddress[0].CountryCode);
        _sqlparam[20] = new SqlParameter("@C_ADDRESS_REMARK", objClientDetails.lstClientAddress[0].AddressRemark);
        _sqlparam[21] = new SqlParameter("@C_PHONE_1", objClientDetails.lstClientAddress[0].Phone1);
        _sqlparam[22] = new SqlParameter("@C_PHONE_2", objClientDetails.lstClientAddress[0].Phone2);
        _sqlparam[23] = new SqlParameter("@C_TEL_NO", objClientDetails.lstClientAddress[0].TelNo);
        _sqlparam[24] = new SqlParameter("@C_MOBILE_NO", objClientDetails.lstClientAddress[0].MobileNo);
        _sqlparam[25] = new SqlParameter("@C_EMAIL_ID", objClientDetails.lstClientAddress[0].EmailId);
        _sqlparam[26] = new SqlParameter("@C_FAX", objClientDetails.lstClientAddress[0].FaxNo);

        //personal address
        if (objClientDetails.lstClientAddress.Count == 2)
        {
            //27-44
            _sqlparam[27] = new SqlParameter("@P_ADDRESS_LINE_1", objClientDetails.lstClientAddress[1].AddressLine1);
            _sqlparam[28] = new SqlParameter("@P_ADDRESS_LINE_2", objClientDetails.lstClientAddress[1].AddressLine2);
            _sqlparam[29] = new SqlParameter("@P_ADDRESS_LINE_3", objClientDetails.lstClientAddress[1].AddressLine3);
            _sqlparam[30] = new SqlParameter("@P_ADDRESS_LINE_4", objClientDetails.lstClientAddress[1].AddressLine4);
            _sqlparam[31] = new SqlParameter("@P_ADDRESS_LINE_5", objClientDetails.lstClientAddress[1].AddressLine5);
            _sqlparam[32] = new SqlParameter("@P_LANDMARK", objClientDetails.lstClientAddress[1].LandMark);
            _sqlparam[33] = new SqlParameter("@P_PINCODE", objClientDetails.lstClientAddress[1].PinCode);
            _sqlparam[34] = new SqlParameter("@P_CITY", objClientDetails.lstClientAddress[1].City);
            _sqlparam[35] = new SqlParameter("@P_DISTRICT", objClientDetails.lstClientAddress[1].District);
            _sqlparam[36] = new SqlParameter("@P_STATE", objClientDetails.lstClientAddress[1].State);
            _sqlparam[37] = new SqlParameter("@P_COUNTRY_CODE", objClientDetails.lstClientAddress[1].CountryCode);
            _sqlparam[38] = new SqlParameter("@P_ADDRESS_REMARK", objClientDetails.lstClientAddress[1].AddressRemark);
            _sqlparam[39] = new SqlParameter("@P_PHONE_1", objClientDetails.lstClientAddress[1].Phone1);
            _sqlparam[40] = new SqlParameter("@P_PHONE_2", objClientDetails.lstClientAddress[1].Phone2);
            _sqlparam[41] = new SqlParameter("@P_TEL_NO", objClientDetails.lstClientAddress[1].TelNo);
            _sqlparam[42] = new SqlParameter("@P_MOBILE_NO", objClientDetails.lstClientAddress[1].MobileNo);
            _sqlparam[43] = new SqlParameter("@P_EMAIL_ID", objClientDetails.lstClientAddress[1].EmailId);
            _sqlparam[44] = new SqlParameter("@P_FAX", objClientDetails.lstClientAddress[1].FaxNo);
        }
        else
        {
            _sqlparam[27] = new SqlParameter("@P_ADDRESS_LINE_1", string.Empty);
            _sqlparam[28] = new SqlParameter("@P_ADDRESS_LINE_2", string.Empty);
            _sqlparam[29] = new SqlParameter("@P_ADDRESS_LINE_3", string.Empty);
            _sqlparam[30] = new SqlParameter("@P_ADDRESS_LINE_4", string.Empty);
            _sqlparam[31] = new SqlParameter("@P_ADDRESS_LINE_5", string.Empty);
            _sqlparam[32] = new SqlParameter("@P_LANDMARK", string.Empty);
            _sqlparam[33] = new SqlParameter("@P_PINCODE", -1);
            _sqlparam[34] = new SqlParameter("@P_CITY", string.Empty);
            _sqlparam[35] = new SqlParameter("@P_DISTRICT", string.Empty);
            _sqlparam[36] = new SqlParameter("@P_STATE", string.Empty);
            _sqlparam[37] = new SqlParameter("@P_COUNTRY_CODE", string.Empty);
            _sqlparam[38] = new SqlParameter("@P_ADDRESS_REMARK", string.Empty);
            _sqlparam[39] = new SqlParameter("@P_PHONE_1", string.Empty);
            _sqlparam[40] = new SqlParameter("@P_PHONE_2", string.Empty);
            _sqlparam[41] = new SqlParameter("@P_TEL_NO", string.Empty);
            _sqlparam[42] = new SqlParameter("@P_MOBILE_NO", string.Empty);
            _sqlparam[43] = new SqlParameter("@P_EMAIL_ID", string.Empty);
            _sqlparam[44] = new SqlParameter("@P_FAX", string.Empty);

        }
        //new added values
        _sqlparam[45] = new SqlParameter("@CLIENT_TYPE", objClientDetails.ClientType);
        _sqlparam[46] = new SqlParameter("@ASSURED_TYPE", objClientDetails.AssuredType);
        _sqlparam[47] = new SqlParameter("@IsNsap", objClientDetails.IsNSAP);
        _sqlparam[48] = new SqlParameter("@IsSmoker", objClientDetails.IsSmoker);
        _sqlparam[49] = new SqlParameter("@Nationality", objClientDetails.Nationality);
        _sqlparam[50] = new SqlParameter("@Occupation", objClientDetails.Occupation);
        //bmp user info
        _sqlparam[51] = new SqlParameter("@BpmUserId", objClientDetails.objBmpUserInfo._UserID);
        _sqlparam[52] = new SqlParameter("@BpmUserName", objClientDetails.objBmpUserInfo._UserName);
        _sqlparam[53] = new SqlParameter("@BpmGrp", objClientDetails.objBmpUserInfo._UserGroup);
        _sqlparam[54] = new SqlParameter("@BpmBranchCode", objClientDetails.objBmpUserInfo._UserGroup);
        _sqlparam[55] = new SqlParameter("@BpmUserBranch", objClientDetails.objBmpUserInfo._userBranch);
        _sqlparam[56] = new SqlParameter("@BpmProcessName", objClientDetails.objBmpUserInfo._ProcessName);
        _sqlparam[57] = new SqlParameter("@BpmApplicationName", objClientDetails.objBmpUserInfo._ApplicationName);
        _sqlparam[58] = new SqlParameter("@OldClientId", strOldClientId);
        //BMP CLIENT DETAILS
        intRetVal = objSql.Insertrecord("USP_UWSaralUpdateClientDetailsAddrOnClientId", _sqlparam);
        //intRetVal = objSql.Insertrecord("USP_UWSaralAddClientDetails", _sqlparam);
    }

    public void ClientFullInfo_Insert(UWSaralObjects.ClientDetails objClientDetails, string strOldClientId, ref int intRetVal)
    {
        SqlParameter[] _sqlparam = new SqlParameter[59];
        _sqlparam[0] = new SqlParameter("@CLIENT_ID", objClientDetails.ClientId);
        _sqlparam[1] = new SqlParameter("@APPLICATION_NO", objClientDetails.ApplicationNo);
        _sqlparam[2] = new SqlParameter("@SALUTATION", objClientDetails.Salutation);
        _sqlparam[3] = new SqlParameter("@CLIENT_FIRST_NAME", objClientDetails.ClientFirstName);
        _sqlparam[4] = new SqlParameter("@CLIENT_MIDDLE_NAME", objClientDetails.ClientFatherName);
        _sqlparam[5] = new SqlParameter("@CLIENT_LAST_NAME", objClientDetails.ClinetLastName);
        _sqlparam[6] = new SqlParameter("@DATE_OF_BIRTH", objClientDetails.ClientDob);
        _sqlparam[7] = new SqlParameter("@GENDER", objClientDetails.ClientGender);
        _sqlparam[8] = new SqlParameter("@ROLE", objClientDetails.ClientRole);

        //communication address
        _sqlparam[9] = new SqlParameter("@C_ADDRESS_LINE_1", objClientDetails.lstClientAddress[0].AddressLine1);
        _sqlparam[10] = new SqlParameter("@C_ADDRESS_LINE_2", objClientDetails.lstClientAddress[0].AddressLine2);
        _sqlparam[11] = new SqlParameter("@C_ADDRESS_LINE_3", objClientDetails.lstClientAddress[0].AddressLine3);
        _sqlparam[12] = new SqlParameter("@C_ADDRESS_LINE_4", objClientDetails.lstClientAddress[0].AddressLine4);
        _sqlparam[13] = new SqlParameter("@C_ADDRESS_LINE_5", objClientDetails.lstClientAddress[0].AddressLine5);
        _sqlparam[14] = new SqlParameter("@C_LANDMARK", objClientDetails.lstClientAddress[0].LandMark);
        _sqlparam[15] = new SqlParameter("@C_PINCODE", objClientDetails.lstClientAddress[0].PinCode);
        _sqlparam[16] = new SqlParameter("@C_CITY", objClientDetails.lstClientAddress[0].City);
        _sqlparam[17] = new SqlParameter("@C_DISTRICT", objClientDetails.lstClientAddress[0].District);
        _sqlparam[18] = new SqlParameter("@C_STATE", objClientDetails.lstClientAddress[0].State);
        _sqlparam[19] = new SqlParameter("@C_COUNTRY_CODE", objClientDetails.lstClientAddress[0].CountryCode);
        _sqlparam[20] = new SqlParameter("@C_ADDRESS_REMARK", objClientDetails.lstClientAddress[0].AddressRemark);
        _sqlparam[21] = new SqlParameter("@C_PHONE_1", objClientDetails.lstClientAddress[0].Phone1);
        _sqlparam[22] = new SqlParameter("@C_PHONE_2", objClientDetails.lstClientAddress[0].Phone2);
        _sqlparam[23] = new SqlParameter("@C_TEL_NO", objClientDetails.lstClientAddress[0].TelNo);
        _sqlparam[24] = new SqlParameter("@C_MOBILE_NO", objClientDetails.lstClientAddress[0].MobileNo);
        _sqlparam[25] = new SqlParameter("@C_EMAIL_ID", objClientDetails.lstClientAddress[0].EmailId);
        _sqlparam[26] = new SqlParameter("@C_FAX", objClientDetails.lstClientAddress[0].FaxNo);

        //personal address
        if (objClientDetails.lstClientAddress.Count == 2)
        {
            //27-44
            _sqlparam[27] = new SqlParameter("@P_ADDRESS_LINE_1", objClientDetails.lstClientAddress[1].AddressLine1);
            _sqlparam[28] = new SqlParameter("@P_ADDRESS_LINE_2", objClientDetails.lstClientAddress[1].AddressLine2);
            _sqlparam[29] = new SqlParameter("@P_ADDRESS_LINE_3", objClientDetails.lstClientAddress[1].AddressLine3);
            _sqlparam[30] = new SqlParameter("@P_ADDRESS_LINE_4", objClientDetails.lstClientAddress[1].AddressLine4);
            _sqlparam[31] = new SqlParameter("@P_ADDRESS_LINE_5", objClientDetails.lstClientAddress[1].AddressLine5);
            _sqlparam[32] = new SqlParameter("@P_LANDMARK", objClientDetails.lstClientAddress[1].LandMark);
            _sqlparam[33] = new SqlParameter("@P_PINCODE", objClientDetails.lstClientAddress[1].PinCode);
            _sqlparam[34] = new SqlParameter("@P_CITY", objClientDetails.lstClientAddress[1].City);
            _sqlparam[35] = new SqlParameter("@P_DISTRICT", objClientDetails.lstClientAddress[1].District);
            _sqlparam[36] = new SqlParameter("@P_STATE", objClientDetails.lstClientAddress[1].State);
            _sqlparam[37] = new SqlParameter("@P_COUNTRY_CODE", objClientDetails.lstClientAddress[1].CountryCode);
            _sqlparam[38] = new SqlParameter("@P_ADDRESS_REMARK", objClientDetails.lstClientAddress[1].AddressRemark);
            _sqlparam[39] = new SqlParameter("@P_PHONE_1", objClientDetails.lstClientAddress[1].Phone1);
            _sqlparam[40] = new SqlParameter("@P_PHONE_2", objClientDetails.lstClientAddress[1].Phone2);
            _sqlparam[41] = new SqlParameter("@P_TEL_NO", objClientDetails.lstClientAddress[1].TelNo);
            _sqlparam[42] = new SqlParameter("@P_MOBILE_NO", objClientDetails.lstClientAddress[1].MobileNo);
            _sqlparam[43] = new SqlParameter("@P_EMAIL_ID", objClientDetails.lstClientAddress[1].EmailId);
            _sqlparam[44] = new SqlParameter("@P_FAX", objClientDetails.lstClientAddress[1].FaxNo);
        }
        else
        {
            _sqlparam[27] = new SqlParameter("@P_ADDRESS_LINE_1", string.Empty);
            _sqlparam[28] = new SqlParameter("@P_ADDRESS_LINE_2", string.Empty);
            _sqlparam[29] = new SqlParameter("@P_ADDRESS_LINE_3", string.Empty);
            _sqlparam[30] = new SqlParameter("@P_ADDRESS_LINE_4", string.Empty);
            _sqlparam[31] = new SqlParameter("@P_ADDRESS_LINE_5", string.Empty);
            _sqlparam[32] = new SqlParameter("@P_LANDMARK", string.Empty);
            _sqlparam[33] = new SqlParameter("@P_PINCODE", -1);
            _sqlparam[34] = new SqlParameter("@P_CITY", string.Empty);
            _sqlparam[35] = new SqlParameter("@P_DISTRICT", string.Empty);
            _sqlparam[36] = new SqlParameter("@P_STATE", string.Empty);
            _sqlparam[37] = new SqlParameter("@P_COUNTRY_CODE", string.Empty);
            _sqlparam[38] = new SqlParameter("@P_ADDRESS_REMARK", string.Empty);
            _sqlparam[39] = new SqlParameter("@P_PHONE_1", string.Empty);
            _sqlparam[40] = new SqlParameter("@P_PHONE_2", string.Empty);
            _sqlparam[41] = new SqlParameter("@P_TEL_NO", string.Empty);
            _sqlparam[42] = new SqlParameter("@P_MOBILE_NO", string.Empty);
            _sqlparam[43] = new SqlParameter("@P_EMAIL_ID", string.Empty);
            _sqlparam[44] = new SqlParameter("@P_FAX", string.Empty);

        }
        //new added values
        _sqlparam[45] = new SqlParameter("@CLIENT_TYPE", objClientDetails.ClientType);
        _sqlparam[46] = new SqlParameter("@ASSURED_TYPE", objClientDetails.AssuredType);
        _sqlparam[47] = new SqlParameter("@IsNsap", objClientDetails.IsNSAP);
        _sqlparam[48] = new SqlParameter("@IsSmoker", objClientDetails.IsSmoker);
        _sqlparam[49] = new SqlParameter("@Nationality", objClientDetails.Nationality);
        _sqlparam[50] = new SqlParameter("@Occupation", objClientDetails.Occupation);
        //bmp user info
        _sqlparam[51] = new SqlParameter("@BpmUserId", objClientDetails.objBmpUserInfo._UserID);
        _sqlparam[52] = new SqlParameter("@BpmUserName", objClientDetails.objBmpUserInfo._UserName);
        _sqlparam[53] = new SqlParameter("@BpmGrp", objClientDetails.objBmpUserInfo._UserGroup);
        _sqlparam[54] = new SqlParameter("@BpmBranchCode", objClientDetails.objBmpUserInfo._UserGroup);
        _sqlparam[55] = new SqlParameter("@BpmUserBranch", objClientDetails.objBmpUserInfo._userBranch);
        _sqlparam[56] = new SqlParameter("@BpmProcessName", objClientDetails.objBmpUserInfo._ProcessName);
        _sqlparam[57] = new SqlParameter("@BpmApplicationName", objClientDetails.objBmpUserInfo._ApplicationName);
        _sqlparam[58] = new SqlParameter("@OldClientId", strOldClientId);
        //BMP CLIENT DETAILS
        //intRetVal = objSql.Insertrecord("USP_UWSaralUpdateClientDetailsAddrOnClientId", _sqlparam);
        intRetVal = objSql.Insertrecord("USP_UWSaralAddClientDetails", _sqlparam);
    }

    public void OnlineServiceDeduptClientSearch_GET(ref DataSet _ds, string strFirstName, string strLastName, string strDob, char chGender, string strPincode)
    {
        SqlParameter[] _sqlparam = new SqlParameter[9];
        _sqlparam[0] = new SqlParameter("@firstname", strFirstName);
        _sqlparam[1] = new SqlParameter("@surname", strLastName);
        _sqlparam[2] = new SqlParameter("@dob", strDob);
        _sqlparam[3] = new SqlParameter("@gender", chGender);
        _sqlparam[4] = new SqlParameter("@pincode", strPincode);
        _sqlparam[5] = new SqlParameter("@nameMatchPercent", 50);
        _sqlparam[6] = new SqlParameter("@overallPercent", 50);
        _sqlparam[7] = new SqlParameter("@scantype", string.Empty);
        _sqlparam[8] = new SqlParameter("@b", -1);
        _ds = objSql.RetrieveDataset("Usp_esb_clientSearch_dp_final", _sqlparam);
    }

    public void OnlineServiceDeduptClientDetails_GET(ref DataSet _ds, string strClientId)
    {
        SqlParameter[] _sqlparam = new SqlParameter[1];
        _sqlparam[0] = new SqlParameter("@CLIENT_ID", strClientId);
        _ds = objSql.RetrieveDataset("USP_FETCH_CLIENT_DETAILS_DEDUPE_CLIENTID", _sqlparam);
    }

    public void ValidateRedundantClientOnApplication(UWSaralObjects.ClientDetails objClientDetails, string strOldClientId, ref int intRetVal)
    {
        SqlParameter[] _sqlparam = new SqlParameter[4];
        try
        {
            _sqlparam[0] = new SqlParameter("@CLIENT_ID", objClientDetails.ClientId);
            _sqlparam[1] = new SqlParameter("@APPLICATION_NO", objClientDetails.ApplicationNo);
            _sqlparam[2] = new SqlParameter("@ROLE", objClientDetails.AssuredType);
            _sqlparam[3] = new SqlParameter("@OldClientId", strOldClientId);
            objSql.RetrieveDataset("USP_UWSaralValidateRedundantClientOnApplication", _sqlparam);
            intRetVal = 1;
        }
        catch (Exception Error)
        {
            if (Error.Message.Contains("UCE"))
            {
                intRetVal = -1;
            }
            else
            {
                intRetVal = 0;
            }
        }
    }

    /*added by shri on 03 july 17 to create specific serialize data into xml format */
    public static string GetXMLFromObject(object o)
    {
        StringWriter sw = new StringWriter();
        XmlTextWriter tw = null;
        try
        {
            XmlSerializer serializer = new XmlSerializer(o.GetType());
            tw = new XmlTextWriter(sw);
            serializer.Serialize(tw, o);
        }
        catch (Exception ex)
        {
            //Handle Exception Code
        }
        finally
        {
            sw.Close();
            if (tw != null)
            {
                tw.Close();
            }
        }
        return sw.ToString();
    }

    /*ADDED BY SHRI ON 19 JULY 17 TO UPDATE RIDER INFO*/
    public void ManageRiderInfo(string strAppno, DataTable dtRideInfo,string struserid, ref int response)
    {
        Logger.Info(strAppno + "STAG 3-A :PageName :Commfun.CS // MethodeName : ManageRiderInfo");
        SqlParameter[] _sqlparam = new SqlParameter[2];
        _sqlparam[0] = new SqlParameter("@Rider_Details_Type", dtRideInfo);
        _sqlparam[1] = new SqlParameter("@UserID", struserid);
        response = objSql.Insertrecord("USP_UWSARAL_MANAGE_RIDER_INFO", _sqlparam);
    }

    /*ADDED BY SHRI ON 20 JULY 17 TO FETCH RIDER INFO*/
    public void FetchRiderGrid_GET(string strAppno, string strAppType, ref DataSet dsRiderInfo)
    {
        Logger.Info(strAppno + "STAG 3-A :PageName :Commfun.CS // MethodeName : FetchRiderGrid_GET");
        SqlParameter[] _sqlparam = new SqlParameter[2];
        _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strAppno);
        _sqlparam[1] = new SqlParameter("@Apptype", strAppType);
        //dsRiderInfo = objSql.RetrieveDataset("USP_UWSARAL_FETCH_RIDER", _sqlparam);
        dsRiderInfo = objSql.RetrieveDataset("USP_UWSARAL_FETCH_RIDER_V1", _sqlparam);
    }

    /*ADDED BY SHRI ON 20 JULY 17 TO UPDATE INSTALMENT PREMIUM AMOUT WITH AND WITHOUT TAX*/
    public void UpdateInstalmentWithWithoutTax(string strAppno, DataTable dtRider, ref int intRetVal)
    {
        Logger.Info(strAppno + "STAG 3-A :PageName :Commfun.CS // MethodeName : UpdateInstalmentWithWithoutTax");
        SqlParameter[] _sqlparam = new SqlParameter[2];
        _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strAppno);
        _sqlparam[1] = new SqlParameter("@RiderUpdateInstalmentServiceTax", dtRider);
        intRetVal = objSql.Insertrecord("USP_UPDATE_INSTALMENT_WITH_WITHOUT_TAX", _sqlparam);
    }
    /*end here*/

    public void DeleteExistingLoading(DataRow _dr, ref int response)
    {
        Logger.Info(_dr["ApplicationNo"].ToString() + "STAG 3-A :PageName :Commfun.CS // MethodeName :DeleteExistingLoading");
        SqlParameter[] _sqlparam = new SqlParameter[3];
        _sqlparam[0] = new SqlParameter("@PQuoteNo", _dr["ApplicationNo"].ToString());
        _sqlparam[1] = new SqlParameter("@LDRider", _dr["RiderName"].ToString());
        _sqlparam[2] = new SqlParameter("@LDLoadingType", _dr["LoadingType"].ToString());
        response = objSql.Insertrecord("USP_BPM_ExestingLoadingDelete_V3", _sqlparam);
    }

    public void FetchCountryStateCityFromPincode(ref DataSet _ds, string strPincode)
    {
        SqlParameter[] _sqlparam = new SqlParameter[1];
        _sqlparam[0] = new SqlParameter("@Pincode", strPincode);
        _ds = objSql.RetrieveDataset("usp_QA_FetchClntPinCodeData_V2", _sqlparam);
    }

    public void FetchCommonDropDownList(ref DataSet _ds)
    {
        _ds = objSql.RetrieveDataset_woParam("STP_FETCH_COMMON_DROPDOWN_DETAILS");
    }

    public void FetchPendingDocs(ref DataSet _ds, string strApplicationnumber)
    {
        SqlParameter[] _sqlparam = new SqlParameter[1];
        _sqlparam[0] = new SqlParameter("@ApplicationNumber", strApplicationnumber);
        _ds = objSql.RetrieveDataset("usp_FetchPendingDocs", _sqlparam);

        int tblCounter = _ds.Tables.Count;

        if (_ds.Tables.Count > 0)
        {
            _ds.Tables[0].TableName = "LeadDocuments";
            _ds.Tables[1].TableName = "DocumentProofs";
        }
    }

    /*ADDED BY SHRI ON 20 JULY 17 TO fill list of obj*/
    public static void FillRiderInfoFromPremiumCalcDataTable(ref List<UWSaralObjects.RiderInfo> lstRiderInfo, DataTable dt)
    {
        if (dt != null && dt.Rows.Count > 0)
        {
            for (int i = 0; i < dt.Rows.Count; i++)
            {
                UWSaralObjects.RiderInfo objRiderInfo = new UWSaralObjects.RiderInfo();
                objRiderInfo.ProductCode = Convert.ToString(dt.Rows[i]["ProductCode"]);
                //objRiderInfo.InstalmentPremiumAmt = (string.IsNullOrEmpty(Convert.ToString(dt.Rows[i]["ModalPremiumAmt"]))) ? Convert.ToDouble(dt.Rows[i]["InstalmentPremiumAmt"]) : Convert.ToDouble(dt.Rows[i]["ModalPremiumAmt"]);

                if (string.IsNullOrEmpty(Convert.ToString(dt.Rows[i]["ModalPremiumAmt"])) || Convert.ToDouble(dt.Rows[i]["ModalPremiumAmt"]) == 0)
                {
                    objRiderInfo.InstalmentPremiumAmt = Convert.ToDouble(dt.Rows[i]["InstalmentPremiumAmt"]);
                }
                else
                {
                    objRiderInfo.InstalmentPremiumAmt = Convert.ToDouble(dt.Rows[i]["ModalPremiumAmt"]);
                }

                objRiderInfo.MedicalLoadingPremium = (string.IsNullOrEmpty(Convert.ToString(dt.Rows[i]["MedicalLoadingPremium"]))) ? 0.00 : Convert.ToDouble(dt.Rows[i]["MedicalLoadingPremium"]);

                objRiderInfo.NonMedicalLoadingPremium = (string.IsNullOrEmpty(Convert.ToString(dt.Rows[i]["NonMedicalLoadingPremium"]))) ? 0.00 : Convert.ToDouble(dt.Rows[i]["NonMedicalLoadingPremium"]);

                objRiderInfo.SumAssured = (string.IsNullOrEmpty(Convert.ToString(dt.Rows[i]["SumAssured"]))) ? 0.00 : Convert.ToDouble(dt.Rows[i]["SumAssured"]);

                objRiderInfo.ServiceTax = (string.IsNullOrEmpty(Convert.ToString(dt.Rows[i]["ServiceTax"]))) ? 0.00 : Convert.ToDouble(dt.Rows[i]["ServiceTax"]);

                objRiderInfo.TotalInstalmentPremium = (string.IsNullOrEmpty(Convert.ToString(dt.Rows[i]["TotalInstalmentPremium"]))) ? 0.00 : Convert.ToDouble(dt.Rows[i]["TotalInstalmentPremium"]);

                objRiderInfo.TotalPremiumAmount = (string.IsNullOrEmpty(Convert.ToString(dt.Rows[i]["TotalPremiumAmount"]))) ? 0.00 : Convert.ToDouble(dt.Rows[i]["TotalPremiumAmount"]);

                objRiderInfo.RiderId = Convert.ToString(dt.Rows[i]["RiderInfo"]);
                objRiderInfo.RiderType = Convert.ToString(dt.Rows[i]["RiderType"]);
                lstRiderInfo.Add(objRiderInfo);
            }
        }
    }
    /*end here*/

    public void InsertUpdateLeadDocument(string LeadDocumentId, string FileName, string FilePath, string ModifiedBy, bool IsReceived, bool IsVerified, string LeadID, string DocProofId, string DocTypeId, string UWStatus, ref int Result)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :InsertUpdateLeadDocument");
            SqlConnection conn = new SqlConnection(ConfigurationManager.AppSettings["replica"].ToString());
            SqlCommand command = conn.CreateCommand();
            string strAmlInline = ConfigurationManager.AppSettings["AmlInline"].ToString();
            command.CommandText = "UPDATE " + strAmlInline + " SET FileName=@FileName,FilePath=@FilePath,ModifiedBy=@ModifiedBy,IsUploaded=@IsReceived,ModifiedDate=@ModifiedDate,DocumentProofId=@DocProofId,DocumentTypeId=@DocTypeId,UWStatus=@UWStatus";
            command.CommandText += " where LeadDocumentId = '" + LeadDocumentId + "' and LeadID='" + LeadID + "' ";
            command.Parameters.AddWithValue("@LeadDocumentId", LeadDocumentId);
            command.Parameters.AddWithValue("@FileName", FileName);
            command.Parameters.AddWithValue("@FilePath", FilePath);
            command.Parameters.AddWithValue("@ModifiedBy", ModifiedBy);
            command.Parameters.AddWithValue("@IsReceived", IsReceived);
            command.Parameters.AddWithValue("@IsVerified", IsVerified);
            command.Parameters.AddWithValue("@LeadID", LeadID);
            command.Parameters.AddWithValue("@DocProofId", DocProofId);
            command.Parameters.AddWithValue("@DocTypeId", DocTypeId);
            command.Parameters.AddWithValue("@UWStatus", UWStatus);
            command.Parameters.AddWithValue("@ModifiedDate", DateTime.Now);
            conn.Open();
            command.ExecuteNonQuery();
            conn.Close();
            SqlParameter[] _sqlparam = new SqlParameter[11];
            _sqlparam[0] = new SqlParameter("@LeadDocumentId", LeadDocumentId);
            _sqlparam[1] = new SqlParameter("@FileName", FileName);
            _sqlparam[2] = new SqlParameter("@FilePath", FilePath);
            _sqlparam[3] = new SqlParameter("@ModifiedBy", ModifiedBy);
            _sqlparam[4] = new SqlParameter("@IsReceived", IsReceived);
            _sqlparam[5] = new SqlParameter("@IsVerified", IsVerified);
            _sqlparam[6] = new SqlParameter("@LeadID", LeadID);
            _sqlparam[7] = new SqlParameter("@DocProofId", DocProofId);
            _sqlparam[8] = new SqlParameter("@DocTypeId", DocTypeId);
            _sqlparam[9] = new SqlParameter("@UWStatus", UWStatus);
            SqlParameter output = new SqlParameter("@RetValue", SqlDbType.Int)
            {
                Direction = ParameterDirection.InputOutput,
                Value = Result
            };
            _sqlparam[10] = output;
            Result = objSql.Insertrecord("InsertUpdateLeadDocVerification", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWCommentsDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineUWCommentsDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }

    public void AMLDetails_Get(ref DataSet _ds, string strApplicationNo, string strAppType)
    {
        if (strAppType.ToUpper() == "ONLINE")
        {
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@AppType", strAppType);
            _ds = objSql.RetrieveDataset("usp_IntegrateWithFGLIAMLUpdation", _sqlparam);
        }
        else
        {
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NUMBER", strApplicationNo);
            _ds = objSql.RetrieveDataset("USP_SARAL_AML_OFFLINE", _sqlparam);
        }
    }
    /*added by shri on 10 aug 17 to save agent sign verification status*/
    public void SaveAgentVerificationDetails(string strAgentAppNo, string strAppNo, string strAgentCode, string strAgentType, string strProcessName,
                                                 string strVerificationResponse, string strUserName, string strUserID, string strBranchCode, string strBranchName, ref int intRetVal)
    {
        try
        {
            //string strAgentSignStatus;
            SqlParameter[] _sqlparam = new SqlParameter[10];
            _sqlparam[0] = new SqlParameter("@agentApplicationCode", strAgentAppNo);
            _sqlparam[1] = new SqlParameter("@applicationNumber", strAppNo);
            _sqlparam[2] = new SqlParameter("@agentID", strAgentCode);
            _sqlparam[3] = new SqlParameter("@agentType", strAgentType);
            _sqlparam[4] = new SqlParameter("@processName", strProcessName);
            _sqlparam[5] = new SqlParameter("@verificationResp", strVerificationResponse);
            _sqlparam[6] = new SqlParameter("@bpm_userName", strUserName);
            _sqlparam[7] = new SqlParameter("@bpm_userID", strUserID);
            _sqlparam[8] = new SqlParameter("@bpm_branchCode", strBranchCode);
            _sqlparam[9] = new SqlParameter("@bpm_userBranch", strBranchName);
            intRetVal = objSql.InsertUpdaterecord("usp_QA_InsertAgentSignVerDetails_V2", _sqlparam);
        }
        catch (Exception ex)
        {

            throw ex;
        }
    }
    /*added by shri on 29 aug 17*/
    public void FetchClientInfoOnApplciationNo(ref DataSet _ds, string strApplnNo, string strClientType)
    {
        Logger.Info(strApplnNo + "STAG 3-A :PageName :Commfun.CS // MethodeName :DeleteExistingLoading");
        SqlParameter[] _sqlparam = new SqlParameter[2];
        _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strApplnNo);
        _sqlparam[1] = new SqlParameter("@ASSURED_TYPE", strClientType);
        _ds = objSql.RetrieveDataset("USP_UW_SARAL_FETCH_CLIENT_INFO_ON_APPLICATION_NO", _sqlparam);
    }

    /*added by shri on 04 july 17 to fetch questions from database*/
    public void FillHealthQuetions(ref DataSet _ds, string strHealthQuestion, string strAppNo, string strGender)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWCommentsDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@ID", strAppNo);
            _sqlparam[1] = new SqlParameter("@Gender", strGender);
            _sqlparam[2] = new SqlParameter("@Mode", strHealthQuestion);
            _ds = objSql.RetrieveDataset("[Lombardimatersync].[dbo].[sp_uw_DropDown]", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWCommentsDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineUWCommentsDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }
    /*added by shri on 31 aug to fetch offline document*/
    public void FetchPendingDocsOffline(ref DataSet _ds, string strApplicationnumber)
    {
        SqlParameter[] _sqlparam = new SqlParameter[1];
        _sqlparam[0] = new SqlParameter("@APPLN_NO", strApplicationnumber);
        _ds = objSql.RetrieveDataset("USP_SARAL_FETCH_AML_OFFLINE", _sqlparam);

        int tblCounter = _ds.Tables.Count;

        if (_ds.Tables.Count > 0)
        {
            _ds.Tables[0].TableName = "LeadDocuments";
            _ds.Tables[1].TableName = "DocumentProofs";
        }
    }
    /*added by shri on 31 aug to fetch offline document*/
    public void ManageOfflineDocument(string strApplicationNumber, string strDocProof, string strDocTypeId, string strAssuredType, string strUserID, string strUserGroup
                            , string strUserBranch, string strProcessName
                            , string strApplicationName)
    {
        SqlParameter[] _sqlparam = new SqlParameter[9];
        _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strApplicationNumber);
        _sqlparam[1] = new SqlParameter("@DOCUMENT_NAME", strDocProof);
        _sqlparam[2] = new SqlParameter("@DOCUMENT_TYPE", strDocTypeId);
        _sqlparam[3] = new SqlParameter("@ASSURED_TYPE", strAssuredType);
        _sqlparam[4] = new SqlParameter("@bpm_userName", strUserID);
        _sqlparam[5] = new SqlParameter("@bpmgrp", strUserGroup);
        _sqlparam[6] = new SqlParameter("@bpm_branchCode", strUserBranch);
        _sqlparam[7] = new SqlParameter("@bpm_processName", strProcessName);
        _sqlparam[8] = new SqlParameter("@bpm_applicationName", strApplicationName);
        objSql.Insertrecord("USP_SARAL_MANAGE_OFFLINE_DOCUMENT", _sqlparam);
    }

    /*added by shri on 04 sep to fetch offline aml docs*/
    public void FetchAMLOfflineDocument(ref DataSet _ds, string strApplicationNumber)
    {
        SqlParameter[] _sqlparam = new SqlParameter[1];
        _sqlparam[0] = new SqlParameter("@APPLICATION_NUMBER", strApplicationNumber);
        _ds = objSql.RetrieveDataset("USP_SARAL_AML_OFFLINE", _sqlparam);
    }
    /*added by shri on 06 sept to add micro code*/
    public void OnlineBankdetailsfromMicrocode_GET(ref DataSet _ds, string strMicrocode, string strPQuoteNo)
    {
        Logger.Info(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlineLoadingMasterDetails_GET");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@MICRCODE", strMicrocode);
            _ds = objSql.RetrieveDataset("usp_QA_GetBankBranchFromMICR_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlineBankdetailsfromMicrocode_GET");
            SaveErrorLogs(strPQuoteNo, "Failed", "UWSaralDecision", "Commfun.cs", "OnlineBankdetailsfromMicrocode_GET", "E-Error", "", "", Error.ToString());
        }
    }
    /*added by srhi on 06 sept 17 to manage mandate*/
    public void ManageMandate(MandateDetails objMandateDetails, ref int intRetVal)
    {
        Logger.Info(objMandateDetails.ApplicationNo + "STAG 3-A :PageName :Commfun.CS // MethodeName :DeleteExistingLoading");
        SqlParameter[] _sqlparam = new SqlParameter[21];
        _sqlparam[0] = new SqlParameter("@ApplicationNumber", objMandateDetails.ApplicationNo);
        _sqlparam[1] = new SqlParameter("@MicrCode", objMandateDetails.MicroCode);
        _sqlparam[2] = new SqlParameter("@BankName", objMandateDetails.BankName);
        _sqlparam[3] = new SqlParameter("@BranchName", objMandateDetails.BranchName);
        _sqlparam[4] = new SqlParameter("@AutoPayType", objMandateDetails.AutoPay);
        _sqlparam[5] = new SqlParameter("@AccountType", objMandateDetails.AccountType);
        _sqlparam[6] = new SqlParameter("@AcountNumber", objMandateDetails.AccountNumber);
        _sqlparam[7] = new SqlParameter("@AccountHolderName", objMandateDetails.AccountHolderName);
        _sqlparam[8] = new SqlParameter("@MandateDate", objMandateDetails.MandateDate);
        _sqlparam[9] = new SqlParameter("@StrMandateDate", objMandateDetails.strMandateDate);
        _sqlparam[10] = new SqlParameter("@Channel", "online");
        _sqlparam[11] = new SqlParameter("@BpmUserId", objMandateDetails.objLoginUserDetails._UserID);
        _sqlparam[12] = new SqlParameter("@BpmUserName", objMandateDetails.objLoginUserDetails._UserName);
        _sqlparam[13] = new SqlParameter("@BpmGrp", objMandateDetails.objLoginUserDetails._UserGroup);
        _sqlparam[14] = new SqlParameter("@BpmUserBranch", objMandateDetails.objLoginUserDetails._userBranch);
        _sqlparam[15] = new SqlParameter("@BpmProcessName", objMandateDetails.objLoginUserDetails._ProcessName);
        _sqlparam[16] = new SqlParameter("@BpmApplicationName", objMandateDetails.objLoginUserDetails._ApplicationName);
        _sqlparam[17] = new SqlParameter("@CreaditCardNo", objMandateDetails.CreditCardNo);
        _sqlparam[18] = new SqlParameter("@CreditCardType", objMandateDetails.CreditCardType);
        _sqlparam[19] = new SqlParameter("@ValidUpto", objMandateDetails.ValidUpto);
        _sqlparam[20] = new SqlParameter("@CreditCardMask", objMandateDetails.CreditCardMask);
        intRetVal = objSql.Insertrecord("USP_UWSARAL_MANAGE_MANDATE_DETAILS", _sqlparam);
    }
    /*end here*/

    /*For Bulk decision insert*/
    public void OnlineUWBulkDecision_Save(DataTable dtBulkDecision, ref int Result)
    {
        Logger.Info("PageName :Commfun.CS // MethodeName :OnlineUWBulkDecision_Save");
        SqlParameter[] _sqlparam = new SqlParameter[1];
        _sqlparam[0] = new SqlParameter("@BulkData", dtBulkDecision);
        _sqlparam[0].SqlDbType = SqlDbType.Structured;
        Result = objSql.Insertrecord("USP_InsertBulkDecision", _sqlparam);
    }
    /*end here*/

    public void OnlineJournalDetails_GET(ref DataSet _ds, string strPQuoteNo, string strAppType)
    {
        Logger.Info(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlineJournalDetails_GET");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NUMBER", strPQuoteNo);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_FETCH_JOURNAL", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlineJournalDetails_GET");
            SaveErrorLogs(strPQuoteNo, "Failed", "UWSaralDecision", "Commfun.cs", "OnlineJournalDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public int MaintainApplicationLog(string strPQuoteNo, string strEventName, string strCode, string strUserId, string Assignto, ref int intRetVal)
    {
        Logger.Info(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :MaintainApplicationLog");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[5];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NUMBER", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@EVENT_NAME", strEventName);
            _sqlparam[2] = new SqlParameter("@CODE", strCode);
            _sqlparam[3] = new SqlParameter("@USER_ID", strUserId);
            _sqlparam[4] = new SqlParameter("@ASSIGNTO", Assignto);
            intRetVal = objSql.Insertrecord("USP_UWSARAL_UPDATE_APPLICATION_STATUS", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :MaintainApplicationLog");
            SaveErrorLogs(strPQuoteNo, "Failed", "UWSaralDecision", "Commfun.cs", "MaintainApplicationLog", "E-Error", "", "", Error.ToString());
        }
        return intRetVal;
    }
    /*added by shri on 11 sept 17 to fetch manual allocation based on filter*/
    public void FetchManualAllocation(string strChannel, int intFilterType, string strInput1, string strInput2, ref DataSet _ds)
    {
        Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchManualAllocation");
        SqlParameter[] _sqlparam = new SqlParameter[4];
        _sqlparam[0] = new SqlParameter("@Channel", strChannel);
        _sqlparam[1] = new SqlParameter("@FilterType", intFilterType);
        _sqlparam[2] = new SqlParameter("@InputValue1", strInput1);
        _sqlparam[3] = new SqlParameter("@InputValue2", strInput2);
        _ds = objSql.RetrieveDataset("USP_UWSARAL_MANUAL_ALLOCATION", _sqlparam);
    }

    public void ManageApplication(string strApplication, string strUsers, int intFilterType, string struserid, ref int intRetVal)
    {
        Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :ManageApplication");
        SqlParameter[] _sqlparam = new SqlParameter[4];
        _sqlparam[0] = new SqlParameter("@APPLICATION_NUMBER", strApplication);
        _sqlparam[1] = new SqlParameter("@USERID", strUsers);
        _sqlparam[2] = new SqlParameter("@FILTER_TYPE", intFilterType);
        _sqlparam[3] = new SqlParameter("@ASSIGNBY", struserid);
        intRetVal = objSql.Insertrecord("USP_UWSARAL_MANAGE_APPLICATION", _sqlparam);
    }
    public void FetchUser(string strChannel, ref DataSet _ds)
    {
        Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :ManageApplication");
        SqlParameter[] _sqlparam = new SqlParameter[1];
        _sqlparam[0] = new SqlParameter("@channel", strChannel);
        _ds = objSql.RetrieveDataset("USP_UWSARAL_FETCH_MANUAL_ALLICATION_USERS_LIST", _sqlparam);
    }
    /*added by shri on 23 oct 17 to add user id */
    public void UpdatePolicyStatus(string strApplicationNumber, string strPolicyStatus, string strUserId, ref int intRetVal)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWCommentsDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NUMBER", strApplicationNumber);
            _sqlparam[1] = new SqlParameter("@POLICY_STATUS", strPolicyStatus);
            _sqlparam[2] = new SqlParameter("@USER_ID", strUserId);
            intRetVal = objSql.Insertrecord("STP_UPDATE_POLICY_STATUS_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWCommentsDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineUWCommentsDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }
    /*end here*/

    public void OnlineUWMISDecision_Save(string strPQuoteNo, string strDecision, string strbpm_branchCode, string strbpm_processName, string strbpm_userBranch,
        string strAppType, string strUserId, string strUserGroup, string strRejectionCode, string strRejectionDesc, ref int intRetVal)
    {
        Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :ManageApplication");
        SqlParameter[] _sqlparam = new SqlParameter[13];
        _sqlparam[0] = new SqlParameter("@DCG_appType", strAppType);
        _sqlparam[1] = new SqlParameter("@DCG_applicationNoStr", strPQuoteNo);
        _sqlparam[2] = new SqlParameter("@DCG_decision", strDecision);
        _sqlparam[3] = new SqlParameter("@DCG_holdPrinting", "");
        _sqlparam[4] = new SqlParameter("@DCG_rejectioncode", strRejectionCode);
        _sqlparam[5] = new SqlParameter("@DCG_rejectionDesc", strRejectionDesc);
        _sqlparam[6] = new SqlParameter("@bpm_userID", strUserId);
        _sqlparam[7] = new SqlParameter("@bpm_userName", strUserId);
        _sqlparam[8] = new SqlParameter("@bpmgrp", strUserGroup);
        _sqlparam[9] = new SqlParameter("@bpm_branchCode", strbpm_branchCode);
        //_sqlparam[10] = new SqlParameter("@bpm_creationDate", DateTime.Now.ToString());
        //_sqlparam[11] = new SqlParameter("@bpm_systemDate", DateTime.Now.ToString());
        //_sqlparam[12] = new SqlParameter("@bpm_businessDate", DateTime.Now.ToString());
        _sqlparam[10] = new SqlParameter("@bpm_userBranch", strbpm_userBranch);
        _sqlparam[11] = new SqlParameter("@bpm_processName", strbpm_processName);
        _sqlparam[12] = new SqlParameter("@bpm_applicationName", strPQuoteNo);
        intRetVal = objSql.Insertrecord("USP_BPM_MISDetailsFetch_V2", _sqlparam);
    }
    /*added by shri on 27 oct 17 to fetch application details from search*/
    //********28.1 Code Commented As new procedure made which will call UW and revival application *******/
    //23NOV2017
    //public void GetApplicationDetails(string strApplicationNo, string strUserId, string strChanneltype, ref DataSet _ds)
    //{
    //    Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :GetApplicationDetails");
    //    SqlParameter[] _sqlparam = new SqlParameter[3];
    //    _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strApplicationNo);
    //    _sqlparam[1] = new SqlParameter("@USERID", strUserId);
    //    _sqlparam[2] = new SqlParameter("@Channeltype", strChanneltype);
    //    //_ds = objSql.RetrieveDataset("USP_UWSARAL_DASHBOAR_FETCH_APPLICAION_DETAILS_REISSUE", _sqlp aram);
    //    //_ds = objSql.RetrieveDataset("USP_UWSARAL_DASHBOAR_FETCH_APPLICAION_DETAILS_REISSUE_V1", _sqlparam);
    //    _ds = objSql.RetrieveDataset("USP_UWSARAL_DASHBOAR_FETCH_APPLICAION_DETAILS_REISSUE_V2", _sqlparam);
    //    //_ds = objSql.RetrieveDataset("USP_UWSARAL_DASHBOAR_FETCH_APPLICAION_DETAILS_REISSUE_V3", _sqlparam); 
    //}
    //23NOV2017 END
    //********28.1 Code Commented As new procedure made which will call UW and revival application *******/
    public void FetchReferUser(string strApplicationNo, string strChannel, ref DataSet _ds)
    {
        /*DROP PROCEDURE AFTER RELEASE*/
        Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchReferUser");
        SqlParameter[] _sqlparam = new SqlParameter[2];
        _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strApplicationNo);
        _sqlparam[1] = new SqlParameter("@CHANNEL", strChannel);
        _ds = objSql.RetrieveDataset("USP_UWSARAL_REFER_FETCH_USER_LIST", _sqlparam);
    }
    public void FetchReferUser(string strApplicationNo, string strChannel, string strAssignType, string strUserId, ref DataSet _ds)
    {
        Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchReferUser");
        SqlParameter[] _sqlparam = new SqlParameter[4];
        _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strApplicationNo);
        _sqlparam[1] = new SqlParameter("@CHANNEL", strChannel);
        _sqlparam[2] = new SqlParameter("@ASSIGNTYPE", strAssignType);
        _sqlparam[3] = new SqlParameter("@USER_ID", strUserId);
        _ds = objSql.RetrieveDataset("USP_UWSARAL_REFER_FETCH_USER_LIST_V4", _sqlparam);
    }
    public void ManageReferUser(string strApplicationNo, string strChannel, string strReferTo, string strReferFrom, string strType, ref int intRef)
    {
        Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchReferUser");
        SqlParameter[] _sqlparam = new SqlParameter[5];
        _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strApplicationNo);
        _sqlparam[1] = new SqlParameter("@CHANNEL", strChannel);
        _sqlparam[2] = new SqlParameter("@REFER_TO", strReferTo);
        _sqlparam[3] = new SqlParameter("@REFER_FROM", strReferFrom);
        _sqlparam[4] = new SqlParameter("@TYPE", strType);
        intRef = objSql.Insertrecord("USP_UWSARAL_REFER_MANAGE_REFER_OPTION", _sqlparam);
    }
    /*added by shri on 07 nov 17 to add application life cycle*/
    public void ManageApplicationLifeCycle(string strApplicationNo, string strUserKey, string strEventName, bool blnEventType, ref int intRet)
    {
        Logger.Info(":PageName :UWSaralServices/CommFun.CS // MethodeName :ManageApplicationLifeCycle");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@USER_KEY", strUserKey);
            _sqlparam[2] = new SqlParameter("@EVENT_NAME", strEventName);
            _sqlparam[3] = new SqlParameter("@EVENT_TYPE", blnEventType);
            intRet = objSql.Insertrecord("USP_UWSARAL_MANAGE_APPLICATION_LIFE_CYCLE", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(":PageName :UWSaralServices/CommFun.CS // MethodeName :ManageApplicationLifeCycle");
            SaveErrorLogs(string.Empty, "Failed", "UWSaralDecision", "Commfun.cs", "ManageApplicationLifeCycle", "E-Error", "", "", Error.ToString());
        }
    }
    /*end here*/
    public void ManageApplicationObject(int intSrNo, string strApplicationNo, string strObjectData, bool blnIsPost, string strUserId, ref int intRet)
    {
        Logger.Info(":PageName :UWSaralServices/CommFun.CS // MethodeName :ManageApplicationObject");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[6];
            _sqlparam[0] = new SqlParameter("@SRNNO", intSrNo);
            _sqlparam[1] = new SqlParameter("@APPLICATION_NO", strApplicationNo);
            _sqlparam[2] = new SqlParameter("@OBJECT_DATA", strObjectData);
            _sqlparam[3] = new SqlParameter("@IS_POSTED", blnIsPost);
            _sqlparam[4] = new SqlParameter("@USER_ID", strUserId);
            _sqlparam[5] = new SqlParameter("@REF_INT", intRet);
            _sqlparam[5].Direction = ParameterDirection.InputOutput;
            intRet = objSql.Insertrecord("USP_UWSARAL_MANAGE_APP_OBJECT", _sqlparam);
            intRet = Convert.ToInt32(_sqlparam[5].Value);
        }
        catch (Exception Error)
        {
            Logger.Error(":PageName :UWSaralServices/CommFun.CS // MethodeName :ManageApplicationObject");
            SaveErrorLogs(string.Empty, "Failed", "UWSaralDecision", "Commfun.cs", "ManageApplicationObject", "E-Error", "", "", Error.ToString());
        }
    }

    public void FetchApplicationObject(string strApplicationNo, string strAppType, string strUserId, ref DataSet _ds)
    {
        Logger.Info(":PageName :UWSaralServices/CommFun.CS // MethodeName :ManageApplicationObject");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@AppType", strAppType);
            _sqlparam[2] = new SqlParameter("@USERID", strUserId);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_FETCH_APPLICATION_OBJECT", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(":PageName :UWSaralServices/CommFun.CS // MethodeName :ManageApplicationObject");
            SaveErrorLogs(string.Empty, "Failed", "UWSaralDecision", "Commfun.cs", "ManageApplicationObject", "E-Error", "", "", Error.ToString());
        }
    }

    public static void ConvertXmlToDataSet(string strXml, ref DataSet _ds)
    {
        if (strXml != null)
        {
            _ds.ReadXml(new System.IO.StringReader(strXml));
        }
    }

    public void FetchMasterRequiredData(string strApplicationNo, string strAppType, ref DataSet _ds)
    {
        Logger.Info(":PageName :UWSaralServices/CommFun.CS // MethodeName :FetchMasterRequiredData");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@APPLICATION_TYPE", strAppType);
            _ds = objSql.RetrieveDataset("USP_FETCH_MASTERE_TABLE_REQUIRED_INFO", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(":PageName :UWSaralServices/CommFun.CS // MethodeName :FetchMasterRequiredData");
            SaveErrorLogs(string.Empty, "Failed", "UWSaralDecision", "Commfun.cs", "FetchMasterRequiredData", "E-Error", "", "", Error.ToString());
        }
    }

    public void ManageApplicationStatus(string strApplicationNo, string strEventName, string strCode, string strUserId, string strAssignTo,string strAppSource, ref int intRet)
    {
        Logger.Info(":PageName :UWSaralServices/CommFun.CS // MethodeName :FetchMasterRequiredData");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[6];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NUMBER", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@EVENT_NAME", strEventName);
            _sqlparam[2] = new SqlParameter("@CODE", strCode);
            _sqlparam[3] = new SqlParameter("@USER_ID", strUserId);
            _sqlparam[4] = new SqlParameter("@ASSIGNTO", strAssignTo);
            _sqlparam[5] = new SqlParameter("@APPSOURCE", strAppSource);
            intRet = objSql.Insertrecord("USP_UWSARAL_APPLICATION_CHANGE_STATUS_V1", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(":PageName :UWSaralServices/CommFun.CS // MethodeName :FetchMasterRequiredData");
            SaveErrorLogs(string.Empty, "Failed", "UWSaralDecision", "Commfun.cs", "FetchMasterRequiredData", "E-Error", "", "", Error.ToString());
        }
    }
    public void ManageApplicationStatus_Combi(string strApplicationNo, string strEventName, string strCode, string strUserId, string strAssignTo, string strAppSource, ref int intRet)
    {
        Logger.Info(":PageName :UWSaralServices/CommFun.CS // MethodeName :FetchMasterRequiredData");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[6];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NUMBER", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@EVENT_NAME", strEventName);
            _sqlparam[2] = new SqlParameter("@CODE", strCode);
            _sqlparam[3] = new SqlParameter("@USER_ID", strUserId);
            _sqlparam[4] = new SqlParameter("@ASSIGNTO", strAssignTo);
            _sqlparam[5] = new SqlParameter("@APPSOURCE", strAppSource);
            intRet = objSql.Insertrecord("USP_UWSARAL_APPLICATION_CHANGE_STATUS_V1_COMBI", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(":PageName :UWSaralServices/CommFun.CS // MethodeName :FetchMasterRequiredData");
            SaveErrorLogs(string.Empty, "Failed", "UWSaralDecision", "Commfun.cs", "FetchMasterRequiredData", "E-Error", "", "", Error.ToString());
        }
    }
    /*end here*/

    public void InsertAppStatus(string strApplicationNumber, string strUserId, ref int intRet)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :UpdateApplicationStatus");
            SqlParameter[] _sqlparam = new SqlParameter[8];
            _sqlparam[0] = new SqlParameter("@applicationNumbers", strApplicationNumber);
            _sqlparam[1] = new SqlParameter("@ApplicationStatus", "091");
            _sqlparam[2] = new SqlParameter("@bpm_userID", strUserId);
            _sqlparam[3] = new SqlParameter("@bpm_userName", string.Empty);
            _sqlparam[4] = new SqlParameter("@bpm_branchCode", string.Empty);
            _sqlparam[5] = new SqlParameter("@bpm_userBranch", string.Empty);
            _sqlparam[6] = new SqlParameter("@bpm_processName", "Manual Underwriting");
            _sqlparam[7] = new SqlParameter("@bpm_applicationName", "FGLIFE");

            intRet = objSql.Insertrecord("usp_QA_Save_LF_applicationstatus_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateAppStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "UpdateAppStatus", "E-Error", "", "", Error.ToString());
        }
    }

    public void ManageNsapFlag(string strApplicationNumber, bool blnNsapFlag, ref int intRet)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :UpdateApplicationStatus");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NUMBER", strApplicationNumber);
            _sqlparam[1] = new SqlParameter("@NSAP_FLAG", blnNsapFlag);
            intRet = objSql.Insertrecord("USP_UWSARAL_UPDATE_NSAP_STATUS", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateAppStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "UpdateAppStatus", "E-Error", "", "", Error.ToString());
        }
    }

    /*added by shri on 23 dec 17 for bulk allocation*/
    public void ManageBulkAllocation(string strApplicationNumber, string strUserId, ref int intRet)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :UpdateApplicationStatus");
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strApplicationNumber);
            _sqlparam[1] = new SqlParameter("@USER_ID", strUserId);
            SqlParameter output = new SqlParameter("@INT_RET", SqlDbType.Int, 5000)
            {
                Direction = ParameterDirection.InputOutput,
                Value = intRet
            };
            _sqlparam[2] = output;
            objSql.Insertrecord("UPS_UWSARAL_BULK_ALLOCATION", _sqlparam);
            intRet = Convert.ToInt32(_sqlparam[2].Value);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateAppStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "UpdateAppStatus", "E-Error", "", "", Error.ToString());
        }
    }

    /*added by shri on 24 dec 17 for risk parameter*/
    public void ManageBulkRiskParameter(DataTable _dtRiskParameter, ref int intRet)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :UpdateApplicationStatus");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@TYP_UWSARAL_RISK_PARAMETER", _dtRiskParameter);
            objSql.Insertrecord("USP_UWSARAL_MANAGE_RISK_PARAMETER", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateAppStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "UpdateAppStatus", "E-Error", "", "", Error.ToString());
        }
    }

    /*added by shri on 28 dec 17 for risk parameter*/
    public void InsertUwDecisionTracking(string strApplicationNo, string strUserId, string strCurrDateTime, string strEventName, ref int intRet)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :UpdateApplicationStatus");
            SqlParameter[] _sqlparam = new SqlParameter[6];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@UserId", strUserId);
            _sqlparam[2] = new SqlParameter("@StartDate", strCurrDateTime);
            _sqlparam[3] = new SqlParameter("@SystemDate", strCurrDateTime);
            _sqlparam[4] = new SqlParameter("@EventName", strEventName);
            SqlParameter output = new SqlParameter("@IntRet", SqlDbType.Int, 5000)
            {
                Direction = ParameterDirection.InputOutput,
                Value = intRet
            };
            _sqlparam[5] = output;
            objSql.Insertrecord("USP_UWSARAL_INSERT_UWDECISION_TRACKING", _sqlparam);
            intRet = Convert.ToInt32(_sqlparam[5].Value);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateAppStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "UpdateAppStatus", "E-Error", "", "", Error.ToString());
        }
    }

    /*added by shri on 28 dec 17 for risk parameter*/
    public void UpdateUwDecisionTracking(int intSrNo, string strEndDate, ref int intRet)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :UpdateApplicationStatus");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@SRNO", intSrNo);
            _sqlparam[1] = new SqlParameter("@EndDate", strEndDate);
            objSql.Insertrecord("USP_UWSARAL_UPDATE_UWDECISION_TRACKING", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateAppStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "UpdateAppStatus", "E-Error", "", "", Error.ToString());
        }
    }

    /*added by shri on 29 dec 17 for risk parameter*/
    public void FetchBulkRiskApplication(string strApplicationNo, ref DataSet ds)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :UpdateApplicationStatus");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strApplicationNo);
            ds = objSql.RetrieveDataset("USP_UWSARAL_MANAGE_RISK_APPLICATION", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateAppStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "UpdateAppStatus", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:1 START*/
    public void FetchAutoCommentDetails(string strApplicationNo, string strChannel, ref DataSet ds)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :FetchAutoCommentDetails");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@APPLICATIONNO", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@CHANNEL", strChannel);
            //ds = objSql.RetrieveDataset("USP_UWSARAL_FETCH_AUTO_COMMENT_V2", _sqlparam);
            //ds = objSql.RetrieveDataset("USP_UWSARAL_FETCH_AUTO_COMMENT_V3", _sqlparam);
            ds = objSql.RetrieveDataset("USP_UWSARAL_FETCH_AUTO_COMMENT_V4", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :FetchAutoCommentDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "FetchAutoCommentDetails", "E-Error", "", "", Error.ToString());
        }
    }

    public void FetchUWProductivity(string strFromDate, string strToDate, string strUserId, ref DataSet ds)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :FetchUWProductivity");
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@FROM_DATE", strFromDate);
            _sqlparam[1] = new SqlParameter("@TO_DATE", strToDate);
            _sqlparam[2] = new SqlParameter("@USER_ID", strUserId);
            ds = objSql.RetrieveDataset("USP_UWSARAL_FETCH_UWPRODUCTIVITY", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :FetchUWProductivity Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "FetchUWProductivity", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:1 END*/
    /*ID:2 START*/
    public void UpdateUWDecitionAdditionalInfoFlag(string strApplicationNo, bool blnIsVerified, int intFlag, ref int intRet)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :FetchUWProductivity");
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@APPLICATIONNO", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@ISVERIFED", blnIsVerified);
            _sqlparam[2] = new SqlParameter("@FLAG", intFlag);
            intRet = objSql.Insertrecord("USP_UWSARAL_UWDECISION_ADDITIONAL_INFO_FLAG_UPDATE_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :FetchUWProductivity Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "FetchUWProductivity", "E-Error", "", "", Error.ToString());
        }
    }
    public void UpdateUWDecitionAdditionalInfoDetails(string strApplicationNo, string strDetails, int intFlag, string strUserId, ref int intRet)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :UpdateUWDecitionAdditionalInfoDetails");
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@APPLICATIONNO", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@DETAILS", strDetails);
            _sqlparam[2] = new SqlParameter("@FLAG", intFlag);
            _sqlparam[3] = new SqlParameter("@USERID", strUserId);
            intRet = objSql.Insertrecord("USP_UWSARAL_UWDECISION_UPDATE_AADHAR_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateUWDecitionAdditionalInfoDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "UpdateUWDecitionAdditionalInfoDetails", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:2 END*/
    /*ID:3 END*/
    public void InsertUserChangesLog(string strApplicationNo, string strUserId, string strKeys, string strValue, ref int intRet)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :UpdateUWDecitionAdditionalInfoDetails");
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@UserId", strUserId);
            _sqlparam[2] = new SqlParameter("@Keys", strKeys);
            _sqlparam[3] = new SqlParameter("@Value", strValue);
            intRet = objSql.Insertrecord("USP_UWSARAL_INSERT_USER_CHANGES_LOG", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateUWDecitionAdditionalInfoDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "UpdateUWDecitionAdditionalInfoDetails", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineApplicationdashbordBucketsCountAll_Get(string strUwmode, string struserid, string strLinkOption, string strUserGroup, ref DataSet _dsAppdtls)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationdashbord_Get");
            _dsAppdtls = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@strUwmode", strUwmode);
            _sqlparam[1] = new SqlParameter("@struserid", struserid);
            _sqlparam[2] = new SqlParameter("@struserGroup", strUserGroup);
            _sqlparam[3] = new SqlParameter("@strlnkOption", strLinkOption);
            //_dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordCountDetailsAll_Get_V4", _sqlparam);
            _dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordCountDetailsAll_Get_V4_Online_Offline_Merge_CountTest", _sqlparam);
            //_dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordCountDetailsAll_Get_V4_Online_Offline_Merge", _sqlparam);
            //_dsAppdtls = objSql.RetrieveDataset("usp_UWOnlineDashbordCountDetailsAll_Get_V3", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationdashbord_Get Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationdashbord_Get", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:3 END*/

    /*ID:4 START*/
    /*start here*/
    public void ReportReject(string frmDate, string ToDate, ref DataSet ds)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :FetchReportData");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@FROM_DATE", frmDate);
            _sqlparam[1] = new SqlParameter("@TO_DATE", ToDate);
            ds = objSql.RetrieveDataset("USP_UWSARAL_MIS_FETCH_DOCQC_FAIL_CASE", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateUWDecitionAdditionalInfoDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "FetchReportReject", "BAL.CS", "UpdateUWDecitionAdditionalInfoDetails", "E-Error", "", "", Error.ToString());
        }
    }

    public void ReportFail(string frmDate, string ToDate, ref DataSet ds)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :FetchReportData");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@FROM_DATE", frmDate);
            _sqlparam[1] = new SqlParameter("@TO_DATE", ToDate);
            ds = objSql.RetrieveDataset("USP_UWSARAL_MIS_FETCH_STP_FAIL_CASE", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateUWDecitionAdditionalInfoDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "FetchReportFail", "BAL.CS", "UpdateUWDecitionAdditionalInfoDetails", "E-Error", "", "", Error.ToString());
        }
    }


    public void ReportFY(ref DataSet ds)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :FetchReportData");
            SqlParameter[] _sqlparam = new SqlParameter[0];
            ds = objSql.RetrieveDataset("USP_UWSARAL_MIS_CURRENT_FINANCIAL_YEAR", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateUWDecitionAdditionalInfoDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "FetchReportFY", "BAL.CS", "UpdateUWDecitionAdditionalInfoDetails", "E-Error", "", "", Error.ToString());
        }
    }



    public void ReportReqRaised(string frmDate, string ToDate, ref DataSet ds)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :FetchReportData");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@FROM_DATE", frmDate);
            _sqlparam[1] = new SqlParameter("@TO_DATE", ToDate);
            ds = objSql.RetrieveDataset("USP_UWSARAL_FETCH_MIS_REQUIREMENTS_RAISED", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateUWDecitionAdditionalInfoDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "FetchReqRaised", "BAL.CS", "UpdateUWDecitionAdditionalInfoDetails", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:4 END*/
    /*ID:5 START*/
    public void UWDecisionManageDecisionDetails(DataTable _dt, ref int intRet)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :UWDecisionManageDecisionDetails");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@T_UWSARAL_DECISION_TYPE", _dt);
            intRet = objSql.Insertrecord("USP_UWSARAL_MANAGE_DECISION_TYPE", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UWDecisionManageDecisionDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "FetchReqRaised", "BAL.CS", "UWDecisionManageDecisionDetails", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:5 END*/
    /*ID:6 START*/
    public void Save_MedicalReport_Reason(int Mode, string strApplicationNoStr, int AssignType, string strBpm_userID, ref int resp)
    {
        try
        {
            Logger.Info(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinefollowupDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@Mode", Mode);
            _sqlparam[1] = new SqlParameter("@Appno", strApplicationNoStr);
            //_sqlparam[2] = new SqlParameter("@MedicalReason", ReqReason);
            _sqlparam[2] = new SqlParameter("@Reason", AssignType);
            _sqlparam[3] = new SqlParameter("@UserId", strBpm_userID);
            resp = objSql.Insertrecord("USP_UWSARAL_SAVE_MEDICALREASON", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWDecisionDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strApplicationNoStr, "Failed", "UWPortfolio", "Commfun.cs", "OnlinefollowupDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }
    public void Save_Country(string StrMode, string strApplicationNoStr, string Country, string strBpm_userID, ref int resp)
    {
        try
        {
            Logger.Info(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinefollowupDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@Mode", StrMode);
            _sqlparam[1] = new SqlParameter("@Appno", strApplicationNoStr);
            //_sqlparam[2] = new SqlParameter("@MedicalReason", ReqReason);
            _sqlparam[2] = new SqlParameter("@Country", Country);
            _sqlparam[3] = new SqlParameter("@UserId", strBpm_userID);
            resp = objSql.Insertrecord("USP_UWSARAL_SAVE_Country_V1", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWDecisionDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strApplicationNoStr, "Failed", "UWPortfolio", "Commfun.cs", "OnlinefollowupDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }
    //public void Save_Country(string strApplicationNoStr, string Country, string strBpm_userID, ref int resp)
    //{
    //    try
    //    {
    //        Logger.Info(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinefollowupDetails_Save");
    //        SqlParameter[] _sqlparam = new SqlParameter[3];
    //        //_sqlparam[0] = new SqlParameter("@Mode", Mode);
    //        _sqlparam[0] = new SqlParameter("@Appno", strApplicationNoStr);
    //        //_sqlparam[2] = new SqlParameter("@MedicalReason", ReqReason);
    //        _sqlparam[1] = new SqlParameter("@Country", Country);
    //        _sqlparam[2] = new SqlParameter("@UserId", strBpm_userID);
    //        resp = objSql.Insertrecord("USP_UWSARAL_SAVE_Country", _sqlparam);
    //        resp = objSql.Insertrecord("USP_UWSARAL_SAVE_Country_V1", _sqlparam);
    //    }
    //    catch (Exception Error)
    //    {
    //        Logger.Error(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWDecisionDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
    //        SaveErrorLogs(strApplicationNoStr, "Failed", "UWPortfolio", "Commfun.cs", "OnlinefollowupDetails_Save", "E-Error", "", "", Error.ToString());
    //    }
    //}
    public void GetCountry(string strApplicationNoStr, ref DataSet ds)
    {
        try
        {
            Logger.Info(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinefollowupDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            //_sqlparam[0] = new SqlParameter("@Mode", Mode);
            _sqlparam[0] = new SqlParameter("@Appno", strApplicationNoStr);
            //_sqlparam[2] = new SqlParameter("@MedicalReason", ReqReason);
            //_sqlparam[1] = new SqlParameter("@Country", Country);
            //_sqlparam[2] = new SqlParameter("@UserId", strBpm_userID);
            ds = objSql.RetrieveDataset("USP_Get_Country", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWDecisionDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strApplicationNoStr, "Failed", "UWPortfolio", "Commfun.cs", "OnlinefollowupDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }
    public void GetPendingClient(string AppNo, ref DataSet ds)
    {
        SqlParameter[] sqlparams = new SqlParameter[1];
        try
        {
            sqlparams[0] = new SqlParameter("@AppNo", AppNo);
            ds = objSql.RetrieveDataset("usp_DEDUPE_Get_PendingList", sqlparams);

        }
        catch (Exception ex)
        {
            throw ex;
        }
    }
    public void GetSelectedResult(string FirstName, string Lastname, string Gender, string DOB, string PinCode, ref int b, ref DataSet ds)
    {
        SqlParameter[] sqlparams = new SqlParameter[6];
        try
        {
            //sqlparams[0] = new SqlParameter("@AppNo", AppNo);
            sqlparams[0] = new SqlParameter("@firstname", FirstName);
            sqlparams[1] = new SqlParameter("@surname", Lastname);
            sqlparams[2] = new SqlParameter("@gender", Gender);
            sqlparams[3] = new SqlParameter("@dob", DOB);
            sqlparams[4] = new SqlParameter("@pincode", PinCode);
            sqlparams[5] = new SqlParameter("@b", b);
            // sqlparams[4] = new SqlParameter("@assuredType", assuredType);
            ds = objSql.RetrieveDataset("uspQA_clientSearch_V2", sqlparams);

        }
        catch (Exception ex)
        {
            throw ex;
        }
    }
    public void UpdateClient(long RefNo, string assuredType, int isNewClient, string AppNo, int CLIENTID, ref int Result)
    {
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[5];
            _sqlparam[0] = new SqlParameter("@RefNo", RefNo);
            _sqlparam[1] = new SqlParameter("@assuredType", assuredType);
            _sqlparam[2] = new SqlParameter("@isNewClient", isNewClient);
            _sqlparam[3] = new SqlParameter("@AppNo", AppNo);
            _sqlparam[4] = new SqlParameter("@CLIENTID", CLIENTID);
            Result = objSql.Insertrecord("usp_DEDUPE_UpdateClient", _sqlparam);
        }
        catch (Exception ex)
        {

            throw ex;
        }
    }
    /*ID:6 END*/
    /*ID:7 START*/
    public void ManagePolicyPrinting(string strPhApplicationNo, string strPhSource, bool blnPhStatus, string strPhUserName, string strPhBranchCode, string strPhCreatedBy, string strPhUserBranch, string strPhProcessName, string strPhApplicationName, string strMode, ref int intResp)
    {
        try
        {
            Logger.Info(strPhApplicationNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinefollowupDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[10];
            _sqlparam[0] = new SqlParameter("@PH_APPLICATION_NO", strPhApplicationNo);
            _sqlparam[1] = new SqlParameter("@PH_SOURCE", strPhSource);
            _sqlparam[2] = new SqlParameter("@PH_STATUS", blnPhStatus);
            _sqlparam[3] = new SqlParameter("@PH_USER_NAME", strPhUserName);
            _sqlparam[4] = new SqlParameter("@PH_BRANCH_CODE", strPhBranchCode);
            _sqlparam[5] = new SqlParameter("@PH_CREATED_BY", strPhCreatedBy);
            _sqlparam[6] = new SqlParameter("@PH_USER_BRANCH", strPhBranchCode);
            _sqlparam[7] = new SqlParameter("@PH_PROCESS_NAME", strPhProcessName);
            _sqlparam[8] = new SqlParameter("@PH_APPLICATION_NAME", strPhApplicationName);
            _sqlparam[9] = new SqlParameter("@MODE", strMode);
            intResp = objSql.Insertrecord("[policy_print].[DBO].[USP_DIS_MANAGE_PRINT_QC_HOLD]", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPhApplicationNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWDecisionDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPhApplicationNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlinefollowupDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:7 END*/
    /*ID:8 START*/
    public void BindQuestion_CloseFile(ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :BindQuestion_CloseFile");
            _ds = objSql.RetrieveDataset_woParam("USP_UWSARAL_GETQUESTIONS_CLOSEFILE");
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :BindQuestion_CloseFile Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "FetchReqRaised", "BAL.CS", "BindQuestion_CloseFile", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:8 END*/
    /*ID:9 START*/
    public void SaveAnswer_CloseFile(DataTable _dt,string Remark,int CaseCate, ref int resp)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :BindQuestion_CloseFile");
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@dt", _dt);
            _sqlparam[1] = new SqlParameter("@Remark", Remark);
            _sqlparam[2] = new SqlParameter("@CaseCate", CaseCate);
            resp = objSql.Insertrecord("USP_UWSARAL_SAVEANSWER_CLOSEFILE", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :SaveAnswer_CloseFile Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "FetchReqRaised", "BAL.CS", "SaveAnswer_CloseFile", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:9 END*/
    /*ID:10 START*/
    public void Save_MedicalReport_Reason(string strApplicationNoStr, int ReqReason, string strBpm_userID, ref int resp)
    {
        try
        {
            Logger.Info(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinefollowupDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@Appno", strApplicationNoStr);
            _sqlparam[1] = new SqlParameter("@MedicalReason", ReqReason);
            _sqlparam[2] = new SqlParameter("@UserId", strBpm_userID);
            resp = objSql.Insertrecord("USP_UWSARAL_SAVE_MEDICALREASON", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineUWDecisionDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strApplicationNoStr, "Failed", "UWPortfolio", "Commfun.cs", "OnlinefollowupDetails_Save", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:10 END*/
    /*ID:11 START*/
    public void Get_RequiremenSummary(ref DataSet _ds, string strPQuoteNo)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-L :PageName :Commfun.CS // MethodeName :Get_RequiremenSummary");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@APPNO", strPQuoteNo);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_GETREQUIREMENT_SUMMARY", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :Get_RequiremenSummary Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "Get_RequiremenSummary", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:11 END*/
    /*ID:12 START*/
    public void Get_Status(ref DataSet _ds, string strPQuoteNo)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-L :PageName :Commfun.CS // MethodeName :Get_Status");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@APPNO", strPQuoteNo);
            _ds = objSql.RetrieveDataset("USP_GET_CASE_STATUS", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :Get_Status Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "Get_Status", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:12 END*/
    /*ID:13 START*/
    public void GetStatusDiscription(ref DataSet _ds, string strAppNO)
    {
        try
        {
            Logger.Info(strAppNO + "STAG 3-L :PageName :Commfun.CS // MethodeName :OnlineCommentsDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@AppNo", strAppNO);
            _ds = objSql.RetrieveDataset("USP_UWSaral_StatusDescription", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strAppNO + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineCommentsDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strAppNO, "Failed", "UWPortfolio", "Commfun.cs", "OnlineCommentsDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:13 End*/
    public void FetchBranchState(ref DataSet _ds, string strApplnNo)
    {
        Logger.Info(strApplnNo + "STAG 3-A :PageName :Commfun.CS // MethodeName :DeleteExistingLoading");
        SqlParameter[] _sqlparam = new SqlParameter[1];
        _sqlparam[0] = new SqlParameter("@AppNo", strApplnNo);
        //_ds = objSql.RetrieveDataset("USP_UWSARAL_GETBRANCHSTATE", _sqlparam);
        _ds = objSql.RetrieveDataset("USP_UWSARAL_GETBRANCHSTATE_V2", _sqlparam);//added by suraj on 11/12/2019 for adding query for chk termproduct,BFL case and Amex case for CIBIL score textbox
    }
    
    /*START ID:14*/
    public void CheckRider(ref DataSet _ds, string strAppNo)
    {
        try
        {
            Logger.Info(strAppNo + "STAG 3-G :PageName :Commfun.CS // MethodeName :CheckRider");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@AppNo", strAppNo);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_CheckRider", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strAppNo + "STAG 2 :PageName :Commfun.CS // MethodeName :CheckRider Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strAppNo, "Failed", "UWPortfolio", "Commfun.cs", "CheckRider", "E-Error", "", "", Error.ToString());
        }
    }
    /*END ID:14*/

    public void DeleteExistingLoading(string strAppno,string strRiderId,string strLoadingType, ref int response)
    {
        Logger.Info(strAppno  + "STAG 3-A :PageName :Commfun.CS // MethodeName :DeleteExistingLoading");
        SqlParameter[] _sqlparam = new SqlParameter[3];
        _sqlparam[0] = new SqlParameter("@PQuoteNo", strAppno);
        _sqlparam[1] = new SqlParameter("@LDRider", strRiderId);
        _sqlparam[2] = new SqlParameter("@LDLoadingType", strLoadingType);
        response = objSql.Insertrecord("USP_BPM_ExestingLoadingDelete_V2", _sqlparam);
    }
    public void GetStatusReport(string frmDate, string ToDate, string status, ref DataSet _ds)
    {
        SqlParameter[] sqlparams = new SqlParameter[3];
        try
        {
            //sqlparams[0] = new SqlParameter("@AppNo", AppNo);
            sqlparams[0] = new SqlParameter("@FromDate", frmDate);
            sqlparams[1] = new SqlParameter("@ToDate", ToDate);
            sqlparams[2] = new SqlParameter("@Status", status);
            _ds = objSql.RetrieveDataset("USP_UWSaral_StatusReport", sqlparams);

        }
        catch (Exception ex)
        {
            throw ex;
        }
    }
    public void CheckCloseFileReview(string strUserKey,string strApplicationNo, ref DataSet _ds)
    {
        Logger.Info(":PageName :UWSaralServices/CommFun.CS // MethodeName :CheckCloseFileReview");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@struserid", strUserKey);
            _sqlparam[1] = new SqlParameter("@ApplicationNo", strApplicationNo);
            _ds = objSql.RetrieveDataset("USP_CHECK_CLOSEFILEREVIEW", _sqlparam);  
        }
        catch (Exception Error)
        {
            Logger.Error(":PageName :UWSaralServices/CommFun.CS // MethodeName :CheckCloseFileReview");
            SaveErrorLogs(string.Empty, "Failed", "UWSaralDecision", "Commfun.cs", "CheckCloseFileReview", "E-Error", "", "", Error.ToString());
        }
    }
    public void GetUser(ref DataSet _ds)
    {
        Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :GetUser");
        
        //_sqlparam[0] = new SqlParameter("@channel", strChannel);
        _ds = objSql.RetrieveDataset_woParam("USP_GETUWUSERS");
    }
    public void UserActiveDeactive(string struser, int action, ref int response)
    {
        Logger.Info(struser + "STAG 3-A :PageName :Commfun.CS // MethodeName :UserActiveDeactive");
        SqlParameter[] _sqlparam = new SqlParameter[2];
        _sqlparam[0] = new SqlParameter("@Users", struser);
        _sqlparam[1] = new SqlParameter("@Action", action);
        response = objSql.Insertrecord("USP_ACTIVEDEACTIVEUSERS", _sqlparam);
    }
    /*START ID:15*/
    public void IsClientExist(ref DataSet _ds, string strApplnNo)
    {
        Logger.Info(strApplnNo + "STAG 3-A :PageName :Commfun.CS // MethodeName :DeleteExistingLoading");
        SqlParameter[] _sqlparam = new SqlParameter[1];
        _sqlparam[0] = new SqlParameter("@AppNo", strApplnNo);
        _ds = objSql.RetrieveDataset("USP_UWSARAL_IsClientExist_V1", _sqlparam);
    }
    public void PreviousCaseStatus(ref DataSet _ds, string strApplnNo)
    {
        Logger.Info(strApplnNo + "STAG 3-A :PageName :Commfun.CS // MethodeName :DeleteExistingLoading");
        SqlParameter[] _sqlparam = new SqlParameter[1];
        _sqlparam[0] = new SqlParameter("@AppNo", strApplnNo);
        _ds = objSql.RetrieveDataset("USP_UWSARAL_PreviousPlolicyStatus", _sqlparam);
    }
    /*END ID:15*/
    /*ID:16 START*/
    public void Get_MedicalStatus(ref DataSet _ds, string strPQuoteNo)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-L :PageName :Commfun.CS // MethodeName :Get_MedicalStatus");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@AppNo", strPQuoteNo);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_GetMedicalStatus", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :Get_MedicalStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "Get_MedicalStatus", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:16 END*/
    /*ID:17 START*/
    public void GET_MedicalReportoShow(ref DataSet _ds, string strAppNo)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :GET_MedicalReportoShow");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@AppNo", strAppNo);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_GetMedicalReport", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :GET_MedicalReportoShow Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "GET_MedicalReportoShow", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:17 END*/
    public void GetReqDetails(ref DataSet _ds, string strFLP_CODE_DESC)
    {
        try
        {
            Logger.Info("STAG 3-J :PageName :Commfun.CS // MethodeName :GetReqDetails");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@FLP_CODE_DESC", strFLP_CODE_DESC);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_FIND_REQ", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :GetReqDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "GetReqDetails", "E-Error", "", "", Error.ToString());
        }
    }
    /*START ID:18*/
    public void CalculateBMI(ref DataSet _dsbmiData, string strAppNo, string strAppType, string strHeight, string strWeight)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :CalculateBMI");
            _dsAppdtls = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strAppNo);
            _sqlparam[1] = new SqlParameter("@CHANNEL", strAppType);
            _sqlparam[2] = new SqlParameter("@HEIGHT", strHeight);
            _sqlparam[3] = new SqlParameter("@WEIGHT", strWeight);
            /*ID:5 START*/
            _dsbmiData = objSql.RetrieveDataset("USP_UWSARAL_CAL_BMI", _sqlparam);
            /*ID:5 END*/
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :CalculateBMI Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "CalculateBMI", "E-Error", "", "", Error.ToString());
        }
    }
    /*END ID:18*/
    public void ChkHighCatCasesForWarning(string strApplicationNumber, string struserid, ref DataSet Result)
    {
        try
        {
            Logger.Info(strApplicationNumber + "STAG 3-A :PageName :Commfun.CS // MethodeName :ChkHighCatCasesForWarning");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@ApplicationNumber", strApplicationNumber);
            _sqlparam[1] = new SqlParameter("@UserId", struserid);
            Result = objSql.RetrieveDataset("USP_UWSARAL_WARNING_FETCH", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNumber + " STAG 4-A :PageName :Commfun.CS // MethodeName :ChkHighCatCasesForWarning Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strApplicationNumber, "Failed", "UWPortfolio", "Commfun.cs", "ChkHighCatCasesForWarning", "E-Error", "", "", Error.ToString());
        }

    }
    //Added by Suraj on 13/11/2018 for CMO foloupcode resolve
    public void UWCMOFoloupcdRS(string strapplicationno, ref int UWCommentResult)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :UWCMOFoloupcdRS");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", strapplicationno);
            //_sqlparam[1] = new SqlParameter("@FolloupCode", strapplicationno);
            
            UWCommentResult = objSql.Insertrecord("USP_UWCMOFOLLOUPCODERESOLVE", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :UWCMOFoloupcdRS Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strapplicationno, "Failed", "UWPortfolio", "Commfun.cs", "UWCMOFoloupcdRS", "E-Error", "", "", Error.ToString());
        }
    }
    //Added by Suraj on 05/12/2018 for validation of not aproving case- nominee not present if the pauer and LA is same
    public void ChkNomineePresence(string strApplicationNumber, ref DataSet Result)
    {
        try
        {
            Logger.Info(strApplicationNumber + "STAG 3-A :PageName :Commfun.CS // MethodeName :ChkHighCatCasesForWarning");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ApplicationNumber", strApplicationNumber);
            //_sqlparam[1] = new SqlParameter("@UserId", struserid);
            Result = objSql.RetrieveDataset("USP_CHECK_NOMINEE", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNumber + " STAG 4-A :PageName :Commfun.CS // MethodeName :ChkHighCatCasesForWarning Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strApplicationNumber, "Failed", "UWPortfolio", "Commfun.cs", "ChkHighCatCasesForWarning", "E-Error", "", "", Error.ToString());
        }

    }
    /*ID:9 START*/
    public void Save_TsarMsar(DataTable _dt,string strAppno, ref int resp)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :BindQuestion_CloseFile");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@dt", _dt);
            _sqlparam[1] = new SqlParameter("@ApplicationNo ", strAppno);
           // _sqlparam[2] = new SqlParameter("@CaseCate", CaseCate);
            //resp = objSql.Insertrecord("USP_UWSARAL_SAVE_TSARMSAR", _sqlparam);
            resp = objSql.Insertrecord("USP_UWSARAL_SAVE_TSARMSAR_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :SaveAnswer_CloseFile Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "FetchReqRaised", "BAL.CS", "SaveAnswer_CloseFile", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:9 END*/
    /*ID:19 START*/
    public void GetLookupData(int intType, ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchUWMedicalManagementDashboard");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@srno", intType);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_FETCH_LOOKUP_CHILD_DETAILS ", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(" STAG 4-A :PageName :Commfun.CS // MethodeName :FetchUWMedicalManagementDashboard Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(string.Empty, "Failed", "UWPortfolio", "Commfun.cs", "FetchUWMedicalManagementDashboard", "E-Error", "", "", Error.ToString());
        }
    }

    public void FetchDashboardUWMedicalManagementDetails(string strApplicationNo, string strPolicyNo, DateTime dtStartDate, DateTime dtEndDate, string strCategory, bool isOnine, ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails");
            SqlParameter[] _sqlparam = new SqlParameter[6];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@PolicyNo", strPolicyNo);
            _sqlparam[2] = new SqlParameter("@StartDate", dtStartDate);
            _sqlparam[3] = new SqlParameter("@EndDate", dtEndDate);
            _sqlparam[4] = new SqlParameter("@Category", strCategory);
            _sqlparam[5] = new SqlParameter("@IsOnline", isOnine);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_FETCH_DASHBOARD_UWMEDICAL_MANAGEMENT_DETAILS ", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(" STAG 4-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(string.Empty, "Failed", "UWPortfolio", "Commfun.cs", "FetchDashboardUWMedicalManagementDetails", "E-Error", "", "", Error.ToString());
        }
    }

    public void FetchDashboardUWMedicalManagementTPADetails(string strTpaRefNo, ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@TPARefNo", strTpaRefNo);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_FETCH_DASHBOARD_UWMEDICAL_MANAGEMENT_TPA_DETAILS", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(" STAG 4-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(string.Empty, "Failed", "UWPortfolio", "Commfun.cs", "FetchDashboardUWMedicalManagementDetails", "E-Error", "", "", Error.ToString());
        }
    }
    public void FetchDashboardUWMedicalManagementPartners(ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails");
            SqlParameter[] _sqlparam = new SqlParameter[0];
            _ds = objSql.RetrieveDataset("USP_UWSARAL_FETCH_DASHBOARD_UWMEDICAL_MANAGEMENT_PARTNER", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(" STAG 4-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(string.Empty, "Failed", "UWPortfolio", "Commfun.cs", "FetchDashboardUWMedicalManagementDetails", "E-Error", "", "", Error.ToString());
        }
    }

    public void FetchlastRunScheduarStatus(ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails");
            SqlParameter[] _sqlparam = new SqlParameter[0];
            _ds = objSql.RetrieveDataset("USP_UWSARAL_TPA_FETCH_SCHEDULAR_LOGS", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(" STAG 4-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(string.Empty, "Failed", "UWPortfolio", "Commfun.cs", "FetchDashboardUWMedicalManagementDetails", "E-Error", "", "", Error.ToString());
        }
    }

    /*ID:19 END*/
    /*ID:20 END*/
    public void ManageApplicationPriority(DataTable _dt, ref int intRet)
    {
        try
        {
            Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@TYP_UWSARAL_T_UWSARAL_UTILITY_PRIORITY", _dt);
            intRet = objSql.Insertrecord("USP_UWSARAL_UTILITY_MANAGE_PRIORITY", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(" STAG 4-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(string.Empty, "Failed", "UWPortfolio", "Commfun.cs", "FetchDashboardUWMedicalManagementDetails", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:20 END*/
    /*ID:21 START */
    public void GetMandatoryRider(ref DataSet _ds, string strprodcode)
    {
        try
        {
            Logger.Info(strprodcode + "STAG 2 :PageName :Commfun.CS // MethodeName :GetMandatoryRider");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ProdCode", strprodcode);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_GetMandatoryRider", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strprodcode + "STAG 2 :PageName :Commfun.CS // MethodeName :GetMandatoryRider Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strprodcode, "Failed", "UWPortfolio", "Commfun.cs", "GetMandatoryRider", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:21 END */
    /*ID:22 START*/
    public void GET_REVIEVDCASEC_CLOSEFILEREVIEW(string strApplicationNo, ref DataSet _ds)
    {
        Logger.Info(":PageName :UWSaralServices/CommFun.CS // MethodeName :GET_REVIEVDCASEC_CLOSEFILEREVIEW");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strApplicationNo);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_GET_REVIEVED_CLOSEFILE", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(":PageName :UWSaralServices/CommFun.CS // MethodeName :GET_REVIEVDCASEC_CLOSEFILEREVIEW");
            SaveErrorLogs(string.Empty, "Failed", "UWSaralDecision", "Commfun.cs", "GET_REVIEVDCASEC_CLOSEFILEREVIEW", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:22 END*/
    /*ID:22 START*/
    public void GET_CORRECTANS(ref DataSet _ds ,string ANSValue,int Q_ID)
    {
        Logger.Info(":PageName :UWSaralServices/CommFun.CS // MethodeName :GET_CORRECTANS");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@CORRECTANS", ANSValue);
            _sqlparam[1] = new SqlParameter("@Q_ID", Q_ID);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_GET_CORRECTANS", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(":PageName :UWSaralServices/CommFun.CS // MethodeName :GET_CORRECTANS");
            SaveErrorLogs(string.Empty, "Failed", "UWSaralDecision", "Commfun.cs", "GET_CORRECTANS", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:22 END*/
    /*ID:23 START*/
    public void FetchFetchSaralFinancialCalculatorApplication(string strApplicationNo, ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", strApplicationNo);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_FINANCIAL_CALCULATOR", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(" STAG 4-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(string.Empty, "Failed", "UWPortfolio", "Commfun.cs", "FetchDashboardUWMedicalManagementDetails", "E-Error", "", "", Error.ToString());
        }
    }

    public int ManageFetchSaralFinancialCalculator(string strApplicationNo, string strITR, string strFinancailYear, decimal dcIncome, DateTime dtDateOfBirth, string strExistingInsuranceCover, string strUserId)
    {
        try
        {
            Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails");
            SqlParameter[] _sqlparam = new SqlParameter[7];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@ITR", strITR);
            _sqlparam[2] = new SqlParameter("@FinancialYear", strFinancailYear);
            _sqlparam[3] = new SqlParameter("@Income", dcIncome);
            _sqlparam[4] = new SqlParameter("@DateOfBirth", dtDateOfBirth);
            _sqlparam[5] = new SqlParameter("@ExistingInsuranceCover", strExistingInsuranceCover);
            _sqlparam[6] = new SqlParameter("@UserId", strUserId);
            return objSql.Insertrecord("USP_UWSARAL_FINANCIAL_CALCULATOR_MANAGE", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(" STAG 4-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(string.Empty, "Failed", "UWPortfolio", "Commfun.cs", "FetchDashboardUWMedicalManagementDetails", "E-Error", "", "", Error.ToString());
        }
        return -1;
    }
    public void FetchSaralFinancialCalculatorComputedData(string strApplicationNo, string strUserId, ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@UserId", strUserId);
            _ds = objSql.RetrieveDataset("USP_FETCH_UWSARAL_FINANICAL_CALCULATOR_COMPUTED_DATA", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(" STAG 4-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(string.Empty, "Failed", "UWPortfolio", "Commfun.cs", "FetchDashboardUWMedicalManagementDetails", "E-Error", "", "", Error.ToString());
        }
    }

    public void FetchFinancialCalculatorLiquid(string strApplicationNo, ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", strApplicationNo);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_FINANCIAL_CALCULATOR_FETCH_LIQUID_INVESTMENT", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(" STAG 4-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(string.Empty, "Failed", "UWPortfolio", "Commfun.cs", "FetchDashboardUWMedicalManagementDetails", "E-Error", "", "", Error.ToString());
        }
    }

    public void ManageFinancialCalculatorLiquidInvestment(string strApplicationNo, string strInvestmentType, string strInvestmentAmount, string strUserId)
    {
        try
        {
            Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails");
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@InvestmentType", strInvestmentType);
            _sqlparam[2] = new SqlParameter("@InvestmentAmount", strInvestmentAmount);
            _sqlparam[3] = new SqlParameter("@UserId", strUserId);
            objSql.Insertrecord("USP_UWSARAL_FINANCIAL_CALCULATOR_MANAGE_LIQUID_INVESTMENT", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(" STAG 4-A :PageName :Commfun.CS // MethodeName :FetchDashboardUWMedicalManagementDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(string.Empty, "Failed", "UWPortfolio", "Commfun.cs", "FetchDashboardUWMedicalManagementDetails", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:23 END*/
    /*ID:24 START*/
    public void GetAutoIssuence(ref DataSet _ds)
    {
        try
        {
            _ds = objSql.RetrieveDataset_woParam("USP_GetAutoIssuenceCases_tmp");
        }
        catch (Exception ex)
        {
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.cs", "GetAutoIssuence", "E-Error", "", "", ex.ToString());
        }
    }
    /*ID:24 END*/
    public void MangeAFITypeRCDUnderWriter(string StrPolicyNo, string strAFIType, string strRCD, string strAssignTo, string strUserId, ref int intRef)
    {
        try
        {
            Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :MangeAFITypeRCDUnderWriter");
            SqlParameter[] _sqlparam = new SqlParameter[5];
            _sqlparam[0] = new SqlParameter("@PolicyNo", StrPolicyNo);
            _sqlparam[1] = new SqlParameter("@AFIType", strAFIType);
            _sqlparam[2] = new SqlParameter("@RCD", strRCD);
            _sqlparam[3] = new SqlParameter("@AssignTo", strAssignTo);
            _sqlparam[4] = new SqlParameter("@UserId", strUserId);
            intRef = objSql.Insertrecord("USP_UWSARAL_MangeAFITypeRCDUnderWriter", _sqlparam);
        }
        catch (Exception ex)
        {
            SaveErrorLogs("", "Failed", "MangeAFITypeRCDUnderWriter", "BAL.cs", "MangeAFITypeRCDUnderWriter", "E-Error", "", "", ex.ToString());
        }
    }

    /*ID:25 START*/
    public void GetApplication_Warmning(string strAppno,ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :BindQuestion_CloseFile");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@Appno", strAppno);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_GET_APLICATION_WARNINGMESSAGE", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :BindQuestion_CloseFile Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "FetchReqRaised", "BAL.CS", "BindQuestion_CloseFile", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:25 END*/
    /*ID:26 START*/
    public void Get_MedicalStatus_Dataentry(ref DataSet _ds, string strPQuoteNo)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-L :PageName :Commfun.CS // MethodeName :Get_MedicalStatus");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@AppNo", strPQuoteNo);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_Get_MedicalStatus_Dataentry", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :Get_MedicalStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "Get_MedicalStatus", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:26 END*/
    /*ID:27 START*/
    public void Save_MedicalComments(string strAppNo,string strComment,string strMedicalReason,string strException,string strUserid, ref int intRef)
    {
        try
        {
            Logger.Info(strAppNo + "STAG 3-L :PageName :Commfun.CS // MethodeName :Save_MedicalComments");
            SqlParameter[] _objSqlParam = new SqlParameter[5];

            _objSqlParam[0] = new SqlParameter("@AppNo", strAppNo);
            _objSqlParam[1] = new SqlParameter("@Comments", strComment);
            _objSqlParam[2] = new SqlParameter("@MedicalReason", strMedicalReason);
            _objSqlParam[3] = new SqlParameter("@Exception", strException);
            _objSqlParam[4] = new SqlParameter("@UserId", strUserid);
            //_objSqlParam[3] = new SqlParameter("@UserName", Session["UserName"]);

            //intRef= objSql.Insertrecord("USP_UWSARAL_Save_MedicalValuesComments", _objSqlParam);
            intRef = objSql.Insertrecord("USP_UWSARAL_Save_MedicalValuesComments_V1", _objSqlParam);
        }
        catch (Exception Error)
        {
            Logger.Error(strAppNo + "STAG 2 :PageName :Commfun.CS // MethodeName :Save_MedicalComments Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strAppNo, "Failed", "UWPortfolio", "Commfun.cs", "Save_MedicalComments", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:27 END*/
    /*ID:28 START*/
    public void Get_VisibleMedicalTab(string strMedicalCode, ref DataSet _ds)
    {
        try
        {
            Logger.Info(strMedicalCode + "STAG 3-L :PageName :Commfun.CS // MethodeName :Get_VisibleMedicalTab");
            SqlParameter[] _objSqlParam = new SqlParameter[1];

            _objSqlParam[0] = new SqlParameter("@MedicalCode", strMedicalCode);
           
            _ds = objSql.RetrieveDataset("USP_UWSARAL_Get_MedicalTab", _objSqlParam);
        }
        catch (Exception Error)
        {
            Logger.Error(strMedicalCode + "STAG 2 :PageName :Commfun.CS // MethodeName :Get_VisibleMedicalTab Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strMedicalCode, "Failed", "UWPortfolio", "Commfun.cs", "Get_VisibleMedicalTab", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:28 END*/
    /*ID:29 START*/
    public void GetMedicaReasonDD( ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 3-L :PageName :Commfun.CS // MethodeName :GetMedicaReasonDD");
            //SqlParameter[] _objSqlParam = new SqlParameter[1];

            //_objSqlParam[0] = new SqlParameter("@MedicalCode", strMedicalCode);

            _ds = objSql.RetrieveDataset_woParam("USP_UWSARAL_Get_MedicalReason");
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :GetMedicaReasonDD Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("","Failed", "UWPortfolio", "Commfun.cs", "GetMedicaReasonDD", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID:29 END*/
    //changes for Health PRoduct BackDating by Pragati
    //Get Heath Product
    public void GetHealthProduct(ref DataSet _ds, string strApplicationno, string Flag)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineSubMasterDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@POL_applicationNoStr", strApplicationno);
            _sqlparam[1] = new SqlParameter("@Flag", Flag);
            //_sqlparam[1] = new SqlParameter("@ddlType", ddlType);
            //_sqlparam[2] = new SqlParameter("@ddlsubtype", ddlsubtype);
            // _ds = objSql.RetrieveDataset("USP_BPM_SubMasterDetailsFetch_V2", _sqlparam);
            _ds = objSql.RetrieveDataset("USP_UWSaral_BackDating", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineSubMasterDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineFollowupMasterDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    //Health Product

    //pragati changes START
    public void OnlineMasterDisplayDetails_GET1(ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 2 A1 :PageName :Commfun.CS // MethodeName :OnlineMasterDisplayDetails_GET");
            //_ds = objSql.RetrieveDataset_woParam("USP_BPM_MasterDetailsFetch_V2_Saral_26643");
            _ds = objSql.RetrieveDataset_woParam("USP_BPM_MasterDetailsFetch_V2_HealthDetails");
            if (_ds.Tables.Count > 0)
            {
                _ds.Tables[0].TableName = "ddlfollowupcode";
                _ds.Tables[1].TableName = "ddlCategory";
                _ds.Tables[2].TableName = "ddlCriteria";
                _ds.Tables[3].TableName = "ddlStatus";
                _ds.Tables[4].TableName = "ddlLoadType";
                _ds.Tables[5].TableName = "ddlUWDecesion";
                _ds.Tables[6].TableName = "ddlUWreason";
                _ds.Tables[7].TableName = "ddlLoadFlatMortality";
                _ds.Tables[8].TableName = "ddlBkdateReason";
                _ds.Tables[9].TableName = "ddlIfscCode";
                _ds.Tables[10].TableName = "ddlLoadRsn1";
                _ds.Tables[11].TableName = "ddlLoadRsn2";
                _ds.Tables[12].TableName = "ddlLoadTypeVal";
                _ds.Tables[13].TableName = "ddlAutoPaytype";
                /*ID:6 STRART*/
                if (_ds.Tables.Count > 14)
                {
                    _ds.Tables[14].TableName = "cblDecisionType";
                }
                if (_ds.Tables.Count > 15)
                {
                    _ds.Tables[15].TableName = "ddlProposalType";
                }
                if (_ds.Tables.Count > 16)
                {
                    _ds.Tables[16].TableName = "ddlProposalType2";
                }
                if (_ds.Tables.Count > 17)
                {
                    _ds.Tables[17].TableName = "ddlProposalType3";
                }
                /*ID:6 END*/
                if (_ds.Tables.Count > 18)
                {
                    _ds.Tables[18].TableName = "ddlRequirementMedicalReason";
                }
                if (_ds.Tables.Count > 19)
                {
                    _ds.Tables[19].TableName = "ddlAnswer";
                }
                //Added by Suraj on 25 APRIL 2018 for Assign type dropdown
                if (_ds.Tables.Count > 20)
                {
                    _ds.Tables[20].TableName = "ddlAssigmentType";
                }
                //Added by Suraj on 5 JULY 2018 for Country list
                if (_ds.Tables.Count > 21)
                {
                    _ds.Tables[21].TableName = "ddlcountry";
                }
                //Added by Suraj on 25 JULY 2019 for signature match
                if (_ds.Tables.Count > 22)
                {
                    _ds.Tables[22].TableName = "ddlSignature";
                }
                //Added by Suraj on 01 JULY 2020 for catagory only for product code E83,84
                if (_ds.Tables.Count > 23)
                {
                    _ds.Tables[23].TableName = "ddlNAWPCatagory";
                }
                //end
                // 48.1 Begin of Changes; Jayendra  - [Webashlar01]
                _ds.Tables[24].TableName = "ddlfollowupcode_STP";
                _ds.Tables[25].TableName = "ddlCategory_STP";
                _ds.Tables[26].TableName = "ddlCriteria_STP";
                _ds.Tables[27].TableName = "ddlStatus_STP";
                // 48.1 End of Changes; Jayendra  - [Webashlar01]
            }
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineMasterDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineMasterDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    //END
    public void Save_AUBankRelation(string strBankRelation, string strLoanType, string strLoanAmt, string strCustCatag, string strAcctDate, string strAppno, string strUserId, ref int resp)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :Save_AUBankRelation");
            SqlParameter[] _sqlparam = new SqlParameter[7];
            _sqlparam[0] = new SqlParameter("@BankRelation", strBankRelation);
            _sqlparam[1] = new SqlParameter("@LoanType", strLoanType);
            _sqlparam[2] = new SqlParameter("@LoanAmt", strLoanAmt);
            _sqlparam[3] = new SqlParameter("@CustCatag", strCustCatag);
            _sqlparam[4] = new SqlParameter("@AcctDate", strAcctDate);
            _sqlparam[5] = new SqlParameter("@ApplicationNo", strAppno);
            _sqlparam[5] = new SqlParameter("@UserId", strUserId);
            // _sqlparam[2] = new SqlParameter("@CaseCate", CaseCate);
            //resp = objSql.Insertrecord("USP_UWSARAL_SAVE_TSARMSAR", _sqlparam);
            resp = objSql.Insertrecord("USP_UWSARAL_SAVE_AUBANKRELATION", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :Save_AUBankRelation Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "FetchReqRaised", "BAL.CS", "Save_AUBankRelation", "E-Error", "", "", Error.ToString());
        }
    }
    public void GetAUBankCases(string strAgentCode, ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :GetAUBankCases");
            SqlParameter[] _objSqlParam = new SqlParameter[1];
            _objSqlParam[0] = new SqlParameter("@AgentCode", strAgentCode);

            _ds = objSql.RetrieveDataset("USP_USARAL_GETAUCASES", _objSqlParam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :GetAUBankCases Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "FetchReqRaised", "BAL.CS", "GetAUBankCases", "E-Error", "", "", Error.ToString());
        }
    }
    #region added by Kavita on 06 NOV 19 for CFRAllocationUpload
    /*added by Kavita on 06 NOV 19 for CFRAllocationUpload*/
    public void InsertCFRAllocationUpload(DataTable dt, string AppNo, string IsReviewed, string AssignBy, DateTime createdDate)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.cs // MethodeName :InsertCFRAllocationUpload");
            SqlParameter[] _sqlparam = new SqlParameter[5];
            _sqlparam[0] = new SqlParameter("@dt", dt);
            _sqlparam[1] = new SqlParameter("@AppNo", AppNo);
            _sqlparam[2] = new SqlParameter("@IsReviewed", IsReviewed);
            _sqlparam[3] = new SqlParameter("@AssignBy", AssignBy);
            _sqlparam[4] = new SqlParameter("@createdDate", createdDate);

            objSql.Insertrecord("UspCFRAllocationUpload", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.cs // MethodeName :InsertCFRAllocationUpload Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "Commfun.cs", "UpdateAppStatus", "E-Error", "", "", Error.ToString());
        }
    }

    public void InsertCFRAllocationUpload_ErrorLog(string excelPath, string UserId, string strerror)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.cs // MethodeName :InsertCFRAllocationUpload");
            SqlParameter[] _sqlparam = new SqlParameter[5];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", excelPath);
            _sqlparam[1] = new SqlParameter("@UserID", UserId);
            _sqlparam[2] = new SqlParameter("@SystemDate", DateTime.Now);
            _sqlparam[3] = new SqlParameter("@ErrorMsg", strerror);

            objSql.Insertrecord("UspCFRAllocationUpload_Errorlog", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.cs // MethodeName :InsertCFRAllocationUpload_ErrorLog Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "Commfun.cs", "UpdateAppStatus", "E-Error", "", "", Error.ToString());
        }
    }

    //END
    #endregion
    /*added by Kavita on 01 JAN 2020 for MedicalValue*/
    public void FetchMedicalValuesFor_UWComment(ref DataSet _ds, string AppNo)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.cs // MethodeName :FetchMedicalValuesFor_UWComment");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@AppNo", AppNo);
            _ds = objSql.RetrieveDataset("UW_Comment_FetchMedicalValue", _sqlparam);

        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.cs // MethodeName :FetchMedicalValuesFor_UWComment Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "FetchMedicalValuesFor_UWComment", "E-Error", "", "", Error.ToString());
        }
    }
    /*added by Suraj on 13 FEB 2020 for save PEP case*/
    public void Save_PEPCase(string strApplicationNoStr, string strPEP, string strBpm_userID, ref int resp)
    {
        try
        {
            Logger.Info(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinefollowupDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[3];
            //_sqlparam[0] = new SqlParameter("@Mode", Mode);
            _sqlparam[0] = new SqlParameter("@Appno", strApplicationNoStr);
            //_sqlparam[2] = new SqlParameter("@MedicalReason", ReqReason);
            _sqlparam[1] = new SqlParameter("@PEPCase", strPEP);
            _sqlparam[2] = new SqlParameter("@UserId", strBpm_userID);
            resp = objSql.Insertrecord("USP_UWSARAL_SAVE_PEP", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :Save_PEPCase Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strApplicationNoStr, "Failed", "UWPortfolio", "Commfun.cs", "Save_PEPCase", "E-Error", "", "", Error.ToString());
        }
    }
    /*added by Suraj on 13 FEB 2020 for save PEP Aproved case*/
    public void Save_PEPApprovedCase(string strApplicationNoStr, bool strPEP, string strBpm_userID, ref int resp)
    {
        try
        {
            Logger.Info(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlinefollowupDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[3];
            //_sqlparam[0] = new SqlParameter("@Mode", Mode);
            _sqlparam[0] = new SqlParameter("@Appno", strApplicationNoStr);
            //_sqlparam[2] = new SqlParameter("@MedicalReason", ReqReason);
            _sqlparam[1] = new SqlParameter("@PEPCase", strPEP);
            _sqlparam[2] = new SqlParameter("@UserId", strBpm_userID);
            resp = objSql.Insertrecord("USP_UWSARAL_SAVE_PEP_Approved", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :Save_PEPCase Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strApplicationNoStr, "Failed", "UWPortfolio", "Commfun.cs", "Save_PEPCase", "E-Error", "", "", Error.ToString());
        }
    }

    /*added by Kavita on 26 FEB 2020 for CR-26885  */
    bool flag2;
    public bool InsertInvestigationReport(string policyNo, string AppNo, DateTime dtProLoginDate, string CustORSubName, string PreAmnt, string BranchName, string ChannelName, string PolicyStatus, string PIVCRemarks, string AdvisorCode, string AdvisorName, string ReportingManagerECode,
                string ReportingManagerName, string Product, string AgentStatus, DateTime PolicyIssueDate, DateTime ReferredDate, string CategoryofMisconduct, string Casereferredby, string PrimaryAllegations, string ACRSignedby, string MHRSigned, string F2FSigned, string CLSSRNNo, string EnquiryCmnt, string TypeOfDisposal, string UserId, string ddlPIInvestigationStatus)
    {

        try
        {

            Logger.Info("STAG 2 :PageName :Commfun.cs // MethodeName :InsertInvestigationReport");
            SqlParameter[] _sqlparam = new SqlParameter[28];
            _sqlparam[0] = new SqlParameter("@PolicyNo", policyNo);
            _sqlparam[1] = new SqlParameter("@ApplicationNumber", AppNo);
            _sqlparam[2] = new SqlParameter("@ProposalLoginDate", dtProLoginDate);
            _sqlparam[3] = new SqlParameter("@CustomerORSubjectName", CustORSubName);
            _sqlparam[4] = new SqlParameter("@PremiumAmount", PreAmnt);
            _sqlparam[5] = new SqlParameter("@BranchName", BranchName);
            _sqlparam[6] = new SqlParameter("@ChannelName", ChannelName);
            _sqlparam[7] = new SqlParameter("@PolicyStatus", PolicyStatus);
            _sqlparam[8] = new SqlParameter("@PIVCRemarks", PIVCRemarks);
            _sqlparam[9] = new SqlParameter("@AdvisorCode", AdvisorCode);
            _sqlparam[10] = new SqlParameter("@AdvisorName", AdvisorName);
            _sqlparam[11] = new SqlParameter("@ReportingManagerECode", ReportingManagerECode);
            _sqlparam[12] = new SqlParameter("@ReportingManagerName", ReportingManagerName);
            _sqlparam[13] = new SqlParameter("@Product", Product);
            _sqlparam[14] = new SqlParameter("@AgentStatus", AgentStatus);
            _sqlparam[15] = new SqlParameter("@PolicyIssueDate", PolicyIssueDate);
            _sqlparam[16] = new SqlParameter("@ReferredDate", ReferredDate);
            _sqlparam[17] = new SqlParameter("@CategoryofMisconduct", CategoryofMisconduct);
            _sqlparam[18] = new SqlParameter("@Casereferredby", Casereferredby);
            _sqlparam[19] = new SqlParameter("@PrimaryAllegations", PrimaryAllegations);
            _sqlparam[20] = new SqlParameter("@ACRSignedby", ACRSignedby);
            _sqlparam[21] = new SqlParameter("@MHRSigned", MHRSigned);
            _sqlparam[22] = new SqlParameter("@F2FSigned", F2FSigned);
            _sqlparam[23] = new SqlParameter("@CLSSRNNo", CLSSRNNo);
            _sqlparam[24] = new SqlParameter("@EnquiryCmnt", EnquiryCmnt);
            _sqlparam[25] = new SqlParameter("@TypeOfDisposal", TypeOfDisposal);
            _sqlparam[26] = new SqlParameter("@CreatedBy", UserId);
            _sqlparam[27] = new SqlParameter("@PIInvestigationStatus_ddl", ddlPIInvestigationStatus);
            objSql.Insertrecord("Usp_UWSaralInsPIInvestigation", _sqlparam);
            flag2 = true;
        }
        catch (Exception Error)
        {
            flag2 = false;
            Logger.Error("STAG 2 :PageName :Commfun.cs // MethodeName :InsertInvestigationReport Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "InsertInvestigationReport_ErrorLog", "E-Error", "", "", Error.ToString());
        }
        return flag2;
    }


    /*added by Kavita on 26/02/2020 for GetAgentDetails*/
    public void GetAgentDetails(ref DataSet _ds, string AgentCode)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :GetAgentDetails");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@AgentId", AgentCode);
            _ds = objSql.RetrieveDataset("Usp_UWSaralFetchAgentDetails", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :GetAgentDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "GetAgentDetails", "E-Error", "", "", Error.ToString());
        }
    }




    /*added by Kavita on 26 FEB 2020 for CR-26885*/
    public void GetApplicationDetailsForInvestigationRpt(ref DataSet _ds, string ApplicationNo)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :GetApplicationDetailsForInvestigationRpt");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ApplicationNumber", ApplicationNo);
            _ds = objSql.RetrieveDataset("Usp_UWSaralFetchDetailsForInvestigationRep", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :GetAgentDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "GetAgentDetails", "E-Error", "", "", Error.ToString());
        }
    }

    /*added by Kavita on 26 FEB 2020 for CR-26885*/
    public void GetExistingInvestDetails(ref DataSet _ds, string ApplicationNo)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :GetAgentDetails");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@ApplicationNumber", ApplicationNo);
            _sqlparam[1] = new SqlParameter("@flag", "fetch");
            _ds = objSql.RetrieveDataset("Usp_UWSaral_FetchInvestigationExistingDetails", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :GetAgentDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "GetAgentDetails", "E-Error", "", "", Error.ToString());
        }
    }

    /*added by Kavita on 26 FEB 2020 for CR-26885*/
    bool flag3;
    public bool InsertInvestigationReportForPostClick(string policyNo, string AppNo,
                string Product, string UserId, string ddlPIInvestigationStatus)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.cs // MethodeName :InsertInvestigationReport");
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@PolicyNo", policyNo);
            _sqlparam[1] = new SqlParameter("@ApplicationNumber", AppNo);
            _sqlparam[2] = new SqlParameter("@CreatedBy", UserId);
            _sqlparam[3] = new SqlParameter("@PIInvestigationStatus_ddl", ddlPIInvestigationStatus);
            objSql.Insertrecord("Usp_UWSaralInsPIInvestigation", _sqlparam);
            flag3 = true;
        }
        catch (Exception Error)
        {
            flag3 = false;
            Logger.Error("STAG 2 :PageName :Commfun.cs // MethodeName :InsertInvestigationReport Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "InsertInvestigationReport_ErrorLog", "E-Error", "", "", Error.ToString());
        }
        return flag3;
    }
    public void GetMasterPincode(string strAppNo, ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :GetAUBankCases");
            SqlParameter[] _objSqlParam = new SqlParameter[1];
            _objSqlParam[0] = new SqlParameter("@AppNo", strAppNo);

            _ds = objSql.RetrieveDataset("USP_USARAL_GETMasterPincode", _objSqlParam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :GetAUBankCases Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "FetchReqRaised", "BAL.CS", "GetAUBankCases", "E-Error", "", "", Error.ToString());
        }
    }

    //27 start changes to Shweta Mamilwar
    public DataSet getFGDataShow(string ApplicationNo, string CreatedBy)
    {
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@Input_Proposal_Policy_No", ApplicationNo);
            _sqlparam[1] = new SqlParameter("@CreatedBy", CreatedBy);
            ds = objSql.RetrieveDataset("usp_GetFGData", _sqlparam);
            return ds;
        }
        catch (Exception)
        {

            throw;
        }

    }
    public DataSet GetLABypassFlagData(string ApplicationNo)
    {
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            ds = objSql.RetrieveDataset("usp_GetLABypassFlagData", _sqlparam);
            return ds;
        }
        catch (Exception)
        {

            throw;
        }

    }
    public DataSet FetchIIBData(string applicationno)
    {
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@CLT_applicationNo", applicationno);
            ds = objSql.RetrieveDataset("usp_GetUWIIBData", _sqlparam);
            //ds = objSql.dpRetrieveDataset(objSql.DBString("CON_transactiondbLF"), "usp_GetIIBData", _sqlparam);//usp_QA_SaveClientPanAadharDetail_V2
            return ds;
        }
        catch (Exception)
        {
            throw;
        }
    }

    //Added by kavita on 20Aug2021_New IIB service Changes
    public DataSet GetProductDetails(string ApplicationNo)
    {
        try
        {

            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", ApplicationNo);

            ds = objSql.RetrieveDataset("Usp_GetProduct_UIN", _sqlparam);
            return ds;
        }
        catch (Exception ex)
        {
            //DatabaseLayer.LogWrite("CommonFunc", ex.Message.ToString(), "", "IIBLogtable", string.Empty, "ApplicationNo", ApplicationNo, string.Empty, string.Empty, string.Empty, string.Empty, string.Empty, "DE/DEQC", "E", string.Empty);
            throw;
        }
    }
    //Ended by kavita on 20Aug2021
    public DataSet FetchRevivalIIBData(string applicationno)
    {
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", applicationno);
            ds = objSql.RetrieveDataset("usp_LADataForIIBRequest", _sqlparam);
            //ds = objSql.dpRetrieveDataset(objSql.DBString("CON_transactiondbLF"), "usp_GetIIBData", _sqlparam);//usp_QA_SaveClientPanAadharDetail_V2
            return ds;
        }
        catch (Exception)
        {
            throw;
        }
    }
    public DataSet IIBLogtable(string ApplicationNo, string MethodName, string RequestData, string ResponseData, string IIBStatus, string RemarksError,
  string NOMatchData, string CreatedBy, string Type, string ExceptionError, string Comments)
    {
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[11];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            _sqlparam[1] = new SqlParameter("@MethodName", MethodName);
            _sqlparam[2] = new SqlParameter("@RequestData", RequestData);
            _sqlparam[3] = new SqlParameter("@ResponseData", ResponseData);
            _sqlparam[4] = new SqlParameter("@IIBStatus", IIBStatus);
            _sqlparam[5] = new SqlParameter("@RemarksError", RemarksError);
            _sqlparam[6] = new SqlParameter("@NOMatchData", NOMatchData);
            _sqlparam[7] = new SqlParameter("@CreatedBy", CreatedBy);
            _sqlparam[8] = new SqlParameter("@Type", Type);
            _sqlparam[9] = new SqlParameter("@ExceptionError", ExceptionError);
            _sqlparam[10] = new SqlParameter("@Comments", Comments);
            ds = objSql.RetrieveDataset("USP_IIBQueryLogTable", _sqlparam);
            return ds;
        }
        catch (Exception)
        {

            throw;
        }
    }
    public DataSet MappingMaster(string Code)
    {
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@Code", Code);
            ds = objSql.RetrieveDataset("USP_IIBPolicyStatusDesc", _sqlparam);
            return ds;
        }
        catch (Exception)
        {

            throw;
        }
    }
    public DataSet SaveIIBData(string ApplicationNo, string QuestDBNo, string Matching_Parameter, string DoP_DoC, string Sum_Assured,
    string Policy_Status, string Date_of_Exit, string Date_of_Death, string Cause_of_Death, string Record_last_updated, string Entity_Caution_Status, string Intermediary_Caution_Status, string Company_Number, string Negative_Match, string LAProposerPayor, string CreatedBy)
    {
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[16];
            _sqlparam[0] = new SqlParameter("@Input_Proposal_Policy_No", ApplicationNo);
            _sqlparam[1] = new SqlParameter("@QuestDBNo", QuestDBNo);
            _sqlparam[2] = new SqlParameter("@Input_Matching_Parameter", Matching_Parameter);
            _sqlparam[3] = new SqlParameter("@Quest_DoP_DoC", DoP_DoC);
            _sqlparam[4] = new SqlParameter("@Quest_Sum_Assured", Sum_Assured);
            _sqlparam[5] = new SqlParameter("@Quest_Policy_Status", Policy_Status);
            _sqlparam[6] = new SqlParameter("@Quest_Date_of_Exit", Date_of_Exit);
            _sqlparam[7] = new SqlParameter("@Quest_Date_of_Death", Date_of_Death);
            _sqlparam[8] = new SqlParameter("@Quest_Cause_of_Death", Cause_of_Death);
            _sqlparam[9] = new SqlParameter("@Quest_Record_last_updated", Record_last_updated);
            _sqlparam[10] = new SqlParameter("@Quest_Entity_Caution_Status", Entity_Caution_Status);
            _sqlparam[11] = new SqlParameter("@Quest_Intermediary_Caution_Status", Intermediary_Caution_Status);
            _sqlparam[12] = new SqlParameter("@Quest_Company_Number", Company_Number);
            _sqlparam[13] = new SqlParameter("@Is_Negative_Match", Negative_Match);
            _sqlparam[14] = new SqlParameter("@LAProposerPayor", LAProposerPayor);
            _sqlparam[15] = new SqlParameter("@CreatedBy", CreatedBy);
            ds = objSql.RetrieveDataset("usp_SaveIIBFGData", _sqlparam);

            return ds;
        }
        catch (Exception)
        {

            throw;
        }
    }
    public DataSet IIBQueryData(DataTable dt)
    {
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@dt", dt);
            #region Start 38.1: This CR-2809 changes done by Sushant Devkate MFL00905 
            // ds = objSql.RetrieveDataset("usp_SaveIIBQueryData", _sqlparam);
            ds = objSql.RetrieveDataset("Usp_UWSaralSaveIIBQueryData", _sqlparam);
            #endregion End 38.1: This CR-2809 changes done by Sushant Devkate MFL00905 
            return ds;
        }
        catch (Exception)
        {

            throw;
        }

    }
    public DataSet SumAssured(string strApplicationNo, string strSisNo)
    {
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@applicationnumber", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@sisnumber", strSisNo);
            ds = objSql.RetrieveDataset("usp_plvc_get_ApplicationDetails", _sqlparam);
            //ds = objSql.dpRetrieveDataset(objSql.DBString("CON_transactiondbLF"), "usp_plvc_get_ApplicationDetails", _sqlparam); //check this
            return ds;
        }
        catch (Exception ex)
        {
            throw ex;
        }
    }
    public DataSet ByPassDDL(string ApplicationNo)
    {
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            ds = objSql.RetrieveDataset("USP_ByPassFlagDDL", _sqlparam);
            return ds;
        }
        catch (Exception ex)
        {
            throw ex;
        }
    }
    public void UpdateBypassFlag(string ApplicationNo, string BypassFlag, string Type)
    {
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            _sqlparam[1] = new SqlParameter("@BypassFlag", BypassFlag);
            _sqlparam[2] = new SqlParameter("@Type", Type);
            objSql.Insertrecord("USP_UpdateEAModule", _sqlparam);

        }
        catch (Exception ex)
        {
            throw ex;
        }
    }
    public static IIBData.SecuredWebServiceHeader GetIIBLoginDetails()
    {
        IIBData.SecuredWebServiceHeader swh = new IIBData.SecuredWebServiceHeader();
        swh.Username = ConfigurationManager.AppSettings["UsernameIIB"].ToString();
        swh.Password = ConfigurationManager.AppSettings["PasswordIIb"].ToString();
        swh.AuthenticatedToken = ConfigurationManager.AppSettings["AuthenticatedToken"].ToString();
        return swh;
    }
    //27 End change To Shweta Mamilwar

    //########################## 28.2 Begin of Changes CR 26273;Akshada ###########################################
    public void UWSaralPolicyPremDetails_GET(ref DataSet _ds, string ApplicationNo, string strPolicyNo)
    {
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[1];
            //_sqlparam[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            _sqlparam[0] = new SqlParameter("@PolicyNumber", strPolicyNo);
            _ds = objSql.RetrieveDataset_STPDetails("usp_Reinstatement_SinglePolicyDetails", _sqlparam);
            //_ds = objSql.RetrieveDataset_STPDetails("usp_Reinstatement_SinglePolicyDetails1", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(ApplicationNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineAgentDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(ApplicationNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineAgentDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }

    }

    public void GetOfflineOnlinePolicyDetails(ref DataSet _dsOnlineOffline, string PolicyNo, string strPQuoteNo, string Flag)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-C  :PageName :Commfun.CS // MethodeName :OnlineApplicationDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[3];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@Flag", Flag);
            _sqlparam[2] = new SqlParameter("@Policy", PolicyNo);
            _dsOnlineOffline = objSql.RetrieveDataset("Usp_Reinstement_STPServices_ONLINE_OFFLINE_Policy", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineApplicationDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void GetHealthProducts(ref DataSet _ds, string ProductCode, string src)
    {
        try
        {
            Logger.Info(ProductCode + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineTsmrMsarDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@prodcode", ProductCode);
            _sqlparam[1] = new SqlParameter("@src", src);
            _ds = objSql.RetrieveDataset_PROCODE("usp_gethealthproducts", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(ProductCode + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineTsmrMsarDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(ProductCode, "Failed", "UWPortfolio", "Commfun.cs", "OnlineTsmrMsarDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void GetSTPDetails(ref DataSet _ds, string PolicyNumber)
    {
        try
        {
            Logger.Info(PolicyNumber + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineTsmrMsarDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@PolicyNumber", PolicyNumber);
            _ds = objSql.RetrieveDataset_STPDetails("usp_Reinstatement_STPDetails", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(PolicyNumber + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineTsmrMsarDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(PolicyNumber, "Failed", "UWPortfolio", "Commfun.cs", "OnlineTsmrMsarDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void GetTMAX(ref DataSet _ds, string Age, string Flag)
    {
        try
        {
            //Logger.Info(ProductCode + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineTsmrMsarDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@Age", Age);
            _sqlparam[1] = new SqlParameter("@Flag", Flag);
            _ds = objSql.RetrieveDataset_STPDetails("Usp_Reinstatement_StatusUpdates", _sqlparam);
        }
        catch (Exception)
        {
            //Logger.Error(ProductCode + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineTsmrMsarDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            //SaveErrorLogs(ProductCode, "Failed", "UWPortfolio", "Commfun.cs", "OnlineTsmrMsarDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void GetTotalPremium(ref DataSet _ds, string PolicyNumber, string Flag)
    {
        try
        {
            //Logger.Info(ProductCode + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineTsmrMsarDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PolicyNumber", PolicyNumber);
            _sqlparam[1] = new SqlParameter("@Flag", Flag);
            _ds = objSql.RetrieveDataset_STPDetails("Usp_Reinstatement_StatusUpdates", _sqlparam);
        }
        catch (Exception)
        {
            //Logger.Error(ProductCode + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineTsmrMsarDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            //SaveErrorLogs(ProductCode, "Failed", "UWPortfolio", "Commfun.cs", "OnlineTsmrMsarDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void LoadUWsaralPageDetails_RevivalCases(ref DataSet _dsAllData, string strPQuoteNo, string AppType, string strUserId, string strPolicyNo)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :LoadUWsaralPageDetails");
            _dsAppdtls = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@UserId", strUserId);
            _sqlparam[1] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[2] = new SqlParameter("@AppType", AppType);
            _sqlparam[3] = new SqlParameter("@PolicyNo", strPolicyNo);
            /*ID:5 START*/
            //############################################ FG EXISTING PROCEDURE ####################################################
            //_dsAllData = objSql.RetrieveDataset("usp_UWOnlineAllDetailsApi_Get_V7", _sqlparam);For UAT Aadhar transaction number
            //############################################ FG EXISTING PROCEDURE #################################################

            //############################################ Testing PROCEDURE #######################################################
            _dsAllData = objSql.RetrieveDataset("usp_UWOnlineAllDetailsApi_Get_Revival", _sqlparam);
            //############################################ Testing PROCEDURE #######################################################
            /*ID:5 END*/
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :LoadUWsaralPageDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "LoadUWsaralPageDetails", "E-Error", "", "", Error.ToString());
        }
    }

    public void UWReinstatementReducedSumAssured_GET(ref DataSet _ds, string ApplicationNo, string strPolicyNo)
    {
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[1];
            //_sqlparam[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            _sqlparam[0] = new SqlParameter("@PolicyNumber", strPolicyNo);
            _ds = objSql.RetrieveDataset("usp_UWSARAL_ReinstatementReducedSumAssured", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(ApplicationNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineAgentDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(ApplicationNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineAgentDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }

    }

    public DataTable EmailParameter(string Flag1, string CommunicationType, string CommunicationKey, string Process, string TemplateId, string MailTo, string MailCC, string MobileNo, string Mode, string CreatedBy, string IsAttached, string AttachedFiles, string ApplicationNo, string PolicyNumber, string ParameterList, string FileName, string IsExternal)
    {
        DataTable ResultTable = new DataTable();
        DataSet ResultSet = new DataSet();
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :UpdateApplicationStatus");
            SqlParameter[] _sqlparam = new SqlParameter[17];
            _sqlparam[0] = new SqlParameter("@Flag", Flag1);
            _sqlparam[1] = new SqlParameter("@CommunicationType", CommunicationType);
            _sqlparam[2] = new SqlParameter("@CommunicationKey", CommunicationKey);
            _sqlparam[3] = new SqlParameter("@Process", Process);
            _sqlparam[4] = new SqlParameter("@TemplateId", TemplateId);
            _sqlparam[5] = new SqlParameter("@MailTo", MailTo);
            _sqlparam[6] = new SqlParameter("@MailCC", MailCC);
            _sqlparam[7] = new SqlParameter("@MobileNo", MobileNo);
            _sqlparam[8] = new SqlParameter("@Mode", Mode);
            _sqlparam[9] = new SqlParameter("@CreatedBy", CreatedBy);
            _sqlparam[10] = new SqlParameter("@IsAttached", IsAttached);
            _sqlparam[11] = new SqlParameter("@AttachedFiles", AttachedFiles);
            _sqlparam[12] = new SqlParameter("@ApplicationNo", ApplicationNo);
            _sqlparam[13] = new SqlParameter("@PolicyNumber", PolicyNumber);
            _sqlparam[14] = new SqlParameter("@ParameterList", ParameterList);
            _sqlparam[15] = new SqlParameter("@FileName", FileName);
            _sqlparam[16] = new SqlParameter("@IsExternal", IsExternal);


            //objSql.RetrieveDataset_STPDetails("Usp_InputProcEmailSMSService", _sqlparam);
            ResultSet = objSql.RetrieveDataset_STPDetails("Usp_InputProcEmailSMSService", _sqlparam);
            ResultTable = ResultSet.Tables[0];
            return ResultTable;

        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateAppStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "UpdateAppStatus", "E-Error", "", "", Error.ToString());
        }
        return ResultTable;
    }

    public void OnlineServiceFollowUPDetails_GET(ref DataSet _ds, string strPQuoteNo, string strAppType)
    {
        Logger.Info(strPQuoteNo + "PAGE_NAME:UWSaralDecision/BussLayer //EVENT_NAME:OnlineApplicationLAServiceDetails_PUSH//I-INFO:Date Request : REQUIRMENTS" + System.Environment.NewLine);
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strAppType);
            _ds = objSql.RetrieveDataset("USP_BPM_PolicyFollowpDetailsGet_V2", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Info(strPQuoteNo + "PAGE_NAME:UWSaralDecision/BussLayer //EVENT_NAME:OnlineApplicationLAServiceDetails_PUSH//E-ERROR Date Request : REQUIRMENTS" + Error.Message + System.Environment.NewLine);
            SaveErrorLogs(strPQuoteNo, "Failed", "UWSaralDecision", "Commfun.cs", "OnlineServiceFollowUPDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }
    public void UWSaralUpdate(string Policynumber, string strUserId, string Flag, string Status)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :UpdateApplicationStatus");
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@PolicyNumber", Policynumber);
            _sqlparam[1] = new SqlParameter("@Flag", Flag);
            _sqlparam[2] = new SqlParameter("@UserId", strUserId);
            _sqlparam[3] = new SqlParameter("@Status", Status);
            //_sqlparam[4] = new SqlParameter("@bpm_branchCode", string.Empty);
            //_sqlparam[5] = new SqlParameter("@bpm_userBranch", string.Empty);
            //_sqlparam[6] = new SqlParameter("@bpm_processName", "Manual Underwriting");
            //_sqlparam[7] = new SqlParameter("@bpm_applicationName", "FGLIFE");

            objSql.Insertrecord("usp_UWSARAL_ReinstatementStatus", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateAppStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "UpdateAppStatus", "E-Error", "", "", Error.ToString());
        }
    }

    //CheckOpenRequirement
    public void CheckOpenRequirement(string ApplicationNumber, string Flag, ref DataSet dsREQ)
    {

        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :UpdateApplicationStatus");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@ApplicationNumber", ApplicationNumber);
            _sqlparam[1] = new SqlParameter("@Flag", Flag);
            //_sqlparam[2] = new SqlParameter("@UserId", strUserId);
            //_sqlparam[3] = new SqlParameter("@Status", Status);

            dsREQ = objSql.RetrieveDataset_STPDetails("Usp_Reinstatement_CheckRequirents", _sqlparam);

        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateAppStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "UpdateAppStatus", "E-Error", "", "", Error.ToString());
        }
    }

    public void UpdateReciptAmt(string ApplicationNumber, string Flag)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :UpdateApplicationStatus");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@APPLICATIONNO", ApplicationNumber);
            _sqlparam[1] = new SqlParameter("@FLAG", Flag);
            //_sqlparam[2] = new SqlParameter("@UserId", strUserId);
            //_sqlparam[3] = new SqlParameter("@Status", Status);
            //_sqlparam[4] = new SqlParameter("@bpm_branchCode", string.Empty);
            //_sqlparam[5] = new SqlParameter("@bpm_userBranch", string.Empty);
            //_sqlparam[6] = new SqlParameter("@bpm_processName", "Manual Underwriting");
            //_sqlparam[7] = new SqlParameter("@bpm_applicationName", "FGLIFE");

            objSql.RetrieveDataset_STPDetails("USP_REINSTATEMENT_VALIDATIONS", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :UpdateAppStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "UpdateAppStatus", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineMasterDisplayDetails_GETRevival(ref DataSet _ds)
    {
        try
        {
            Logger.Info("STAG 2 A1 :PageName :Commfun.CS // MethodeName :OnlineMasterDisplayDetails_GET");
            _ds = objSql.RetrieveDataset_woParam("USP_BPM_MasterDetailsFetch_V3_RevivalCases");
            if (_ds.Tables.Count > 0)
            {
                _ds.Tables[0].TableName = "ddlfollowupcode";
                _ds.Tables[1].TableName = "ddlCategory";
                _ds.Tables[2].TableName = "ddlCriteria";
                _ds.Tables[3].TableName = "ddlStatus";
                _ds.Tables[4].TableName = "ddlLoadType";
                _ds.Tables[5].TableName = "ddlUWDecesion";
                _ds.Tables[6].TableName = "ddlUWreason";
                _ds.Tables[7].TableName = "ddlLoadFlatMortality";
                _ds.Tables[8].TableName = "ddlBkdateReason";
                _ds.Tables[9].TableName = "ddlIfscCode";
                _ds.Tables[10].TableName = "ddlLoadRsn1";
                _ds.Tables[11].TableName = "ddlLoadRsn2";
                _ds.Tables[12].TableName = "ddlLoadTypeVal";
                _ds.Tables[13].TableName = "ddlAutoPaytype";
                /*ID:6 STRART*/
                if (_ds.Tables.Count > 14)
                {
                    _ds.Tables[14].TableName = "cblDecisionType";
                }
                if (_ds.Tables.Count > 15)
                {
                    _ds.Tables[15].TableName = "ddlProposalType";
                }
                if (_ds.Tables.Count > 16)
                {
                    _ds.Tables[16].TableName = "ddlProposalType2";
                }
                if (_ds.Tables.Count > 17)
                {
                    _ds.Tables[17].TableName = "ddlProposalType3";
                }
                /*ID:6 END*/
                if (_ds.Tables.Count > 18)
                {
                    _ds.Tables[18].TableName = "ddlRequirementMedicalReason";
                }
                if (_ds.Tables.Count > 19)
                {
                    _ds.Tables[19].TableName = "ddlAnswer";
                }
                //Added by Suraj on 25 APRIL 2018 for Assign type dropdown
                if (_ds.Tables.Count > 20)
                {
                    _ds.Tables[20].TableName = "ddlAssigmentType";
                }
                //Added by Suraj on 5 JULY 2018 for Country list
                if (_ds.Tables.Count > 21)
                {
                    _ds.Tables[21].TableName = "ddlcountry";
                }
                //Added by Suraj on 25 JULY 2019 for signature match
                if (_ds.Tables.Count > 22)
                {
                    _ds.Tables[22].TableName = "ddlSignature";
                }
            }
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineMasterDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineMasterDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void FetchManualAllocationRevival(string strChannel, int intFilterType, string strInput1, string strInput2, ref DataSet _ds)
    {
        Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :FetchManualAllocationRevival");
        SqlParameter[] _sqlparam = new SqlParameter[4];
        _sqlparam[0] = new SqlParameter("@Channel", strChannel);
        _sqlparam[1] = new SqlParameter("@FilterType", intFilterType);
        _sqlparam[2] = new SqlParameter("@InputValue1", strInput1);
        _sqlparam[3] = new SqlParameter("@InputValue2", strInput2);

        _ds = objSql.RetrieveDataset("USP_UWSARAL_MANUAL_ALLOCATION_Testing", _sqlparam);

    }


    public void OnlineProductDisplayDetails_GETRevival(ref DataSet _ds, string strPQuoteNo, string strChanneltype)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-G :PageName :Commfun.CS // MethodeName :OnlineProductDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strChanneltype);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_UWDECISION_FETCH_PRODUCT_DETAILS_RevivalCases", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineProductDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineProductDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public DataTable GetRevivalDate(string PolicyNumber)
    {
        DataTable dtrevivaldate = new DataTable();
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@policyNumber", PolicyNumber);
            ds = objSql.revivaldate("GetREVIVALDate05022020", _sqlparam);
            dtrevivaldate = ds.Tables[0];

        }
        catch (Exception ex)
        {
            //Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineProductDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            //SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineProductDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
        return dtrevivaldate;
    }
    public void GetApplicationDetails(string strApplicationNo, string strUserId, string strChanneltype, ref DataSet _ds)
    {
        Logger.Info("STAG 3-A :PageName :Commfun.CS // MethodeName :GetApplicationDetails");
        SqlParameter[] _sqlparam = new SqlParameter[3];
        _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strApplicationNo);
        _sqlparam[1] = new SqlParameter("@USERID", strUserId);
        _sqlparam[2] = new SqlParameter("@Channeltype", strChanneltype);
        _ds = objSql.RetrieveDataset("USP_REVIVAL_AND_UWSARAL", _sqlparam);
        //_ds = objSql.RetrieveDataset("USP_UWSARAL_DASHBOAR_FETCH_APPLICAION_DETAILS_REISSUE_V2_Combi", _sqlparam);

    }

    //########################## 28.2 End of Changes CR 26273;Akshada  ###########################################
    bool flag4;
    public bool InsertRiskInvestigationStatusForPostClick(string AppNo, string status)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.cs // MethodeName :InsertInvestigationReportForPostClick");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@AppNo", AppNo);
            _sqlparam[1] = new SqlParameter("@Status", status);
            objSql.Insertrecord("Usp_RiskInvestigationDecisionStatus", _sqlparam);
            flag4 = true;

        }

        catch (Exception ex)
        {
            flag4 = false;
            throw;
        }
        return flag4;
    }

    //########################## 29.1 Begin of Changes by Akshada; CR-28153 ###########################################

    public DataTable InsertConsentDetails(string PolicyNumber, string Flag, string Applicationno, string ProductName, string ProposerName, string LifeInsuredName
       , decimal SumAssured, int PolicyTerm, decimal BasePremium, decimal LoadedPremium, decimal TotalTax, decimal TotalPremiumPayable, decimal TotalAmountPaidTillNow,
       decimal BalanceAmountPayable, string PlanID, string ConsentStatus, int PremiumPaymentTerm, string CreatedBy, string updatedby, bool IsBasePlan, string UniqueID,
       string EmailID, string MobileNo)
    {
        DataTable dtclientdata = new DataTable();
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[23];

            _sqlparam[0] = new SqlParameter("@GUID", UniqueID);
            _sqlparam[1] = new SqlParameter("@Applicationno", Applicationno);
            _sqlparam[2] = new SqlParameter("@PolicyNumber", PolicyNumber);
            _sqlparam[3] = new SqlParameter("@PlanID", PlanID);
            _sqlparam[4] = new SqlParameter("@IsBasePlan", IsBasePlan);
            _sqlparam[5] = new SqlParameter("@ProductName", ProductName);
            _sqlparam[6] = new SqlParameter("@ProposerName", ProposerName);
            _sqlparam[7] = new SqlParameter("@LifeInsuredName", LifeInsuredName);
            _sqlparam[8] = new SqlParameter("@PolicyTerm", PolicyTerm);
            _sqlparam[9] = new SqlParameter("@PremiumPaymentTerm", PremiumPaymentTerm);
            _sqlparam[10] = new SqlParameter("@BasePremium", BasePremium);
            _sqlparam[11] = new SqlParameter("@TotalTax", TotalTax);
            _sqlparam[12] = new SqlParameter("@TotalPremiumPayable", TotalPremiumPayable);
            _sqlparam[13] = new SqlParameter("@Createdby", CreatedBy);
            _sqlparam[14] = new SqlParameter("@Updatedby", updatedby);
            _sqlparam[15] = new SqlParameter("@SumAssured", SumAssured);
            _sqlparam[16] = new SqlParameter("@Flag", Flag);
            _sqlparam[17] = new SqlParameter("@LoadedPremium", LoadedPremium);
            _sqlparam[18] = new SqlParameter("@TotalAmountPaidTillNow ", TotalAmountPaidTillNow);
            _sqlparam[19] = new SqlParameter("@BalanceAmountPayable", BalanceAmountPayable);
            _sqlparam[20] = new SqlParameter("@ConsentStatus", ConsentStatus);
            _sqlparam[21] = new SqlParameter("@EmailID", EmailID);
            _sqlparam[22] = new SqlParameter("@MobileNo", MobileNo);
            ds = objSql.GetClientDetails("USP_Fetch_Client_Details_Consent_letter", _sqlparam);
            dtclientdata = ds.Tables[0];

        }
        catch (Exception ex)
        {
            Logger.Error(Applicationno + "STAG 2 :PageName :Commfun.CS // MethodeName :InsertConsentDetails Error :" + System.Environment.NewLine + ex.ToString());
            SaveErrorLogs(Applicationno, "Failed", "UWPortfolio", "Commfun.cs", "InsertConsentDetails", "E-Error", "", "", ex.ToString());
        }
        return dtclientdata;
    }


    public DataSet FetchRiderDetailsConsentLetter(string ApplicationNo, string Channel)
    {
        DataSet ds = new DataSet();
        try
        {

            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NO", ApplicationNo);
            _sqlparam[1] = new SqlParameter("@Apptype", Channel);
            ds = objSql.GetClientDetails("USP_UWSARAL_FETCH_CONSENT_RIDERDETAILS", _sqlparam);

        }
        catch (Exception ex)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :FetchRiderDetailsConsentLetter Error :" + System.Environment.NewLine + ex.Message.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "FetchRiderDetailsConsentLetter", "E-Error", "", "", ex.Message.ToString());

        }
        return ds;
    }

    public DataTable GetClientData(string PolicyNumber)
    {
        DataTable dtclientdata = new DataTable();
        try
        {
            DataSet ds = new DataSet();

            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@PolicyNumber", PolicyNumber);


            ds = objSql.GetClientdata("usp_Reinstatement_GetMobileNumber", _sqlparam);
            dtclientdata = ds.Tables[0];

        }
        catch (Exception ex)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :GetClientData Error :" + System.Environment.NewLine + ex.Message.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "GetClientData", "E-Error", "", "", ex.Message.ToString());
        }
        return dtclientdata;

    }

    //########################## 29.1 End of Changes by Akshada; CR-28153 ###########################################

    //start--added by suraj for combi product 
    public void GetCombiFlag(ref DataSet _ds, string strAppno)
    {
        Logger.Info(strAppno + ":PageName :UWSaralServices/CommFun.CS // MethodeName :GetCombiFlag");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@AppNo", strAppno);
            // _sqlparam[1] = new SqlParameter("@AppType", strAppType);
            _ds = objSql.RetrieveDataset("USP_SARAL_GetCombiFlag_1", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strAppno + ":PageName :UWSaralServices/CommFun.CS // MethodeName :GetCombiFlag");
            SaveErrorLogs(strAppno, "Failed", "UWSaralDecision", "Commfun.cs", "GetCombiFlag", "E-Error", "", "", Error.ToString());
        }
    }
    public void UpdateCombiFlag_Detach(ref DataSet _ds, string strChildAppNo, string strAppType)
    {
        Logger.Info(strChildAppNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :UpdateCombiFlag_Detach");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@AppNo", strChildAppNo);
            _sqlparam[1] = new SqlParameter("@AppType", strAppType);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_COMBIFLAG_UPDATE", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strChildAppNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :UpdateCombiFlag_Detach");
            SaveErrorLogs(strChildAppNo, "Failed", "UWSaralDecision", "Commfun.cs", "UpdateCombiFlag_Detach", "E-Error", "", "", Error.ToString());
        }
    }
    //END
    //start--added by suraj for combi product 
    public void GetAppNo(ref DataSet _ds, string strPolNum)
    {
        Logger.Info(strPolNum + ":PageName :UWSaralServices/CommFun.CS // MethodeName :GetAppNo");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@PolNo", strPolNum);
            // _sqlparam[1] = new SqlParameter("@AppType", strAppType);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_GETAPPNO_COMBI", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPolNum + ":PageName :UWSaralServices/CommFun.CS // MethodeName :GetAppNo");
            SaveErrorLogs(strPolNum, "Failed", "UWSaralDecision", "Commfun.cs", "GetAppNo", "E-Error", "", "", Error.ToString());
        }
    }
    //end
    public void Update_WP_RiderSA(ref DataSet _ds, string strPolicyNo, string strApplicationNo, string SumAssured, string channel)
    {
        try
        {
            Logger.Info("STAG 2 A1 :PageName :Commfun.CS // MethodeName :Update_WP_RiderSA");
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@PolNo", strPolicyNo);
            _sqlparam[1] = new SqlParameter("@AppNo", strApplicationNo);
            _sqlparam[2] = new SqlParameter("@SA", SumAssured);
            _sqlparam[3] = new SqlParameter("@Apptype", channel);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_Update_WP_Rider_SA", _sqlparam);


        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :Update_WP_RiderSA Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "Update_WP_RiderSA", "E-Error", "", "", Error.ToString());
        }
    }
    /*ADDED BY SURAJ ON 22 DEC 20 TO UPDATE PAYOUT DETAILS IN DEAPPLICATIONDETAILS TABLE*/
    public void ManagePayoutDetail(string strAppno, string strcetagory, string strPayoutType, string strPayoutTerm, string strLumpsumPer, string strPayoutfreq
        , string strProdCategory, ref int response)
    {
        Logger.Info(strAppno + "STAG 3-A :PageName :Commfun.CS // MethodeName : ManageRiderInfo");
        SqlParameter[] _sqlparam = new SqlParameter[7];
        _sqlparam[0] = new SqlParameter("@AppNo", strAppno);
        _sqlparam[1] = new SqlParameter("@Category", strcetagory);
        _sqlparam[2] = new SqlParameter("@PayoutType", strPayoutType);
        _sqlparam[3] = new SqlParameter("@PayoutTerm", strPayoutTerm);
        _sqlparam[4] = new SqlParameter("@LumpSumPercent", strLumpsumPer);
        _sqlparam[5] = new SqlParameter("@PayOutFrquency", strPayoutfreq);
        _sqlparam[6] = new SqlParameter("@ProductCategory", strProdCategory);
        response = objSql.Insertrecord("USP_UWSARAL_SAVE_PAYOUTDETAILS", _sqlparam);
    }
    //end

    public void GetIIB_ButtonFLAG(ref DataSet _ds)
    {
        Logger.Info(":PageName :UWSaralServices/CommFun.CS // MethodeName :CheckCloseFileReview");
        try
        {
            //SqlParameter[] _sqlparam = new SqlParameter[2];
            //_sqlparam[0] = new SqlParameter("@struserid", strUserKey);
            //_sqlparam[1] = new SqlParameter("@ApplicationNo", strApplicationNo);
            _ds = objSql.RetrieveDataset_woParam("USP_UWSARAL_GET_IIB_BUTTOBFLAG");
        }
        catch (Exception Error)
        {
            Logger.Error(":PageName :UWSaralServices/CommFun.CS // MethodeName :GetIIB_ButtonFLAG");
            SaveErrorLogs(string.Empty, "Failed", "UWSaralDecision", "Commfun.cs", "GetIIB_ButtonFLAG", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID 30.1 START*/
    public void CreateWorkItem_Single(string strApplicationNo, string strUserId, ref int intRet)
    {
        Logger.Info(":PageName :CreateWorkItem/CommFun.CS // MethodeName :CreateWorkItem_Single");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NO", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@USER_ID", strUserId);
            intRet = objSql.Insertrecord("USP_UWSARAL_UTILITY_RESTART_CASE ", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(":PageName :CreateWorkItem/CommFun.CS // MethodeName :CreateWorkItem_Single");
            SaveErrorLogs(string.Empty, "Failed", "CreateWorkItem", "Commfun.cs", "CreateWorkItem_Single", "E-Error", "", "", Error.ToString());
        }
    }
    public void CreateWorkItem_Bulk(string strApplicationNo, string strUserId, ref int intRet)
    {
        Logger.Info(":PageName :CreateWorkItem/CommFun.CS // MethodeName :CreateWorkItem_Bulk");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@APPLICATION_NO_new", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@USER_ID", strUserId);
            intRet = objSql.Insertrecord("USP_UWSARAL_UTILITY_RESTART_CASE_Bulk ", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(":PageName :CreateWorkItem/CommFun.CS // MethodeName :CreateWorkItem_Bulk");
            SaveErrorLogs(string.Empty, "Failed", "CreateWorkItem", "Commfun.cs", "CreateWorkItem_Bulk", "E-Error", "", "", Error.ToString());
        }
    }
    public void Logs_Workitem(string strApplicationNo,int iscreated,string strerror, string strUserId, ref int intRet)
    {
        Logger.Info(":PageName :CreateWorkItem/CommFun.CS // MethodeName :Logs_Workitem");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@Appno", strApplicationNo);
            _sqlparam[1] = new SqlParameter("@IsCreated", iscreated);
            _sqlparam[2] = new SqlParameter("@Error", strerror);
            _sqlparam[3] = new SqlParameter("@UserId", strUserId);
            intRet = objSql.Insertrecord("USP_UWSARAL_InsertLog_WorkItem", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(":PageName :CreateWorkItem/CommFun.CS // MethodeName :Logs_Workitem");
            SaveErrorLogs(string.Empty, "Failed", "CreateWorkItem", "Commfun.cs", "Logs_Workitem", "E-Error", "", "", Error.ToString());
        }
    }
    /*ID 30.1 END*/

    //31.1 Begin of Changes; Brijesh Pandey - [MFL00464]
    public string GetIIBRiskScore(string AppNo, string Type, string EventInvokedBy,string UserID)
    {
        string IIBRiskScore = "";
        string Token = "";
        /*
        DataSet dsIIB = new DataSet();
        objComm.GetIIB_ButtonFLAG(ref dsIIB);
        if (dsIIB != null)
        {
            if (dsIIB.Tables.Count > 0 && dsIIB.Tables[1].Rows.Count > 0)
            {
                if (Convert.ToBoolean(dsIIB.Tables[0].Rows[0]["ButtonFlag"]) == true)
                {
                   
                }
            }
        }
        */
        string IIBAPIFlag = ConfigurationManager.AppSettings["IIBScoreAPIFlag"].ToString();
        if (IIBAPIFlag == "Yes")
        {

            try
            {
                // Generate Token - Start
                string inputTokenJson = "{"
                                        + "\"" + "ClientID" + "\"" + ":" + "\"" + ConfigurationManager.AppSettings["ClientID"].ToString() + "\"" + ","
                                        + "\"" + "ClientSecret" + "\"" + ":" + "\"" + ConfigurationManager.AppSettings["ClientSecret"].ToString() + "\"" + ","
                                        + "\"" + "Source" + "\"" + ":" + "\"" + ConfigurationManager.AppSettings["Source"].ToString() + "\"" + ","
                                        + "\"" + "PartnerID" + "\"" + ":" + "\"" + ConfigurationManager.AppSettings["PartnerID"].ToString() + "\""
                                    + "}";

                Newtonsoft.Json.Linq.JObject JResponce = null;
                try
                {
                    System.Net.ServicePointManager.SecurityProtocol = (System.Net.SecurityProtocolType)3072;
                    System.Net.WebClient objWebClient = new System.Net.WebClient();
                    objWebClient.Headers["Content-type"] = "application/json";
                    objWebClient.Headers["Ocp-Apim-Subscription-Key"] = ConfigurationManager.AppSettings["Ocp-Apim-Subscription-Key"].ToString();
                    objWebClient.Encoding = System.Text.Encoding.UTF8;
                    string Response = objWebClient.UploadString(ConfigurationManager.AppSettings["IIBGenerateTokenAPILink"].ToString(), inputTokenJson);
                    JResponce = Newtonsoft.Json.Linq.JObject.Parse(Response);

                    string ErrorCode = Convert.ToString(JResponce["errorCode"]);
                    string ErrorMessage = Convert.ToString(JResponce["errorMessage"]);

                    // Insert Logs
                    INSERTIIBRiskScoreLog(Type, "GenerateToken", AppNo, inputTokenJson, Convert.ToString(JResponce), IIBRiskScore, ErrorMessage, UserID, EventInvokedBy);

                    if (ErrorCode == "0" && ErrorMessage.ToLower() == "success")
                    {
                        Token = Convert.ToString(JResponce["access_token"]);
                    }
                }
                catch (System.Net.WebException ex)
                {
                    // Insert Logs
                    INSERTIIBRiskScoreLog(Type, "GenerateToken", AppNo, inputTokenJson, Convert.ToString(JResponce), IIBRiskScore, ex.ToString(), UserID, EventInvokedBy);
                }
                // Generate Token - End

                // Get IIB Risk Score - Start
                if (Token != "")
                {
                    DataSet ds = new DataSet();

                    GetIIBRiskScoreReqDetails(AppNo, ref ds);

                    if (ds.Tables[0].Rows.Count > 0)
                    {
                        string inputIIBScoreJson = "{"
                                                + "\"" + "DataKeyName" + "\"" + ":" + "\"" + "Policy_Number" + "\"" + ","
                                                + "\"" + "DataKeyValue" + "\"" + ":" + "\"" + Convert.ToString(ds.Tables[0].Rows[0]["Policy_Number"]) + "\"" + ","
                                                + "\"" + "Company_Code" + "\"" + ":" + "\"" + Convert.ToString(ds.Tables[0].Rows[0]["Company_Code"]) + "\"" + ","
                                                + "\"" + "Product_UIN" + "\"" + ":" + "\"" + Convert.ToString(ds.Tables[0].Rows[0]["Product_UIN"]) + "\"" + ","
                                                + "\"" + "Date_of_Commencement" + "\"" + ":" + "\"" + Convert.ToString(ds.Tables[0].Rows[0]["Date_of_Commencement"]) + "\"" + ","
                                                + "\"" + "Distribution_Channel" + "\"" + ":" + "\"" + Convert.ToString(ds.Tables[0].Rows[0]["Distribution_Channel"]) + "\"" + ","
                                                + "\"" + "Product_Code" + "\"" + ":" + "\"" + Convert.ToString(ds.Tables[0].Rows[0]["Product_Code"]) + "\"" + ","
                                                + "\"" + "Sum_Assured" + "\"" + ":" + Convert.ToString(ds.Tables[0].Rows[0]["Sum_Assured"]) + ","
                                                + "\"" + "Date_of_Birth" + "\"" + ":" + "\"" + Convert.ToString(ds.Tables[0].Rows[0]["Date_of_Birth"]) + "\"" + ","
                                                + "\"" + "LA_Gender" + "\"" + ":" + "\"" + Convert.ToString(ds.Tables[0].Rows[0]["LA_Gender"]) + "\"" + ","
                                                + "\"" + "Occupation" + "\"" + ":" + "\"" + Convert.ToString(ds.Tables[0].Rows[0]["Occupation"]) + "\"" + ","
                                                + "\"" + "Education" + "\"" + ":" + "\"" + Convert.ToString(ds.Tables[0].Rows[0]["Education"]) + "\"" + ","
                                                + "\"" + "Client_PIN_Code" + "\"" + ":" + Convert.ToString(ds.Tables[0].Rows[0]["Client_PIN_Code"]) + ","
                                                + "\"" + "Servicing_Office_Code" + "\"" + ":" + "\"" + Convert.ToString(ds.Tables[0].Rows[0]["Servicing_Office_Code"]) + "\"" + ","
                                                + "\"" + "Policy_Term" + "\"" + ":" + Convert.ToString(ds.Tables[0].Rows[0]["Policy_Term"]) + ","
                                                + "\"" + "Premium_Payment_Term" + "\"" + ":" + Convert.ToString(ds.Tables[0].Rows[0]["Premium_Payment_Term"]) + ","
                                                + "\"" + "Premium_Payment_Frequency" + "\"" + ":" + Convert.ToString(ds.Tables[0].Rows[0]["Premium_Payment_Frequency"]) + ","
                                                + "\"" + "APIDetails" + "\"" + ":" + "\"" + ConfigurationManager.AppSettings["APIDetails"].ToString() + "\"" + ","
                                                + "\"" + "Source" + "\"" + ":" + "\"" + ConfigurationManager.AppSettings["IIBAPISource"].ToString() + "\"" + ","
                                                + "\"" + "ErrorMessage" + "\"" + ":" + "\"" + "" + "\""
                                            + "}";

                        Newtonsoft.Json.Linq.JObject JResponceIIBScore = null;
                        try
                        {
                            System.Net.ServicePointManager.SecurityProtocol = (System.Net.SecurityProtocolType)3072;
                            System.Net.WebClient objWebClient = new System.Net.WebClient();
                            objWebClient.Headers["Content-type"] = "application/json";
                            objWebClient.Headers["Ocp-Apim-Subscription-Key"] = ConfigurationManager.AppSettings["Ocp-Apim-Subscription-Key"].ToString();
                            objWebClient.Headers["Authorization"] = Token;
                            objWebClient.Encoding = System.Text.Encoding.UTF8;
                            string ResponseIIBScore = objWebClient.UploadString(ConfigurationManager.AppSettings["IIBRiskScoreAPILink"].ToString(), inputIIBScoreJson);
                            JResponceIIBScore = Newtonsoft.Json.Linq.JObject.Parse(ResponseIIBScore);

                            string ResponseCode = Convert.ToString(JResponceIIBScore["responseResult"]["responseCode"]);
                            string ResponseMessage = Convert.ToString(JResponceIIBScore["responseResult"]["responseMessage"]);
                            string ResponseDescription = Convert.ToString(JResponceIIBScore["responseResult"]["responseDescription"]);
                            if (ResponseCode == "0" && ResponseMessage.ToLower() == "success")
                            {
                                string companyCode = Convert.ToString(JResponceIIBScore["responseBody"]["companyCode"]);
                                string ApplicationNo = Convert.ToString(JResponceIIBScore["responseBody"]["policyNumber"]);
                                string iibScore = Convert.ToString(JResponceIIBScore["responseBody"]["iibScore"]);

                                IIBRiskScore = iibScore;
                            }
                            // Insert Logs
                            INSERTIIBRiskScoreLog(Type, "GetIIBScore", AppNo, inputIIBScoreJson, Convert.ToString(JResponceIIBScore), IIBRiskScore, ResponseMessage, UserID, EventInvokedBy);

                            // Update IIB Risk Score
                            UpdateIIBRiskScore(Type, AppNo, inputIIBScoreJson, Convert.ToString(JResponceIIBScore), IIBRiskScore, UserID, EventInvokedBy);
                        }
                        catch (System.Net.WebException ex)
                        {
                            // Insert Logs
                            INSERTIIBRiskScoreLog(Type, "GetIIBScore", AppNo, inputIIBScoreJson, Convert.ToString(JResponceIIBScore), IIBRiskScore, ex.ToString(), UserID, EventInvokedBy);
                        }
                    }
                    else
                    {
                        // Insert Logs
                        INSERTIIBRiskScoreLog(Type, "GetIIBScore", AppNo, "", "", IIBRiskScore, "Request Details not found against this Application", UserID, EventInvokedBy);
                    }
                }
                // Get IIB Risk Score - End
            }
            catch (Exception ex)
            {
                // Insert Logs
                INSERTIIBRiskScoreLog(Type, "GetIIBScore", AppNo, "", "", IIBRiskScore, ex.ToString(), UserID, EventInvokedBy);
            }
        }
        return IIBRiskScore;
    }

    public void INSERTIIBRiskScoreLog(string Source, string Method, string ApplicationNo, string Request, string Response,
                                    string IIBRiskScore, string ErrorMsg, string CreatedUserID, string EventInvokedBy)
    {
        Logger.Info(ApplicationNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :INSERTIIBRiskScoreLog");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[9];
            _sqlparam[0] = new SqlParameter("@Source", Source);
            _sqlparam[1] = new SqlParameter("@Method", Method);
            _sqlparam[2] = new SqlParameter("@ApplicationNo", ApplicationNo);
            _sqlparam[3] = new SqlParameter("@Request", Request);
            _sqlparam[4] = new SqlParameter("@Response", Response);
            _sqlparam[5] = new SqlParameter("@IIBRiskScore", IIBRiskScore);
            _sqlparam[6] = new SqlParameter("@ErrorMsg", ErrorMsg);
            _sqlparam[7] = new SqlParameter("@CreatedUserID", CreatedUserID);
            _sqlparam[8] = new SqlParameter("@EventInvokedBy", EventInvokedBy);
            objSql.Insertrecord("LF_INSERT_IIBRiskScore_Log", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(ApplicationNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :INSERTIIBRiskScoreLog");
            SaveErrorLogs(ApplicationNo, "Failed", "UWSaralDecision", "Commfun.cs", "INSERTIIBRiskScoreLog", "E-Error", "", "", Error.ToString());
        }
    }

    public void UpdateIIBRiskScore(string Source, string ApplicationNo, string Request, string Response, string IIBRiskScore, string CreatedUserID, string EventInvokedBy)
    {
        Logger.Info(ApplicationNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :UpdateIIBRiskScore");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[7];
            _sqlparam[0] = new SqlParameter("@Source", Source);
            _sqlparam[1] = new SqlParameter("@ApplicationNo", ApplicationNo);
            _sqlparam[2] = new SqlParameter("@Request", Request);
            _sqlparam[3] = new SqlParameter("@Response", Response);
            _sqlparam[4] = new SqlParameter("@IIBRiskScore", IIBRiskScore);
            _sqlparam[5] = new SqlParameter("@CreatedUserID", CreatedUserID);
            _sqlparam[6] = new SqlParameter("@EventInvokedBy", EventInvokedBy);
             objSql.Insertrecord("LF_Update_IIBRiskScore", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(ApplicationNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :UpdateIIBRiskScore");
            SaveErrorLogs(ApplicationNo, "Failed", "UWSaralDecision", "Commfun.cs", "UpdateIIBRiskScore", "E-Error", "", "", Error.ToString());
        }
    }

    public void GetIIBRiskScoreReqDetails(string ApplicationNo, ref DataSet _ds)
    {
        Logger.Info(ApplicationNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :GetIIBRiskScoreReqDetails");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            _ds = objSql.RetrieveDataset("LF_Get_IIBRiskScoreReqDetails", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(ApplicationNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :GetIIBRiskScoreReqDetails");
            SaveErrorLogs(ApplicationNo, "Failed", "UWSaralDecision", "Commfun.cs", "GetIIBRiskScoreReqDetails", "E-Error", "", "", Error.ToString());
        }
    }
    //31.1 End of Changes; Brijesh Pandey - [MFL00464]

    public void Save_BusinessException(string StrMode, string strApplicationNoStr, bool BussException, string strBpm_userID, ref int resp)
    {
        try
        {
            Logger.Info(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :Save_BusinessException");
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@Mode", StrMode);
            _sqlparam[1] = new SqlParameter("@Appno", strApplicationNoStr);
            //_sqlparam[2] = new SqlParameter("@MedicalReason", ReqReason);
            _sqlparam[2] = new SqlParameter("@BusinessException", BussException);
            _sqlparam[3] = new SqlParameter("@UserId", strBpm_userID);
            resp = objSql.Insertrecord("USP_UWSARAL_SAVE_Country", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strApplicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :Save_BusinessException Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strApplicationNoStr, "Failed", "UWPortfolio", "Commfun.cs", "Save_BusinessException", "E-Error", "", "", Error.ToString());
        }
    }
    //28.1 End

        // Added by Brijesh
    public void Save_StaffDetails(string APP_applicationNoStr, string RelationwithStaff, bool APP_isStaff, string NAWPStatus,string APPType,string bpm_UserID, ref int resp)
    {
        try
        {
            Logger.Info(APP_applicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :Save_StaffDetails");
            SqlParameter[] _sqlparam = new SqlParameter[6];
            _sqlparam[0] = new SqlParameter("@APP_applicationNoStr", APP_applicationNoStr);
            _sqlparam[1] = new SqlParameter("@RelationwithStaff", RelationwithStaff);
            _sqlparam[2] = new SqlParameter("@APP_isStaff", APP_isStaff);
            _sqlparam[3] = new SqlParameter("@NAWPStatus", NAWPStatus);
            _sqlparam[4] = new SqlParameter("@APPType", APPType);
            _sqlparam[5] = new SqlParameter("@bpm_UserID", bpm_UserID);
            resp = objSql.Insertrecord("LF_DEQC_INSERT_StaffDetails", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(APP_applicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :Save_StaffDetails Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(APP_applicationNoStr, "Failed", "UWPortfolio", "Commfun.cs", "Save_StaffDetails", "E-Error", "", "", Error.ToString());
        }
    }
    // End

    //CR-VAPT Start Changes by Shyam Patil
    public void UWREDIRECTDECISION(ref DataSet _ds, string Flag, string qsUserGroup, string qsAppNo, string qsChannelName, string qsPolicyNo, string qsUserLimit, string qsClickBucketLink, string CreatedBy, string TokenNumber)
    {
        try
        {
            Logger.Info(qsAppNo + "STAG 3-L :PageName :Commfun.CS // MethodeName :UWREDIRECTDECISION");
            SqlParameter[] _sqlparam = new SqlParameter[9];
            _sqlparam[0] = new SqlParameter("@Flag", Flag);
            _sqlparam[1] = new SqlParameter("@qsUserGroup", qsUserGroup);
            _sqlparam[2] = new SqlParameter("@qsAppNo", qsAppNo);
            _sqlparam[3] = new SqlParameter("@qsChannelName", qsChannelName);
            _sqlparam[4] = new SqlParameter("@qsPolicyNo", qsPolicyNo);
            _sqlparam[5] = new SqlParameter("@qsUserLimit", qsUserLimit);
            _sqlparam[6] = new SqlParameter("@qsClickBucketLink", qsClickBucketLink);
            _sqlparam[7] = new SqlParameter("@CreatedBy", CreatedBy);
            _sqlparam[8] = new SqlParameter("@TokenNumber", TokenNumber);

            _ds = objSql.RetrieveDataset("USP_UWSaral_REDIRECTDECISION", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(qsAppNo + "STAG 2 :PageName :Commfun.CS // MethodeName :UWREDIRECTDECISION Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(qsAppNo, "Failed", "UWPortfolio", "Commfun.cs", "UWREDIRECTDECISION", "E-Error", "", "", Error.ToString());
        }
    }
    //CR-VAPT End Changes by Shyam Patil

    //32.1 Begin of Changes; Pooja Shetye - [1133038]
    public string GetClientType(string strApplicationNumber)
    {
        string response = string.Empty;
        try
        {

            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :GetClientType");
            _dsAppdtls = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@appno", strApplicationNumber);
            _dsAppdtls = objSql.RetrieveDataset("UST_GetClientMode", _sqlparam);

            if (_dsAppdtls != null && _dsAppdtls.Tables.Count > 0)
            {
                response = _dsAppdtls.Tables[0].Rows[0]["ClientType"].ToString();
            }
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :GetClientType Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "GetClientType", "E-Error", "", "", Error.ToString());
        }
        return response;
    }
    //32.1 End of Changes; Pooja Shetye - [1133038]

    //33.1 Begin of changes CR-30489 kavita mfl00255

    #region 33.1 Begin of changes  CR-30489 kavita mfl00255
    //Added by kavita CR-30489 08/08/2021
    public void SaveIIBLogDetails(string error, string page, string methodname, string status,
           string Request, string Response, string Constr, string source, string ApiDetails,
           string RespCode, string RespMsg, string DataKeyName, string DataKeyValue,string IIBClientType)
    {
        DataSet ds = new DataSet();

        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[14];
            _sqlparam[0] = new SqlParameter("@ActionMethodName", methodname);
            _sqlparam[1] = new SqlParameter("@ErrorDescription", error);
            _sqlparam[2] = new SqlParameter("@Pagename", page);
            _sqlparam[3] = new SqlParameter("@ErrorLineNo", string.Empty);
            _sqlparam[4] = new SqlParameter("@Request", Request);
            _sqlparam[5] = new SqlParameter("@Response", Response);
            _sqlparam[6] = new SqlParameter("@Status", status);
            _sqlparam[7] = new SqlParameter("@Source", source);
            _sqlparam[8] = new SqlParameter("@APIDetails", ApiDetails);
            _sqlparam[9] = new SqlParameter("@ResponseCode", RespCode);
            _sqlparam[10] = new SqlParameter("@ResponseMessage", RespMsg);
            _sqlparam[11] = new SqlParameter("@DataKeyName", DataKeyName);
            _sqlparam[12] = new SqlParameter("@DataKeyValue", DataKeyValue);
            _sqlparam[13] = new SqlParameter("@Client_Type", IIBClientType);
            //  string strLog = dpLookupSingleItem(DBString("CON_transactiondbLF"), "IIBMatchSchedular_ErrorLog", _sqlparam);
            ds = objSql.RetrieveDataset("IIBMatchSchedular_ErrorLog", _sqlparam);

        }
        catch (Exception ex)
        {
            throw ex;
        }
        finally
        {

        }
    }


    public void UpdatelogDetails(string ClientID, string ApplicationNo)
    {
        DataSet ds = new DataSet();
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@ClientID", ClientID);
            _sqlparam[1] = new SqlParameter("@ApplicationNo", ApplicationNo);

            //  string strLog = dpLookupSingleItem(DBString("CON_transactiondbLF"), "IIBMatchSchedular_UpdateIIBMatchFlag", _sqlparam);
            ds = objSql.RetrieveDataset("IIBMatchSchedular_UpdateIIBMatchFlag", _sqlparam);

        }
        catch (Exception ex)
        {
            throw ex;
            //IIBDBEngine.SaveErrorLog(ex.Message, "IIBDBEngine", "Fail", "SaveIIBLogDetails", ex.StackTrace.ToString(), Constr);
        }
        finally
        {

        }


    }

    public DataSet FetchReqData(string strFirstname, string strnSurname,
           string strDob, string strGender, string strStatus, string strPincode,
           string strAdharcard, string strPanNo, string strDataKeyValue, string Phoneno, string EmailId)
    {
        DataSet ds1 = new DataSet();
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[10];

            _sqlparam[0] = new SqlParameter("@Firstname", strFirstname);
            _sqlparam[1] = new SqlParameter("@Surname", strnSurname);
            _sqlparam[2] = new SqlParameter("@Dob", strDob);
            _sqlparam[3] = new SqlParameter("@Gender", strGender);
            _sqlparam[4] = new SqlParameter("@Status", strStatus);
            _sqlparam[5] = new SqlParameter("@Pincode", strPincode);
            _sqlparam[6] = new SqlParameter("@Aadharcard", strAdharcard);
            _sqlparam[7] = new SqlParameter("@PANNo", strPanNo);
            _sqlparam[8] = new SqlParameter("@DataKeyValue", strDataKeyValue);
            _sqlparam[9] = new SqlParameter("@EmailId", EmailId);

            ds1 = objSql.RetrieveDataset("USPIIBFetchRequestData", _sqlparam);
        }
        catch (Exception ex)
        {
            throw ex;
            //IIBDBEngine.SaveErrorLog(ex.Message, "IIBDBEngine", "Fail", "SaveInputOutputLog", ex.StackTrace.ToString(), Constr);
        }
        return ds1;
    }


    public void InsertIIBLogDetails(IIBRequest objiibRequest, IIBResponse objiibResp, string ClientType, string ReqJson, string Userid)
    {
        DataSet ds1 = new DataSet();
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[24];
            _sqlparam[0] = new SqlParameter("@DataKeyName", objiibRequest.DataKeyName);
            _sqlparam[1] = new SqlParameter("@DataKeyValue", objiibRequest.DataKeyValue);
            _sqlparam[2] = new SqlParameter("@Firstname", objiibRequest.FirstName);
            _sqlparam[3] = new SqlParameter("@Surname", objiibRequest.SurName);
            _sqlparam[4] = new SqlParameter("@Dob", objiibRequest.DOB);
            _sqlparam[5] = new SqlParameter("@Gender", objiibRequest.Gender);
            _sqlparam[6] = new SqlParameter("@Status", objiibResp.Status);
            _sqlparam[7] = new SqlParameter("@Pincode", objiibRequest.PinCode);
            _sqlparam[8] = new SqlParameter("@Aadharcard", objiibRequest.AadharCard);
            _sqlparam[9] = new SqlParameter("@PANNo", objiibRequest.PanNo);
            _sqlparam[10] = new SqlParameter("@EmailId", objiibRequest.Email_1);
            _sqlparam[11] = new SqlParameter("@ClientType", ClientType);
            _sqlparam[12] = new SqlParameter("@Source", objiibRequest.Source);
            //_sqlparam[13] = new SqlParameter("@Status", objiibRequest.);
            _sqlparam[13] = new SqlParameter("@ResponseCode", objiibResp.ResponseCode);
            _sqlparam[14] = new SqlParameter("@ResponseMessage", objiibResp.ResponseMessage);
            _sqlparam[15] = new SqlParameter("@IIBResponseLA", objiibResp.IIBResponseLA);
            _sqlparam[16] = new SqlParameter("@Remarks", objiibResp.Remarks);
            _sqlparam[17] = new SqlParameter("@DecodedString1", objiibResp.DecodedString1);
            _sqlparam[18] = new SqlParameter("@CreatedBy", Userid);
            _sqlparam[19] = new SqlParameter("@UpdatedBy", Userid);
            _sqlparam[20] = new SqlParameter("@Error", objiibResp.Error);
            _sqlparam[21] = new SqlParameter("@IIBRequestJSON", ReqJson);
            _sqlparam[22] = new SqlParameter("@ProductCode", objiibRequest.ProductCode);
            _sqlparam[23] = new SqlParameter("@Annual_Income", objiibRequest.Annual_Income);

            objSql.RetrieveDataset("USP_IIBRequestSave", _sqlparam);
        }
        catch (Exception ex)
        {
            throw ex;
            //IIBDBEngine.SaveErrorLog(ex.Message, "IIBDBEngine", "Fail", "SaveInputOutputLog", ex.StackTrace.ToString(), Constr);
        }

    }
     

    public DataSet getFGDataShow_Impact(string ApplicationNo, string CreatedBy)
    {
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@Input_Proposal_Policy_No", ApplicationNo);
            _sqlparam[1] = new SqlParameter("@CreatedBy", CreatedBy);
            ds = objSql.RetrieveDataset("usp_GetFGData_Impact", _sqlparam);
            return ds;
        }
        catch (Exception)
        {

            throw;
        }

    }

   
    public DataSet IIBQueryData_Impact(DataTable dt)
    {
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@dt", dt);
            #region Start 38.1: This CR-2809 changes done by Sushant Devkate MFL00905 
            //ds = objSql.RetrieveDataset("usp_SaveIIBQueryData_Impact", _sqlparam);
            ds = objSql.RetrieveDataset("Usp_UWSaralSaveIIBQueryData_Impact", _sqlparam);
            #endregion End 38.1: This CR-2809 changes done by Sushant Devkate MFL00905 
            return ds;
        }
        catch (Exception ex)
        {

            throw ex;
        }

    }
    //Added by kavita CR-30489 08/08/2021
    #endregion 33.1 Begin of changes CR-30489 kavita mfl00255

    // 33.1 End of changes CR-30489 kavita mfl00255
    /*added by Suraj on 03 JAN 22 to update status to pending*/
    public void PendingStatus(string strAppno, ref int intRet)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :BAL.CS // MethodeName :PendingStatus");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@Appno", strAppno);
            objSql.Insertrecord("USP_UWSARAL_COMBI_PENDING_MOVE", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :BAL.CS // MethodeName :PendingStatus Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWAutoIssuence", "BAL.CS", "PendingStatus", "E-Error", "", "", Error.ToString());
        }
    }
    //34.1Start of changes: Sagar Thorave[MFL00886] CR- 30573
    public void InsertPolicyRiskFlagErrorLogs(string UserId, string strerror)
    {
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@UserID", UserId);
            _sqlparam[1] = new SqlParameter("@ErrorMsg", strerror);
            objSql.Insertrecord("Sp_InsertPolicyRiskFlag_Errorlog", _sqlparam);
        }
        catch (Exception Error)
        {
            string msg = Error.Message;
        }
    }
    //34.1 End of changes: Sagar Thorave[MFL00886] CR- 30573

    public void SBFreq_Save( string strapplicationNumber, string strpayoutfreq, ref int PolResult)
    {
        try
        {
            Logger.Info(strapplicationNumber + "STAG 2 :PageName :Commfun.CS // MethodeName :SBFreq_Save");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            
            _sqlparam[0] = new SqlParameter("@AppNo", strapplicationNumber);
            _sqlparam[1] = new SqlParameter("@PayoutFreq", strpayoutfreq);
            //_sqlparam[2] = new SqlParameter("@Category", strcategory);
            PolResult = objSql.Insertrecord("USP_UWSARAL_SBFREQ_SAVE", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strapplicationNumber + "STAG 2 :PageName :Commfun.CS // MethodeName :SBFreq_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strapplicationNumber, "Failed", "UWPortfolio", "Commfun.cs", "SBFreq_Save", "E-Error", "", "", Error.ToString());
        }
    }

    //4.1 Begin of changes by kavita -CR-30489 Phase 2
    public void GetChecklistReport(string AppNo, ref DataSet _ds)
    {
        SqlParameter[] sqlparams = new SqlParameter[1];
        try
        {
            //sqlparams[0] = new SqlParameter("@AppNo", AppNo);
            sqlparams[0] = new SqlParameter("@AppNo", AppNo);
            _ds = objSql.RetrieveDataset("Usp_UWSaralViewChecklist", sqlparams);

        }
        catch (Exception ex)
        {
            throw ex;
        }
    }
    //4.1 End of changes by kavita -CR-30489 Phase 2
    //38.1 Begin of Changes; Sagar Thorave-[mfl00886]
    public void Featch_AMLFLAG_Details(ref DataSet _ds, string applicationNo, String Source)
    {

        SqlParameter[] _sqlparam = new SqlParameter[2];
        try
        {
            _sqlparam[0] = new SqlParameter("@AppNo", applicationNo);
            _sqlparam[1] = new SqlParameter("@Source", Source);
            _ds = objSql.RetrieveDataset("USP_FetchAMLRisk_Details", _sqlparam);

        }
        catch (Exception ex)
        {
            throw ex;
        }
    }
    public void Featch_AMLFLAG_Details_Payer(ref DataSet _ds, string applicationNo, String Source)
    {
        SqlParameter[] sqlparams = new SqlParameter[2];
        try
        {
            sqlparams[0] = new SqlParameter("@AppNo", applicationNo);
            sqlparams[1] = new SqlParameter("@Source", Source);
            _ds = objSql.RetrieveDataset("USP_FetchAMLRisk_Details_Payer", sqlparams);

        }
        catch (Exception ex)
        {
            throw ex;
        }
    }
    public void Featch_AMLFLAG_Details_Proposar(ref DataSet _ds, string applicationNo, String Source)
    {
        SqlParameter[] sqlparams = new SqlParameter[2];
        try
        {
            sqlparams[0] = new SqlParameter("@AppNo", applicationNo);
            sqlparams[1] = new SqlParameter("@Source", Source);
            _ds = objSql.RetrieveDataset("USP_FetchAMLRisk_Details_Proposer", sqlparams);

        }
        catch (Exception ex)
        {
            throw ex;
        }
    }
    public int Insert_AMLFLAG_Details(string appno, string AmlValue, string AmlCLNTRSKIND, string AmlReason, string source)
    {
        SqlParameter[] sqlparams = new SqlParameter[5];
        try
        {
            sqlparams[0] = new SqlParameter("@AppNo", appno);
            sqlparams[1] = new SqlParameter("@AmlValue", AmlValue);
            sqlparams[2] = new SqlParameter("@Source", source);
            sqlparams[3] = new SqlParameter("@AmlCLNTRSKIND", AmlCLNTRSKIND);
            sqlparams[4] = new SqlParameter("@AmlReason", AmlReason);
            int i = objSql.Insertrecord("USP_Insert_AMLFLAG_Details", sqlparams);
            return i;
        }
        catch (Exception ex)
        {
            return 0;

        }
    }
    public int Insert_AMLFLAG_Details_Propser(string appno, string AmlValue, string AmlCLNTRSKIND, string AmlReason, string source)
    {
        SqlParameter[] sqlparams = new SqlParameter[5];
        try
        {
            sqlparams[0] = new SqlParameter("@AppNo", appno);
            sqlparams[1] = new SqlParameter("@AmlValue", AmlValue);
            sqlparams[2] = new SqlParameter("@Source", source);
            sqlparams[3] = new SqlParameter("@AmlCLNTRSKIND", AmlCLNTRSKIND);
            sqlparams[4] = new SqlParameter("@AmlReason", AmlReason);
            int i = objSql.Insertrecord("USP_Insert_AMLFLAG_Details_Proposer", sqlparams);
            return i;
        }
        catch (Exception ex)
        {
            return 0;

        }
    }
    //38.1 End of Changes; Sagar Thorave-[mfl00886]


    #region 35.1 start : CR-30363-Add and Delete Negative Pincode functionality changes by Sushant Devkate [MFL00905]
    #region Add Negative Pincode 
    public int InsertPinCode(PinCodeDO ObjPinCode)
    {
        int Result = 0;
        try
        {

            SqlParameter[] _sqlparam = new SqlParameter[11];
            _sqlparam[0] = new SqlParameter("@CircleName", ObjPinCode.CircleName);
            _sqlparam[1] = new SqlParameter("@RegionName", ObjPinCode.RegionName);
            _sqlparam[2] = new SqlParameter("@DivisionName", ObjPinCode.DivisionName);
            _sqlparam[3] = new SqlParameter("@OfficeName", ObjPinCode.OfficeName);
            _sqlparam[4] = new SqlParameter("@PinCode", ObjPinCode.PinCode);
            _sqlparam[5] = new SqlParameter("@OfficeType", ObjPinCode.OfficeType);
            _sqlparam[6] = new SqlParameter("@District", ObjPinCode.District);
            _sqlparam[7] = new SqlParameter("@StateName", ObjPinCode.StateName);
            _sqlparam[8] = new SqlParameter("@Delivery", ObjPinCode.Delivery);
            _sqlparam[9] = new SqlParameter("@Remarks", ObjPinCode.Remarks);
            _sqlparam[10] = new SqlParameter("@UserId", ObjPinCode.UserId);
            Result = objSql.Insertrecord("Usp_InsertNeagativePincode", _sqlparam);
        }
        catch (Exception ex)
        {

            throw ex;
        }
        return Result;
    }
    #endregion
    #region Delete pincode
    public int DeletePinCode(int Id, string UserId)
    {
        int Result = 0;
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@Id", Id);
            _sqlparam[1] = new SqlParameter("@UserId", UserId);
            Result = objSql.DeleteRecord("Usp_DeleteNeagativePincode", _sqlparam);
        }
        catch (Exception ex)
        {
        }
        return Result;
    }

    #endregion
    #region Search by pincode 
    public DataSet GetSearchByPincode(string Pincode)
    {
        DataSet ds = new DataSet();
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@PinCode", Pincode);
            ds = objSql.RetrieveDataset("Usp_GetSearchbyPincode", _sqlparam);
        }
        catch (Exception Error)
        {

        }
        return ds;
    }
    #endregion

    #endregion 35.1 End: CR-30363-Add and Delete Negative Pincode functionality changes by Sushant Devkate [MFL00905]

    #region start: This CR-2639 changes done by Sushant Devkate MFL00905 
    public DataSet GetFSARofLA(string ApplicationNo)
    {
        DataSet ds = new DataSet();
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            ds = objSql.RetrieveDataset("Usp_GetFSARofLAbyAppNo", _sqlparam);
        }
        catch (Exception Error)
        {

        }
        return ds;
    }
    #endregion End: This CR-2639 changes done by Sushant Devkate MFL00905 


    #region Start 37.1: This CR-2809 changes done by Sushant Devkate MFL00905 
    #region Get IIB Policy details for DE created
    public IIBQueryDataDO getFGDataShowDE_new(string ApplicationNo, string CreatedBy)
    {
        IIBQueryDataDO ObjIIBQueryDataDO = new IIBQueryDataDO();
        try
        {
            DataSet ds = new DataSet();

            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@Input_Proposal_Policy_No", ApplicationNo);
            _sqlparam[1] = new SqlParameter("@CreatedBy", CreatedBy);
            ds = objSql.RetrieveDataset("usp_UWSaralGetIIBFGDataDE", _sqlparam);

            if (ds.Tables.Count > 0)
            {
                if (ds.Tables[0] != null)
                {
                    if (ds.Tables[0].Rows.Count > 0)
                    {
                        for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
                        {
                            IIBQueryDO ObjIIBQuery = new IIBQueryDO();
                            ObjIIBQuery.Input_Proposal_Policy_No = Utility.Getstring(ds.Tables[0].Rows[i]["Input_Proposal_Policy_No"]);
                            ObjIIBQuery.QuestDBNo = Utility.Getstring(ds.Tables[0].Rows[i]["QuestDBNo"]);
                            ObjIIBQuery.Input_Matching_Parameter = Utility.Getstring(ds.Tables[0].Rows[i]["Input_Matching_Parameter"]);
                            ObjIIBQuery.Quest_DoP_DoC = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_DoP_DoC"]);
                            ObjIIBQuery.Quest_Sum_Assured = Utility.GetDecimal(ds.Tables[0].Rows[i]["Quest_Sum_Assured"]);
                            ObjIIBQuery.Quest_Policy_Status = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Policy_Status"]);
                            ObjIIBQuery.Quest_Date_of_Exit = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Date_of_Exit"]);
                            ObjIIBQuery.Quest_Date_of_Death = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Date_of_Death"]);
                            ObjIIBQuery.Quest_Cause_of_Death = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Cause_of_Death"]);
                            ObjIIBQuery.Quest_Record_last_updated = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Record_last_updated"]);
                            ObjIIBQuery.Quest_Entity_Caution_Status = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Entity_Caution_Status"]);
                            ObjIIBQuery.Quest_Intermediary_Caution_Status = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Intermediary_Caution_Status"]);
                            ObjIIBQuery.Quest_Company_Number = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Company_Number"]);
                            ObjIIBQuery.Is_Negative_Match = Utility.Getstring(ds.Tables[0].Rows[i]["Is_Negative_Match"]);
                            ObjIIBQuery.LAProposerPayor = Utility.Getstring(ds.Tables[0].Rows[i]["LAProposerPayor"]);
                            ObjIIBQuery.Status = Utility.Getstring(ds.Tables[0].Rows[i]["Status"]);
                            ObjIIBQuery.Impact = Utility.Getstring(ds.Tables[0].Rows[i]["Impact"]);
                            ObjIIBQuery.Product_Type = Utility.Getstring(ds.Tables[0].Rows[i]["Product_Type"]);
                            ObjIIBQuery.Linked_Non_linked = Utility.Getstring(ds.Tables[0].Rows[i]["Linked_Non_linked"]);
                            ObjIIBQuery.Medical_NonMedical = Utility.Getstring(ds.Tables[0].Rows[i]["Medical_NonMedical"]);
                            ObjIIBQuery.Whether_Standard_Life = Utility.Getstring(ds.Tables[0].Rows[i]["Whether_Standard_Life"]);
                            ObjIIBQuery.Reason_for_Decline = Utility.Getstring(ds.Tables[0].Rows[i]["Reason_for_Decline"]);
                            ObjIIBQuery.Reason_for_Postpone = Utility.Getstring(ds.Tables[0].Rows[i]["Reason_for_Postpone"]);
                            ObjIIBQuery.Reason_for_Repudiation = Utility.Getstring(ds.Tables[0].Rows[i]["Reason_for_Repudiation"]);
                            ObjIIBQuery.Client_Type = string.IsNullOrEmpty(Utility.Getstring(ds.Tables[0].Rows[i]["Client_Type"])) ? "LA" : Utility.Getstring(ds.Tables[0].Rows[i]["Client_Type"]);
                            ObjIIBQuery.RolesType = GetPreviousPolicyClientType(ObjIIBQuery.QuestDBNo, string.Empty);
                            ObjIIBQueryDataDO.ObjListOFQueryFG.Add(ObjIIBQuery);
                        }


                    }
                }

                if (ds.Tables[1] != null)
                {
                    if (ds.Tables[1].Rows.Count > 0)
                    {
                        for (int i = 0; i < ds.Tables[1].Rows.Count; i++)
                        {
                            IIBQueryDO ObjIIBQuery = new IIBQueryDO();

                            ObjIIBQuery.Input_Proposal_Policy_No = Utility.Getstring(ds.Tables[1].Rows[i]["Input_Proposal_Policy_No"]);
                            ObjIIBQuery.QuestDBNo = Utility.Getstring(ds.Tables[1].Rows[i]["QuestDBNo"]);
                            ObjIIBQuery.Input_Matching_Parameter = Utility.Getstring(ds.Tables[1].Rows[i]["Input_Matching_Parameter"]);
                            ObjIIBQuery.Quest_DoP_DoC = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_DoP_DoC"]);
                            ObjIIBQuery.Quest_Sum_Assured = Utility.GetDecimal(ds.Tables[1].Rows[i]["Quest_Sum_Assured"]);
                            ObjIIBQuery.Quest_Policy_Status = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Policy_Status"]);
                            ObjIIBQuery.Quest_Date_of_Exit = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Date_of_Exit"]);
                            ObjIIBQuery.Quest_Date_of_Death = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Date_of_Death"]);
                            ObjIIBQuery.Quest_Cause_of_Death = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Cause_of_Death"]);
                            ObjIIBQuery.Quest_Record_last_updated = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Record_last_updated"]);
                            ObjIIBQuery.Quest_Entity_Caution_Status = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Entity_Caution_Status"]);
                            ObjIIBQuery.Quest_Intermediary_Caution_Status = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Intermediary_Caution_Status"]);
                            ObjIIBQuery.Quest_Company_Number = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Company_Number"]);
                            ObjIIBQuery.Is_Negative_Match = Utility.Getstring(ds.Tables[1].Rows[i]["Is_Negative_Match"]);
                            ObjIIBQuery.LAProposerPayor = Utility.Getstring(ds.Tables[1].Rows[i]["LAProposerPayor"]);
                            ObjIIBQuery.Status = Utility.Getstring(ds.Tables[1].Rows[i]["Status"]);
                            ObjIIBQuery.Impact = Utility.Getstring(ds.Tables[1].Rows[i]["Impact"]);
                            ObjIIBQuery.Product_Type = Utility.Getstring(ds.Tables[1].Rows[i]["Product_Type"]);
                            ObjIIBQuery.Linked_Non_linked = Utility.Getstring(ds.Tables[1].Rows[i]["Linked_Non_linked"]);
                            ObjIIBQuery.Medical_NonMedical = Utility.Getstring(ds.Tables[1].Rows[i]["Medical_NonMedical"]);
                            ObjIIBQuery.Whether_Standard_Life = Utility.Getstring(ds.Tables[1].Rows[i]["Whether_Standard_Life"]);
                            ObjIIBQuery.Reason_for_Decline = Utility.Getstring(ds.Tables[1].Rows[i]["Reason_for_Decline"]);
                            ObjIIBQuery.Reason_for_Postpone = Utility.Getstring(ds.Tables[1].Rows[i]["Reason_for_Postpone"]);
                            ObjIIBQuery.Reason_for_Repudiation = Utility.Getstring(ds.Tables[1].Rows[i]["Reason_for_Repudiation"]);
                            ObjIIBQuery.Client_Type = string.IsNullOrEmpty(Utility.Getstring(ds.Tables[1].Rows[i]["Client_Type"])) ? "LA" : Utility.Getstring(ds.Tables[1].Rows[i]["Client_Type"]);
                            ObjIIBQuery.RolesType = Utility.Getstring(ds.Tables[1].Rows[i]["RolesType"]);


                            ObjIIBQueryDataDO.ObjListOFQueryOther.Add(ObjIIBQuery);
                        }
                    }
                }


            }

        }

        catch (Exception ex)
        {

        }
        return ObjIIBQueryDataDO;

    }
    #endregion

    #region Get IIB Policy details for UW created
    public IIBQueryDataDO getFGDataShow_Impact_New(string ApplicationNo, string CreatedBy)
    {
        IIBQueryDataDO ObjIIBQueryDataDO = new IIBQueryDataDO();
        try
        {
            DataSet ds = new DataSet();

            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@Input_Proposal_Policy_No", ApplicationNo);
            _sqlparam[1] = new SqlParameter("@CreatedBy", CreatedBy);
            ds = objSql.RetrieveDataset("usp_UWSaralGetIIBFGData_Impact", _sqlparam);

            if (ds.Tables.Count > 0)
            {
                #region only FGILI Policy data
                if (ds.Tables[0] != null)
                {

                    if (ds.Tables[0].Rows.Count > 0)
                    {
                        for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
                        {
                            IIBQueryDO ObjIIBQuery = new IIBQueryDO();
                            ObjIIBQuery.Input_Proposal_Policy_No = Utility.Getstring(ds.Tables[0].Rows[i]["Input_Proposal_Policy_No"]);
                            ObjIIBQuery.QuestDBNo = Utility.Getstring(ds.Tables[0].Rows[i]["QuestDBNo"]);
                            ObjIIBQuery.Input_Matching_Parameter = Utility.Getstring(ds.Tables[0].Rows[i]["Input_Matching_Parameter"]);
                            ObjIIBQuery.Quest_DoP_DoC = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_DoP_DoC"]);
                            ObjIIBQuery.Quest_Sum_Assured = Utility.GetDecimal(ds.Tables[0].Rows[i]["Quest_Sum_Assured"]);
                            ObjIIBQuery.Quest_Policy_Status = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Policy_Status"]);
                            ObjIIBQuery.Quest_Date_of_Exit = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Date_of_Exit"]);
                            ObjIIBQuery.Quest_Date_of_Death = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Date_of_Death"]);
                            ObjIIBQuery.Quest_Cause_of_Death = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Cause_of_Death"]);
                            ObjIIBQuery.Quest_Record_last_updated = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Record_last_updated"]);
                            ObjIIBQuery.Quest_Entity_Caution_Status = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Entity_Caution_Status"]);
                            ObjIIBQuery.Quest_Intermediary_Caution_Status = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Intermediary_Caution_Status"]);
                            ObjIIBQuery.Quest_Company_Number = Utility.Getstring(ds.Tables[0].Rows[i]["Quest_Company_Number"]);
                            ObjIIBQuery.Is_Negative_Match = Utility.Getstring(ds.Tables[0].Rows[i]["Is_Negative_Match"]);
                            ObjIIBQuery.LAProposerPayor = Utility.Getstring(ds.Tables[0].Rows[i]["LAProposerPayor"]);
                            ObjIIBQuery.Status = Utility.Getstring(ds.Tables[0].Rows[i]["Status"]);
                            ObjIIBQuery.Impact = Utility.Getstring(ds.Tables[0].Rows[i]["Impact"]);
                            ObjIIBQuery.Product_Type = Utility.Getstring(ds.Tables[0].Rows[i]["Product_Type"]);
                            ObjIIBQuery.Linked_Non_linked = Utility.Getstring(ds.Tables[0].Rows[i]["Linked_Non_linked"]);
                            ObjIIBQuery.Medical_NonMedical = Utility.Getstring(ds.Tables[0].Rows[i]["Medical_NonMedical"]);
                            ObjIIBQuery.Whether_Standard_Life = Utility.Getstring(ds.Tables[0].Rows[i]["Whether_Standard_Life"]);
                            ObjIIBQuery.Reason_for_Decline = Utility.Getstring(ds.Tables[0].Rows[i]["Reason_for_Decline"]);
                            ObjIIBQuery.Reason_for_Postpone = Utility.Getstring(ds.Tables[0].Rows[i]["Reason_for_Postpone"]);
                            ObjIIBQuery.Reason_for_Repudiation = Utility.Getstring(ds.Tables[0].Rows[i]["Reason_for_Repudiation"]);
                            ObjIIBQuery.Client_Type = string.IsNullOrEmpty(Utility.Getstring(ds.Tables[0].Rows[i]["Client_Type"])) ? "LA" : Utility.Getstring(ds.Tables[0].Rows[i]["Client_Type"]);
                            ObjIIBQuery.RolesType = string.IsNullOrEmpty(Utility.Getstring(ds.Tables[0].Rows[i]["RolesType"])) ? GetPreviousPolicyClientType(ObjIIBQuery.QuestDBNo, string.Empty) : Utility.Getstring(ds.Tables[0].Rows[i]["RolesType"]);
                            ObjIIBQueryDataDO.ObjListOFQueryFG.Add(ObjIIBQuery);
                        }


                    }
                }

                #endregion
                #region only other than FGILI Policy Bind data
                if (ds.Tables[1] != null)
                {
                    if (ds.Tables[1].Rows.Count > 0)
                    {
                        for (int i = 0; i < ds.Tables[1].Rows.Count; i++)
                        {
                            IIBQueryDO ObjIIBQuery = new IIBQueryDO();

                            ObjIIBQuery.Input_Proposal_Policy_No = Utility.Getstring(ds.Tables[1].Rows[i]["Input_Proposal_Policy_No"]);
                            ObjIIBQuery.QuestDBNo = Utility.Getstring(ds.Tables[1].Rows[i]["QuestDBNo"]);
                            ObjIIBQuery.Input_Matching_Parameter = Utility.Getstring(ds.Tables[1].Rows[i]["Input_Matching_Parameter"]);
                            ObjIIBQuery.Quest_DoP_DoC = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_DoP_DoC"]);
                            ObjIIBQuery.Quest_Sum_Assured = Utility.GetDecimal(ds.Tables[1].Rows[i]["Quest_Sum_Assured"]);
                            ObjIIBQuery.Quest_Policy_Status = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Policy_Status"]);
                            ObjIIBQuery.Quest_Date_of_Exit = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Date_of_Exit"]);
                            ObjIIBQuery.Quest_Date_of_Death = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Date_of_Death"]);
                            ObjIIBQuery.Quest_Cause_of_Death = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Cause_of_Death"]);
                            ObjIIBQuery.Quest_Record_last_updated = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Record_last_updated"]);
                            ObjIIBQuery.Quest_Entity_Caution_Status = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Entity_Caution_Status"]);
                            ObjIIBQuery.Quest_Intermediary_Caution_Status = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Intermediary_Caution_Status"]);
                            ObjIIBQuery.Quest_Company_Number = Utility.Getstring(ds.Tables[1].Rows[i]["Quest_Company_Number"]);
                            ObjIIBQuery.Is_Negative_Match = Utility.Getstring(ds.Tables[1].Rows[i]["Is_Negative_Match"]);
                            ObjIIBQuery.LAProposerPayor = Utility.Getstring(ds.Tables[1].Rows[i]["LAProposerPayor"]);
                            ObjIIBQuery.Status = Utility.Getstring(ds.Tables[1].Rows[i]["Status"]);
                            ObjIIBQuery.Impact = Utility.Getstring(ds.Tables[1].Rows[i]["Impact"]);
                            ObjIIBQuery.Product_Type = Utility.Getstring(ds.Tables[1].Rows[i]["Product_Type"]);
                            ObjIIBQuery.Linked_Non_linked = Utility.Getstring(ds.Tables[1].Rows[i]["Linked_Non_linked"]);
                            ObjIIBQuery.Medical_NonMedical = Utility.Getstring(ds.Tables[1].Rows[i]["Medical_NonMedical"]);
                            ObjIIBQuery.Whether_Standard_Life = Utility.Getstring(ds.Tables[1].Rows[i]["Whether_Standard_Life"]);
                            ObjIIBQuery.Reason_for_Decline = Utility.Getstring(ds.Tables[1].Rows[i]["Reason_for_Decline"]);
                            ObjIIBQuery.Reason_for_Postpone = Utility.Getstring(ds.Tables[1].Rows[i]["Reason_for_Postpone"]);
                            ObjIIBQuery.Reason_for_Repudiation = Utility.Getstring(ds.Tables[1].Rows[i]["Reason_for_Repudiation"]);
                            ObjIIBQuery.Client_Type = string.IsNullOrEmpty(Utility.Getstring(ds.Tables[1].Rows[i]["Client_Type"])) ? "LA" : Utility.Getstring(ds.Tables[1].Rows[i]["Client_Type"]);
                            ObjIIBQuery.RolesType = Utility.Getstring(ds.Tables[1].Rows[i]["RolesType"]);
                            ObjIIBQueryDataDO.ObjListOFQueryOther.Add(ObjIIBQuery);
                        }
                    }
                }
                #endregion

            }

        }
        catch (Exception ex)
        {

        }

        return ObjIIBQueryDataDO;
    }

    #endregion
    #region Get roles 
    public string GetPreviousPolicyClientType(string PreviousPolicyNo, string FirstName)
    {
        List<PreviousPolicyDO> ObjListPrevPolicyDetailsDO = new List<PreviousPolicyDO>();
        string RoleType = string.Empty;
        DataSet ds = new DataSet();
        try
        {

            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PreviousPolicyNo", PreviousPolicyNo);
            _sqlparam[1] = new SqlParameter("@FistName", FirstName);
            ds = objSql.RetrieveDataset("Usp_GetUWSaralPreviousPolicyType", _sqlparam);

            if (ds.Tables.Count > 0)
            {
                if (ds.Tables[0].Rows.Count > 0)
                {
                    for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
                    {
                        PreviousPolicyDO ObjPreviousPolicyDO = new PreviousPolicyDO();
                        ObjPreviousPolicyDO.ApplicationNo = Utility.Getstring(ds.Tables[0].Rows[i]["ApplicationNo"]);
                        ObjPreviousPolicyDO.FirstName = Utility.Getstring(ds.Tables[0].Rows[i]["FistName"]);
                        ObjPreviousPolicyDO.ClientRoleType = Utility.Getstring(ds.Tables[0].Rows[i]["ClientassuredType"]);
                        ObjListPrevPolicyDetailsDO.Add(ObjPreviousPolicyDO);
                    }
                }

                if (ObjListPrevPolicyDetailsDO.Count > 0)
                {

                    RoleType = string.Join("/", (ObjListPrevPolicyDetailsDO.Select(x => x.ClientRoleType != "" ? x.ClientRoleType : "")));

                }
            }


        }
        catch (Exception ex)
        {

        }

        return RoleType;
    }

    #endregion
    #region Get Policy Holder Details 
    public List<CoustomerDO> GetIIBPolicyHolderData(string applicationno)
    {
        List<CoustomerDO> OBjlistCoustomerDO = new List<CoustomerDO>();
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@CLT_applicationNo", applicationno);
            ds = objSql.RetrieveDataset("usp_GetUWIIBData", _sqlparam);
            if (ds.Tables.Count > 0)
            {
                if (ds.Tables[0].Rows.Count > 0)
                {
                    for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
                    {
                        CoustomerDO ObjCoustomerDODO = new CoustomerDO();
                        ObjCoustomerDODO.ApplicationNo = Utility.Getstring(ds.Tables[0].Rows[i]["CLT_applicationNo"]);
                        ObjCoustomerDODO.ClientType = Utility.Getstring(ds.Tables[0].Rows[i]["CLT_assuredType"]);
                        ObjCoustomerDODO.FirstName = Utility.Getstring(ds.Tables[0].Rows[i]["CLT_firstName_LGIVNAME"]);
                        ObjCoustomerDODO.SurName = Utility.Getstring(ds.Tables[0].Rows[i]["CLT_lastName_LSURNAME"]);
                        ObjCoustomerDODO.DOB = Utility.GetDatatime(ds.Tables[0].Rows[i]["CLT_dob_CLTDOBX"]).ToString("yyyy-MM-dd");
                        ObjCoustomerDODO.Gender = Utility.Getstring(ds.Tables[0].Rows[i]["CLT_gender_CLTSEX"]);
                        ObjCoustomerDODO.PinCode = Utility.Getstring(ds.Tables[0].Rows[i]["ADR_pinCode_CLTPCODE"]);
                        ObjCoustomerDODO.PanNo = Utility.Getstring(ds.Tables[0].Rows[i]["CLT_panId_RTAXIDNUM"]);
                        ObjCoustomerDODO.Address = Utility.Getstring(ds.Tables[0].Rows[i]["LA_Current_Address"]);
                        ObjCoustomerDODO.MobileNo = Utility.Getstring(ds.Tables[0].Rows[i]["ADR_mobileNo_MBLPHONE"]);
                        ObjCoustomerDODO.PhoneNumber = Utility.Getstring(ds.Tables[0].Rows[i]["ADR_phone1_CLTPHONE01"]);
                        ObjCoustomerDODO.Email = Utility.Getstring(ds.Tables[0].Rows[i]["ADR_emailId_RINTERNET"]);
                        ObjCoustomerDODO.ProductCode = Utility.Getstring(ds.Tables[0].Rows[i]["ProductCode"]);
                        ObjCoustomerDODO.AnnualIncome = Utility.Getstring(ds.Tables[0].Rows[i]["AnnualIncome"]);

                        OBjlistCoustomerDO.Add(ObjCoustomerDODO);
                    }
                }

            }

        }
        catch (Exception ex)
        {

        }

        return OBjlistCoustomerDO;
    }
    #endregion


    #region Get IIB Enquiry Details

    #region IIBEnquireyRequest
    public void InsertIIBEnquireyRequestDetails(IIBEnquiryRequestDO objiibRequest, string Userid)
    {

        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[16];
            _sqlparam[0] = new SqlParameter("@PanNo", objiibRequest.PanNo);
            _sqlparam[1] = new SqlParameter("@FirstName", objiibRequest.FirstName);
            _sqlparam[2] = new SqlParameter("@SurName", objiibRequest.SurName);
            _sqlparam[3] = new SqlParameter("@DOB", objiibRequest.DOB);
            _sqlparam[4] = new SqlParameter("@Gender", objiibRequest.Gender);
            _sqlparam[5] = new SqlParameter("@PinCode", objiibRequest.PinCode);
            _sqlparam[6] = new SqlParameter("@AadharCard", objiibRequest.AadharCard);
            _sqlparam[7] = new SqlParameter("@EmailId", objiibRequest.Email_1);
            _sqlparam[8] = new SqlParameter("@PhoneNo", objiibRequest.Phone_Number_2);
            _sqlparam[9] = new SqlParameter("@MobileNo", objiibRequest.Phone_Number_1);
            _sqlparam[10] = new SqlParameter("@ProductCode", objiibRequest.ProductCode);
            _sqlparam[11] = new SqlParameter("@Annual_Income", objiibRequest.Annual_Income);
            _sqlparam[12] = new SqlParameter("@Address", objiibRequest.Permanent_Address);
            _sqlparam[13] = new SqlParameter("@DataKeyName", objiibRequest.DataKeyName);
            _sqlparam[14] = new SqlParameter("@ApplicationNo", objiibRequest.DataKeyValue);
            _sqlparam[15] = new SqlParameter("@CreatedBy", Userid);
            objSql.Insertrecord("Usp_UWSaral_InsertIIBEnquiryRequestDetails", _sqlparam);
        }
        catch (Exception ex)
        {
            InsertIIBexception(objiibRequest.PanNo, "InsertIIBEnquireyRequestDetails", objiibRequest.DataKeyValue, Userid, ex.Message);
        }

    }
    #endregion



    #region IIB Enqury Logs
    public void InsertIIBEnquiryLog(string PANCardNo, string ApplicationNo, string MethodName, string IIBRequest, string IIBResponseData, string IIBStatus,
string NOMatchData, string Userid, int ResponseCode)
    {
        try
        {

            SqlParameter[] _sqlparam = new SqlParameter[9];
            _sqlparam[0] = new SqlParameter("@PANCardNo", PANCardNo);
            _sqlparam[1] = new SqlParameter("@ApplicationNo", ApplicationNo);
            _sqlparam[2] = new SqlParameter("@MethodName", MethodName);
            _sqlparam[3] = new SqlParameter("@Request", IIBRequest);
            _sqlparam[4] = new SqlParameter("@Response", IIBResponseData);
            _sqlparam[5] = new SqlParameter("@ResponseCode", ResponseCode);
            _sqlparam[6] = new SqlParameter("@IIBStatus", IIBStatus);
            _sqlparam[7] = new SqlParameter("@NOMatchData", NOMatchData);
            _sqlparam[8] = new SqlParameter("@CreatedBy", Userid);
            objSql.Insertrecord("Usp_UWSaral_InsertIIBEnquryLogs", _sqlparam);

        }
        catch (Exception ex)
        {
            InsertIIBexception(PANCardNo, "InsertIIBEnquiryLog", ApplicationNo, Userid, ex.Message);
        }
    }
    #endregion
    #region Insert the IIB Enqury Data

    public void InsertIIBQueryData(DataTable dt, string PANCardNo, string ApplicationNo, string Userid)
    {
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@dt", dt);
            objSql.Insertrecord("Usp_UWSaral_InsertIIBQueryEnquiry", _sqlparam);

        }
        catch (Exception ex)
        {

            InsertIIBexception(PANCardNo, "InsertIIBEnquiryLog", ApplicationNo, Userid, ex.Message);
        }

    }

    #endregion
    #region IIB Enquiry Exception 

    public void InsertIIBexception(string PanNo, string MethodName, string ApplicationNo, string Userid, string Error)
    {

        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[5];
            _sqlparam[0] = new SqlParameter("@PANCardNo", PanNo);
            _sqlparam[1] = new SqlParameter("@ApplicationNo", ApplicationNo);
            _sqlparam[2] = new SqlParameter("@MethodName", MethodName);
            _sqlparam[3] = new SqlParameter("@Exception", Error);
            _sqlparam[4] = new SqlParameter("@CreatedBy", Userid);
            objSql.Insertrecord("Usp_UWSaral_InsertIIBEnquiryException", _sqlparam);
        }
        catch (Exception ex)
        {

        }

    }

    #endregion



    #endregion

    #endregion End 37.1: This CR-2809 changes done by Sushant Devkate MFL00905
    //39.1 Start of Changes; Sagar Thorave-[mfl00886]
    public DataSet Featch_SMARTAPIENYFLAG_Details(string applicationNo)
    {
        _dsAppdtls = new DataSet();
        SqlParameter[] sqlparams = new SqlParameter[1];
        try
        {
            sqlparams[0] = new SqlParameter("@AppNo", applicationNo);
            _dsAppdtls = objSql.RetrieveDataset("USP_SMARTAPIENYRISKFLAG_SCORE_GET", sqlparams);

        }
        catch (Exception ex)
        {
            throw ex;
        }
        return _dsAppdtls;
    }
    public int Insert_EnyFlag_Details(string appNo, string ENYValue, string Actions)
    {
        SqlParameter[] sqlparams = new SqlParameter[4];
        try
        {
            sqlparams[0] = new SqlParameter("@AppNo", appNo);
            sqlparams[1] = new SqlParameter("@score", ENYValue);
            sqlparams[2] = new SqlParameter("@early_claim_risk_level", Actions);
            sqlparams[3] = new SqlParameter("@source", "API-UWSARAL");
            int i = objSql.Insertrecord("USP_INSERT_EnyFlagScore_UWSaral", sqlparams);
            return i;
        }
        catch (Exception ex)
        {
            return 0;

        }
    }
    public int Insert_RiskScore_Details(string policyNo, string underwriting_Due_Diligence_Required, string Parameter_Combinations,
       string risk_Score, string suggestive_Requirment, string remarks, string AppNo, string sumAssured, string AgentNum, string channelCode, string ChannelName)
    {
        SqlParameter[] sqlparams = new SqlParameter[12];
        try
        {
            sqlparams[0] = new SqlParameter("@policyNo", policyNo);
            sqlparams[1] = new SqlParameter("@underwriting_Due_Diligence_Required", underwriting_Due_Diligence_Required);
            sqlparams[2] = new SqlParameter("@Parameter_Combinations", Parameter_Combinations);
            sqlparams[3] = new SqlParameter("@risk_Score", risk_Score);
            sqlparams[4] = new SqlParameter("@suggestive_Requirment", suggestive_Requirment);
            sqlparams[5] = new SqlParameter("@remarks", remarks);
            sqlparams[6] = new SqlParameter("@AppNo", AppNo);
            sqlparams[7] = new SqlParameter("@sumAssured", sumAssured);
            sqlparams[8] = new SqlParameter("@AgentNum", AgentNum);
            sqlparams[9] = new SqlParameter("@channelCode", channelCode);
            sqlparams[10] = new SqlParameter("@ChannelName", ChannelName);
            sqlparams[11] = new SqlParameter("@Source", "API-UWSARAL");

            int i = objSql.Insertrecord("USP_INSERT_RiskScore_UWSaral", sqlparams);
            return i;
        }
        catch (Exception ex)
        {
            return 0;

        }
    }
    public DataSet Featch_SMARTAPIRISK_Score_Details(string applicationNo)
    {
        _dsAppdtls = new DataSet();
        SqlParameter[] sqlparams = new SqlParameter[1];
        try
        {
            sqlparams[0] = new SqlParameter("@AppNo", applicationNo);
            _dsAppdtls = objSql.RetrieveDataset("USP_SMARTAPI_RISK_SCORE_GET", sqlparams);
            return _dsAppdtls;
        }
        catch (Exception ex)
        {
            throw ex;
        }
    }

    public int Insert_Logs_RiskAndEY(string ApplicationNo, string Msg, string Source, string APIDetails, string StatusLog)
    {
        SqlParameter[] sqlparams = new SqlParameter[5];
        try
        {
            sqlparams[0] = new SqlParameter("@AppNo", ApplicationNo);
            sqlparams[1] = new SqlParameter("@Msg", Msg);
            sqlparams[2] = new SqlParameter("@Source", Source);
            sqlparams[3] = new SqlParameter("@ApiDetails", APIDetails);
            sqlparams[4] = new SqlParameter("@StatusLog", StatusLog);
            int i = objSql.Insertrecord("Sp_Insert_EnyAndRiskScore", sqlparams);
            return i;
        }
        catch (Exception ex)
        {
            return 0;

        }
    }

    //39.1 End of Changes; Sagar Thorave - [MFL00886]


    #region 40.1 Begin Of Changes Of CR-2394 Validation coustomer mob with agent by Sushant Devkate [MFL00905]

    #region To insert Validation API Logs 
    public void InsertValidationAPILogs(string ApplicationNo, string MethodName, string Request, string Response, string UserId, string Source, string Type)
    {
        SqlParameter[] sqlparams = new SqlParameter[7];
        try
        {
            sqlparams[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            sqlparams[1] = new SqlParameter("@MethodName", MethodName);
            sqlparams[2] = new SqlParameter("@userId", UserId);
            sqlparams[3] = new SqlParameter("@Request", Request);
            sqlparams[4] = new SqlParameter("@Response", Response);
            sqlparams[5] = new SqlParameter("@Source", Source);
            sqlparams[6] = new SqlParameter("@ClientType", Type);
            objSql.Insertrecord("Usp_InsertValidationAPIwithAgentAPILogs", sqlparams);
        }
        catch (Exception ex)
        {
            new Commfun().InsertValidationAPIException(ApplicationNo, "InsertValidationAPILogs", ex.Message, UserId, Source, Type);
        }

    }
    #endregion

    #region Exception lock
    public void InsertValidationAPIException(string ApplicationNo, string MethodName, string ErrorMsg, string UserId, string Source, string Type)
    {
        SqlParameter[] sqlparams = new SqlParameter[6];
        try
        {
            sqlparams[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            sqlparams[1] = new SqlParameter("@MethodName", MethodName);
            sqlparams[2] = new SqlParameter("@ErrorMsg", ErrorMsg);
            sqlparams[3] = new SqlParameter("@userId", UserId);
            sqlparams[4] = new SqlParameter("@Source", Source);
            sqlparams[5] = new SqlParameter("@ClientType", Type);
            objSql.Insertrecord("Usp_InsertExceptionErrorValidationAPIwithAgent", sqlparams);
        }
        catch (Exception ex)
        {
            string a = ex.Message;
        }

    }

    #endregion


    #region Get Policy Holder Details 
    public List<CoustomerDO> GetClientHolderDataforValidation(string ApplicationNo, string UserId, string Source)
    {
        List<CoustomerDO> OBjlistCoustomerDO = new List<CoustomerDO>();
        string ClientType = string.Empty;
        try
        {
            DataSet ds = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            ds = objSql.RetrieveDataset("Usp_UWSaral_GetClientDetailsforAPICallbyAPPNo", _sqlparam);
            if (ds.Tables.Count > 0)
            {
                if (ds.Tables[0].Rows.Count > 0)
                {
                    for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
                    {
                        CoustomerDO ObjCoustomerDODO = new CoustomerDO();
                        ObjCoustomerDODO.ApplicationNo = Utility.Getstring(ds.Tables[0].Rows[i]["ApplicationNo"]);
                        ClientType = ObjCoustomerDODO.ClientType = Utility.Getstring(ds.Tables[0].Rows[i]["ClientType"]);
                        ObjCoustomerDODO.FirstName = Utility.Getstring(ds.Tables[0].Rows[i]["firstName"]);
                        ObjCoustomerDODO.SurName = Utility.Getstring(ds.Tables[0].Rows[i]["lastName"]);
                        ObjCoustomerDODO.DOB = Utility.GetDatatime(ds.Tables[0].Rows[i]["DateofBirth"]).ToString("yyyy-MM-dd");
                        ObjCoustomerDODO.MobileNo = Utility.Getstring(ds.Tables[0].Rows[i]["MoblieNo"]);
                        ObjCoustomerDODO.Email = Utility.Getstring(ds.Tables[0].Rows[i]["Email"]);
                        ObjCoustomerDODO.AlterNateMobno = Utility.Getstring(ds.Tables[0].Rows[i]["AlternateMobilNo"]);
                        OBjlistCoustomerDO.Add(ObjCoustomerDODO);
                    }
                }

            }

        }
        catch (Exception ex)
        {
            new Commfun().InsertValidationAPIException(ApplicationNo, "GetClientHolderDataforValidation", ex.Message, UserId, Source, ClientType);
        }

        return OBjlistCoustomerDO;
    }
    #endregion

    #endregion 40.1 End Of Changes Of CR-2394 Validation coustomer mob with agent by Sushant Devkate [MFL00905]



    #region 41.1 Begin Of Changes Of CR-30543 changes by Sushant Devkate [MFL00905]
    public bool GetIsTermProduct(string ProductCode)
    {
        bool IsScuccess = false;
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ProductCode", ProductCode);
            IsScuccess = objSql.IsCheckData("Usp_GetIsTermNonTermProductCodes", _sqlparam);
        }
        catch (Exception ex)
        {
            IsScuccess = false;
        }
        return IsScuccess;
    }

    #region  Insert Smokar Reason 
    public int InsertSmokarReason(string ApplicationNo, bool IsSmokar, string ReasonValue, string Reason, string OtherReason, string UserId)
    {
        SqlParameter[] sqlparams = new SqlParameter[6];
        int Success = 0;
        try
        {
            sqlparams[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            sqlparams[1] = new SqlParameter("@IsSmokar", IsSmokar);
            sqlparams[2] = new SqlParameter("@ReasonValue", ReasonValue);
            sqlparams[3] = new SqlParameter("@Reason", Reason);
            sqlparams[4] = new SqlParameter("@OtherReason", OtherReason);
            sqlparams[5] = new SqlParameter("@UserId", UserId);
            Success = objSql.Insertrecord("Usp_InsertSmokarReason", sqlparams);
        }
        catch (Exception ex)
        {
            new Commfun().InsertSmokarReasonException(ApplicationNo, "InsertSmokarReason", ex.Message, UserId);
        }
        return Success;
    }

    #endregion

    #region Exception lock
    public void InsertSmokarReasonException(string ApplicationNo, string MethodName, string ErrorMsg, string UserId)
    {
        SqlParameter[] sqlparams = new SqlParameter[4];
        try
        {
            sqlparams[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            sqlparams[1] = new SqlParameter("@MethodName", MethodName);
            sqlparams[2] = new SqlParameter("@ErrorMsg", ErrorMsg);
            sqlparams[3] = new SqlParameter("@userId", UserId);
            objSql.Insertrecord("Usp_InsertSmokarExceptionLog", sqlparams);
        }
        catch (Exception ex)
        {
            string a = ex.Message;
        }

    }
    #endregion



    #endregion 41.1 End Of Changes Of CR-30543 changes by Sushant Devkate [MFL00905]
    //42.1 Begin of Changes; Sagar Thorave - [MFL00886]
    public void Is_UWComment_User_Valid(ref DataSet _ds, string UserId)
    {

        SqlParameter[] _sqlparam = new SqlParameter[1];
        try
        {
            _sqlparam[0] = new SqlParameter("@UserId", UserId);
            _ds = objSql.RetrieveDataset("USP_ISUWComment_USerValide", _sqlparam);
        }
        catch (Exception ex)
        {
            throw ex;
        }
    }
    //42.1 Begin of Changes; Sagar Thorave - [MFL00886]


    //43.1 Begin of Changes; Bhaumik Patel - [CR-4134]
    public void OnlineRedFlagtDetails_GET(ref DataSet _ds, string strPQuoteNo, string Mode)
    {
        Logger.Info(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlineServiceClientDetails_GET");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@Mode", Mode);
            _sqlparam[1] = new SqlParameter("@ApplicationNo", strPQuoteNo);

            _ds = objSql.RetrieveDataset("SP_FG_RedFlag_Details", _sqlparam);


        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlineServiceClientDetails_GET");
            SaveErrorLogs(strPQuoteNo, "Failed", "UWSaralDecision", "Commfun.cs", "OnlineServiceClientDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void Online_Update_RedFlagDetails(string Mode, string strAppNo, int RedFlagID, string UWdecision, string UWcomments, string Userid)
    {
        Logger.Info(strAppNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :Online_Update_RedFlagDetails");
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[5];
            _sqlparam[0] = new SqlParameter("@Mode", Mode);
            _sqlparam[1] = new SqlParameter("@RedFlagID", RedFlagID);
            _sqlparam[2] = new SqlParameter("@UWDecision", UWdecision);
            _sqlparam[3] = new SqlParameter("@UWComments", UWcomments);
            _sqlparam[4] = new SqlParameter("@Modify_By", Userid);
            var result = objSql.Insertrecord("SP_FG_RedFlag_Details", _sqlparam);
            if (result > 0)
            {
                // return result;
            }

        }
        catch (Exception Error)
        {
            Logger.Error(strAppNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :Online_Update_RedFlagDetails");
            SaveErrorLogs(strAppNo, "Failed", "UWSaralDecision", "Commfun.cs", "Online_Update_RedFlagDetails", "E-Error", "", "", Error.ToString());
        }


    }
    //43.1 End of Changes; Bhaumik Patel - [CR-4134]

    #region  43.1 Bigin Of Changes Of CR-4134 RedFlag [Webshlar02]
    public void InsertRedFlagReasonException(string ApplicationNo, string MethodName, string ErrorMsg, string UserId)
    {
        SqlParameter[] sqlparams = new SqlParameter[4];
        try
        {
            sqlparams[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            sqlparams[1] = new SqlParameter("@MethodName", MethodName);
            sqlparams[2] = new SqlParameter("@ErrorMsg", ErrorMsg);
            sqlparams[3] = new SqlParameter("@userId", UserId);
            objSql.Insertrecord("Usp_InsertSmokarExceptionLog", sqlparams);
        }
        catch (Exception ex)
        {
            string a = ex.Message;
        }

    }



    #endregion 43.1 End Of Changes Of CR-4134 RedFlag [Webshlar02]

    // 45.1 Begin Added CR-4783 By Royson Pinto on 22nd NOV to store Restrict Further Cover
    public string GetRestrict_Further_Cover(string strApplicationNumber)
    {
        DataSet rd = null;
        SqlParameter[] _sqlparam = new SqlParameter[1];
        try
        {
            _sqlparam[0] = new SqlParameter("@ApplicationNumber", strApplicationNumber);
            rd = objSql.RetrieveDataset("USP_GetRestrict_Further_Cover", _sqlparam);
        }
        catch (Exception ex)
        {
            throw ex;
        }
        return rd.Tables[0].Rows[0][0].ToString();
    }
    // 45.1 End Added CR-4783 By Royson Pinto on 22nd NOV to store Restrict Further Cover
    //45.1 Start of Changes; Sagar Thorave - [MFL00886]
    public void SetProposalType(ref DataSet _ds, string ApplicationNo)
    {

        SqlParameter[] _sqlparam = new SqlParameter[1];
        try
        {
            _sqlparam[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            _ds = objSql.RetrieveDataset("USP_UWSARAL_SetSpecialInsurance", _sqlparam);
        }
        catch (Exception ex)
        {
            throw ex;
        }
    }
    //45.1 End of Changes; Sagar Thorave - [MFL00886]
    //46.1 Start of Changes; Sagar Thorave - [MFL00886]
    public void GetCiBilScore(ref DataSet _dsAllData, string strPQuoteNo, string AppType)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :GetCiBilScore");
            _dsAppdtls = new DataSet();
            SqlParameter[] _sqlparam = new SqlParameter[2];

            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", AppType);
            _dsAllData = objSql.RetrieveDataset("USP_Fetch_CibilScore_OnGenerateCibilButton", _sqlparam);
            /*ID:5 END*/
        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :GetCiBilScore Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "GetCiBilScore", "E-Error", "", "", Error.ToString());
        }
    }
    //46.1 End of Changes; Sagar Thorave - [MFL00886]
    //44.1 Begin of changes; Jayendra [WebAshlar01]
    public bool IsUinNoStatusCheck(string ApplicationNo)
    {
        bool IsUinNoStatus = false;
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", ApplicationNo);
            // = objSql.IsCheckData("Usp_CheckUINNoStatus", _sqlparam);
            IsUinNoStatus = objSql.IsCheckData("Usp_UWSARAL_CheckUINNoStatus", _sqlparam);
        }
        catch (Exception ex)
        {
            IsUinNoStatus = false;
        }
        return IsUinNoStatus;
    }
    //44.1 End of changes; Jayendra [WebAshlar01]
    //47.1 Added By Royson Pinto on 22nd NOV to store Restrict Further Cover
    public dynamic CMOData(string application, string comments, string user_name)
    {
        SqlParameter[] _sqlparam = new SqlParameter[3];
        _sqlparam[0] = new SqlParameter("@Application_Number", application);
        _sqlparam[1] = new SqlParameter("@Comments", comments);
        _sqlparam[2] = new SqlParameter("@User_name", user_name);
        return objSql.Insertrecord("usp_GetCMODetails", _sqlparam);
    }
    public dynamic CMOCount()
    {
        SqlParameter[] _sqlparam = new SqlParameter[1];
        _sqlparam[0] = new SqlParameter("@CMO", "CMO");
        return objSql.RetrieveDataset("USP_CMOCountDashboard", _sqlparam);
    }
    public dynamic GetCMOComments(string application)
    {
        SqlParameter[] _sqlparam = new SqlParameter[1];
        _sqlparam[0] = new SqlParameter("@Application_Number", application);
        return objSql.RetrieveDataset("usp_GetCMOComments", _sqlparam);
    }
    public void UpdateUCNNumber(string Application_Number, string comments, string Userid)
    {
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[5];
            _sqlparam[0] = new SqlParameter("@Application_Number", Application_Number);
            _sqlparam[1] = new SqlParameter("@Code", "UCN");
            _sqlparam[2] = new SqlParameter("@Mode", "UWSaral");
            _sqlparam[3] = new SqlParameter("@Comments", comments);
            _sqlparam[4] = new SqlParameter("@User_name", Userid);
            objSql.Insertrecord("USP_UpdateUCNNumber", _sqlparam);
        }
        catch (Exception ex)
        {

        }
    }
    public void UpdateAppNoPendingToResolve(string Application_Number)
    {
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", Application_Number);
            objSql.Insertrecord("USP_UpdateAppNoPendingToResolve", _sqlparam);
        }
        catch (Exception ex)
        {

        }
    }
    //47.1 End By Royson Pinto on 22nd NOV to store Restrict Further Cover

    // 48.1 Begin of Changes; Jayendra  - [Webashlar01]

    public void OnlineRequirmentDisplayDetails_STP_GET(ref DataSet _ds, string strPQuoteNo, string strChanneltype)
    {
        try
        {
            Logger.Info(strPQuoteNo + "STAG 3-J :PageName :Commfun.CS // MethodeName :OnlineRequirmentDisplayDetails_STP_GET");
            SqlParameter[] _sqlparam = new SqlParameter[2];
            _sqlparam[0] = new SqlParameter("@PQuoteNo", strPQuoteNo);
            _sqlparam[1] = new SqlParameter("@AppType", strChanneltype);
            _ds = objSql.RetrieveDataset("usp_UWOnlineRequirmentDetails_STP_Get", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineRequirmentDisplayDetails_STP_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(strPQuoteNo, "Failed", "UWPortfolio", "Commfun.cs", "OnlineRequirmentDisplayDetails_STP_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineRUW_STP_GET(ref DataSet _ds, string strPQuoteNo)
    {
        try
        {
            Logger.Info(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlineRUW_STP_GET");
            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@applicationNo", strPQuoteNo);
            _ds = objSql.RetrieveDataset("GetRUW_STP_Message", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlineRUW_STP_GET");
            SaveErrorLogs(strPQuoteNo, "Failed", "UWSaralServices", "Commfun.cs", "OnlineRUW_STP_GET", "E-Error", "", "", Error.ToString());
        }
    }


    // 48.1 End of Changes; Jayendra  - [Webashlar01]

   
    // 49.1 Begin of Changes; Royson Pinto [MFL01002] 
    public dynamic GetHoldData(string application)
    {
        SqlParameter[] _sqlparam = new SqlParameter[1];
        _sqlparam[0] = new SqlParameter("@Application_Number", application);
        return objSql.RetrieveDataset("usp_GetHoldValues_V1", _sqlparam);
    }
    public dynamic GetUnHoldData()
    {
        return objSql.RetrieveDataset_woParam("usp_GetUnHoldValues");
    }
    public dynamic InsertUnHoldData(string Application_Number, string LA_Name, string Status, string Policy_Status, string Proposer_Name, string Product_Name, string Created_By, string Created_Date)
    {
        SqlParameter[] _sqlparam = new SqlParameter[7];
        _sqlparam[0] = new SqlParameter("@Application_Number", Application_Number);
        _sqlparam[1] = new SqlParameter("@Policy_Status", Policy_Status);
        _sqlparam[2] = new SqlParameter("@Proposer_Name", Proposer_Name);
        _sqlparam[3] = new SqlParameter("@LA_Name", LA_Name);
        _sqlparam[4] = new SqlParameter("@Product_Name", Product_Name);
        _sqlparam[5] = new SqlParameter("@Status", Status);
        _sqlparam[6] = new SqlParameter("@Created_By", Created_By);
        return objSql.RetrieveDataset("usp_update_HoldCases", _sqlparam);
    }

    public dynamic InsertHoldData(string Application_Number, string LA_Name, string Status, string Policy_Status, string Proposer_Name, string Product_Name, string File_Name, string Created_By)
    {
        SqlParameter[] _sqlparam = new SqlParameter[8];
        _sqlparam[0] = new SqlParameter("@Application_Number", Application_Number);
        _sqlparam[1] = new SqlParameter("@Policy_Status", Policy_Status);
        _sqlparam[2] = new SqlParameter("@Proposer_Name", Proposer_Name);
        _sqlparam[3] = new SqlParameter("@LA_Name", LA_Name);
        _sqlparam[4] = new SqlParameter("@Product_Name", Product_Name);
        _sqlparam[5] = new SqlParameter("@File_Name", Product_Name);
        _sqlparam[6] = new SqlParameter("@Status", Status);
        _sqlparam[7] = new SqlParameter("@Created_By", Created_By);
        return objSql.RetrieveDataset("usp_insert_HoldCases", _sqlparam);
    }


    // 49.1 End of Changes; Royson Pinto [MFL01002] 
    // 46.1 Start of Changes; Sagar Thorave - [MFL00886]
    public void InsertAcceptanceReason(string AccptReason, string AcceptanceOtherReason, string Appno, string status)
    {
        int result = 0;
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@ApplicationNo", Appno);
            _sqlparam[1] = new SqlParameter("@AcceptanceReason", AccptReason);
            _sqlparam[2] = new SqlParameter("@Status", status);
            _sqlparam[3] = new SqlParameter("@AcceptanceReasonOther", AcceptanceOtherReason);
            result = objSql.Insertrecord("USP_AcceptanceReasonSave", _sqlparam);
        }
        catch (Exception ex)
        {
            string msg = ex.Message;
        }
    }
    public void FeatchAcceptanemaster(ref DataSet _ds)
    {
        try
        {
            SqlParameter[] _sqlparam = new SqlParameter[0];
            _ds = objSql.RetrieveDataset("USP_FetchAcceptanceReason", _sqlparam);
        }
        catch (Exception Error)
        {
            string msg = Error.Message;
        }
    }
    // 46.1 End of Changes; Sagar Thorave - [MFL00886]


    //51.1 Begin of Changes; Bhaumik Patel - [CR-3334]
    public void OnlineSubMasterDisplay_DecisionDetails_GET(ref DataSet _ds, string strDatavalue, string category, string ddlType, string ddlsubtype)
    {
        try
        {
            Logger.Info("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineSubMasterDisplayDetails_GET");
            SqlParameter[] _sqlparam = new SqlParameter[4];
            _sqlparam[0] = new SqlParameter("@DataValue", strDatavalue);

            _sqlparam[1] = new SqlParameter("@Category", category);

            _sqlparam[2] = new SqlParameter("@ddlType", ddlType);
            _sqlparam[3] = new SqlParameter("@ddlsubtype", ddlsubtype);
            _ds = objSql.RetrieveDataset("USP_BPM_SubMasterDetailsFetch_V3", _sqlparam);

        }
        catch (Exception Error)
        {
            Logger.Error("STAG 2 :PageName :Commfun.CS // MethodeName :OnlineSubMasterDisplayDetails_GET Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs("", "Failed", "UWPortfolio", "Commfun.cs", "OnlineFollowupMasterDisplayDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlinelReason_Based_loadType_MasterDetails_GET(ref DataSet _ds, string strPQuoteNo, string loadtype, string strAppType)
    {
        Logger.Info(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlinelReason_Based_loadType_MasterDetails_GET");
        try
        {

            SqlParameter[] _sqlparam = new SqlParameter[1];
            _sqlparam[0] = new SqlParameter("@DESCITEM", loadtype);
            _ds = objSql.RetrieveDataset("USP_BPM_MasterDtlFatch_Reason_BasedOnLoadingType_V1", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(strPQuoteNo + ":PageName :UWSaralServices/CommFun.CS // MethodeName :OnlinelReason_Based_loadType_MasterDetails_GET");
            SaveErrorLogs(strPQuoteNo, "Failed", "UWSaralDecision", "Commfun.cs", "OnlinelReason_Based_loadType_MasterDetails_GET", "E-Error", "", "", Error.ToString());
        }
    }

    public void OnlineDecisionDetails_Save( string DD_applicationNoStr, string DD_DecisionType, string DD_category, string DD_reason1, string DD_reason2, string DD_Period, string bpm_userID, string bpm_userName, string bpmgrp, string bpm_userBranch, string bpm_processName,  ref int Decisionresult)
    {
        try
        {
            Logger.Info(DD_applicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineDecisionDetails_Save");
            SqlParameter[] _sqlparam = new SqlParameter[11];
            //_sqlparam[0] = new SqlParameter("@AppType", DD_appType);
            _sqlparam[0] = new SqlParameter("@ApplicationNo", DD_applicationNoStr);
            _sqlparam[1] = new SqlParameter("@DecisionType", DD_DecisionType);
            _sqlparam[2] = new SqlParameter("@Category", DD_category);
            _sqlparam[3] = new SqlParameter("@UW_Reason1", DD_reason1);
            _sqlparam[4] = new SqlParameter("@UW_Reason2", DD_reason2);
            _sqlparam[5] = new SqlParameter("@Postponed_Period", DD_Period);
            _sqlparam[6] = new SqlParameter("@UserID", bpm_userID);
            _sqlparam[7] = new SqlParameter("@UserName", bpm_userName);
            _sqlparam[8] = new SqlParameter("@UserGroup", bpmgrp);
            _sqlparam[9] = new SqlParameter("@UIserBranch", bpm_userBranch);
            _sqlparam[10] = new SqlParameter("@ProcessName", bpm_processName);
           // _sqlparam[12] = new SqlParameter("@StrAppNo", bpm_applicationName);
            Decisionresult = objSql.Insertrecord("USP_BPM_MasterDtlFatch_InsertDecisionDetails", _sqlparam);
        }
        catch (Exception Error)
        {
            Logger.Error(DD_applicationNoStr + "STAG 2 :PageName :Commfun.CS // MethodeName :OnlineDecisionDetails_Save Error :" + System.Environment.NewLine + Error.ToString());
            SaveErrorLogs(DD_applicationNoStr, "Failed", "UWPortfolio", "Commfun.cs", "OnlineApplicationdashbord_Get", "E-Error", "", "", Error.ToString());
        }


    }
    public void DeleteExistingDecision(string strAppno, ref int response)
    {
        Logger.Info(strAppno + "STAG 3-A :PageName :Commfun.CS // MethodeName :DeleteExistingDecision");
        SqlParameter[] _sqlparam = new SqlParameter[0];
        response = objSql.Insertrecord("USP_BPM_MasterDtlFatch_DeleteDecisionDetails", _sqlparam);
    }
    //51.1 End of Changes; Bhaumik Patel - [CR-3334]
}